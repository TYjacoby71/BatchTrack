
{% extends 'layout.html' %}
{% block content %}
<h2>Plan Production for: {{ recipe.name }}</h2>

<form method="post">
    <label for="scale">Scale:</label>
    <input type="number" step="0.1" name="scale" value="{{ scale }}" required><br><br>
    <button type="submit">Check Stock</button>
</form>

{% if stock_check %}
<h3>Stock Check Results</h3>
<table>
    <tr>
        <th>Ingredient</th>
        <th>Needed</th>
        <th>Available</th>
        <th>Status</th>
    </tr>
    {% for row in stock_check %}
    <tr>
        <td>{{ row.name }}</td>
        <td>{{ row.needed }}</td>
        <td>{{ row.available }}</td>
        <td>{{ row.status }}</td>
    </tr>
    {% endfor %}
</table>

{% if all_ok %}
    <form method="post" action="/batches/start">
        <input type="hidden" name="recipe_id" value="{{ recipe.id }}">
        <input type="hidden" name="scale" value="{{ scale }}">
        <button type="submit">Start Batch</button>
    </form>
{% else %}
    <p>Not all ingredients are in stock. Please adjust your inventory.</p>
{% endif %}
{% endif %}

<a href="/recipes">Back to Recipes</a>
{% endblock %}
