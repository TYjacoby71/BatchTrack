(()=>{$(document).ready(function(){function c(){var s;return $("meta[name=csrf-token]").attr("content")||$('input[name="csrf_token"]').val()||((s=document.querySelector('input[name="csrf_token"]'))==null?void 0:s.value)}$.ajaxSetup({beforeSend:function(s,t){!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(t.type)&&!this.crossDomain&&s.setRequestHeader("X-CSRFToken",c())}}),$(".sync-tier").on("click",function(){let s=$(this).data("tier-id"),t=$(this).data("lookup-key"),i=$(this);i.prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i> Syncing...'),$.ajax({url:`/developer/subscription-tiers/sync/${s}`,method:"POST",headers:{"X-CSRFToken":$("meta[name=csrf-token]").attr("content")},dataType:"json",success:function(e){e.success?(n("success",e.message||"Sync completed successfully"),setTimeout(()=>location.reload(),1500)):n("error",e.error||e.message||"Sync failed")},error:function(e){let r=e.responseJSON||{},o=r.error||r.message||"Failed to sync with Stripe";n("error",o),console.error("Sync error:",e)},complete:function(){i.prop("disabled",!1).html('<i class="fas fa-sync"></i> Sync with Stripe')}})});function n(s,t){typeof window.showAlert=="function"?window.showAlert(s,t):alert(t)}$(".sync-whop-tier").on("click",function(){let s=$(this).data("tier-id"),t=$(this).data("product-key"),i=$(this);i.prop("disabled",!0).html('<i class="fas fa-spinner fa-spin"></i> Syncing...'),$.ajax({url:`/developer/subscription-tiers/sync-whop/${s}`,method:"POST",dataType:"json",success:function(e){e.success?n("success",e.message):n("error",e.error||"Whop sync failed")},error:function(e){let r=e.responseJSON||{};n("error",r.error||"Failed to sync with Whop")},complete:function(){i.prop("disabled",!1).html('<i class="fas fa-sync"></i> Sync with Whop')}})}),$("#tier-filter").on("change",function(){let s=$(this).val();$(".tier-card").each(function(){let t=$(this).data("is-customer-facing"),i=$(this).data("is-available"),e=!0;(s==="customer-facing"&&!t||s==="internal"&&t||s==="available"&&!i||s==="disabled"&&i)&&(e=!1),$(this).toggle(e)})});function a(s,t){let i=$(`.tier-card[data-tier-key="${s}"]`);if(t.stripe_price_monthly&&i.find(".monthly-price").text(t.stripe_price_monthly),t.stripe_price_yearly&&i.find(".yearly-price").text(t.stripe_price_yearly),t.stripe_features&&t.stripe_features.length>0){let e=i.find(".stripe-features");e.empty(),t.stripe_features.forEach(function(r){e.append(`<li>${r}</li>`)})}if(t.last_synced){let e=new Date(t.last_synced).toLocaleString();i.find(".last-synced").text(`Last synced: ${e}`)}}});})();
