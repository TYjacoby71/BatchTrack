{
  "version": 3,
  "sources": ["../../components/suggestions.js", "../../components/tool_lines.js", "soap_tool_core.js", "soap_tool_constants.js", "soap_tool_calc.js", "soap_tool_units.js", "soap_tool_ui.js", "soap_tool_layout.js", "soap_tool_mold.js", "soap_tool_oils.js", "soap_tool_bulk_oils_shared.js", "soap_tool_bulk_oils_render.js", "soap_tool_bulk_oils_api.js", "soap_tool_bulk_oils_modal.js", "soap_tool_additives.js", "soap_tool_stages.js", "soap_tool_quality.js", "soap_tool_recipe_payload.js", "soap_tool_runner_inputs.js", "soap_tool_runner_quota.js", "soap_tool_runner_service.js", "soap_tool_runner_render.js", "soap_tool_runner.js", "soap_tool_storage.js", "soap_tool_events.js"],
  "sourcesContent": ["// Shared suggestion helper for merged inventory + global item search\n// Updated to support scoped item types, compact rendering, and reusable modules across the app.\n\n(function(window){\n  'use strict';\n\n  const SOURCE_LABELS = {\n    inventory: 'Inventory',\n    global: 'Global Library',\n  };\n\n  const SOURCE_BADGE_CLASS = {\n    inventory: 'bg-primary',\n    global: 'bg-info text-dark',\n  };\n\n  const DEFAULT_OPTIONS = {\n    mode: 'recipe',\n    searchType: 'ingredient',\n    includeInventory: true,\n    includeGlobal: true,\n    ingredientFirst: false,\n    displayVariant: null,\n    showSourceBadge: true,\n    globalUrlBuilder: null,\n    resultFilter: null,\n  };\n\n  function debounce(fn, wait){\n    let timeout;\n    return function(){\n      const args = arguments;\n      clearTimeout(timeout);\n      timeout = setTimeout(() => fn.apply(null, args), wait);\n    };\n  }\n\n  function normalizedName(value){\n    return (value || '').trim().toLowerCase();\n  }\n\n  function ensureListContainer(listEl){\n    if (listEl) return listEl;\n    const div = document.createElement('div');\n    div.className = 'list-group position-absolute w-100 d-none inventory-suggestions';\n    div.style.zIndex = '1050';\n    div.style.maxHeight = '300px';\n    div.style.overflowY = 'auto';\n    return div;\n  }\n\n  function resolveOption(value){\n    return typeof value === 'function' ? value() : value;\n  }\n\n  function buildGlobalIdSet(items){\n    const set = new Set();\n    (items || []).forEach(item => {\n      const gid = item && (item.global_item_id || item.id);\n      if (gid) set.add(String(gid));\n    });\n    return set;\n  }\n\n  function createSourceBadge(source){\n    if (!source) return '';\n    const label = SOURCE_LABELS[source] || source;\n    const badgeClass = SOURCE_BADGE_CLASS[source] || 'bg-secondary';\n    return `<span class=\"badge ${badgeClass} ms-2\">${label}</span>`;\n  }\n\n  function renderFlatList(listEl, groups, onPick, opts){\n    opts = opts || {};\n    listEl.innerHTML = '';\n    let hasAny = false;\n    groups.forEach(group => {\n      if (!group.items || !group.items.length) return;\n      hasAny = true;\n      group.items.forEach(item => {\n        const entry = document.createElement('a');\n        entry.href = '#';\n        entry.className = 'list-group-item list-group-item-action suggestion-item';\n        const subtitle = opts.showSubtitle && item.subtitle\n          ? `<div class=\"small text-muted mt-1\">${item.subtitle}</div>`\n          : '';\n        entry.innerHTML = `<div class=\"d-flex justify-content-between align-items-center gap-2\">\n          <span class=\"fw-semibold text-truncate\">${item.text || item.display_name || item.name || ''}</span>\n          ${opts.showSourceBadge ? createSourceBadge(group.source || item.source) : ''}\n        </div>${subtitle}`;\n        entry.addEventListener('click', function(e){\n          e.preventDefault();\n          onPick(item, group.source || item.source);\n          listEl.classList.add('d-none');\n        });\n        listEl.appendChild(entry);\n      });\n    });\n    listEl.classList.toggle('d-none', !hasAny);\n    if (!hasAny && listEl.dataset.emptyMessage) {\n      const empty = document.createElement('div');\n      empty.className = 'list-group-item text-muted small';\n      empty.textContent = listEl.dataset.emptyMessage;\n      listEl.appendChild(empty);\n      listEl.classList.remove('d-none');\n    }\n  }\n\n  function renderIngredientFirst(listEl, groups, onPick){\n    listEl.innerHTML = '';\n    let hasAny = false;\n\n    groups.forEach(group => {\n      if (!group.ingredients || !group.ingredients.length) return;\n      hasAny = true;\n      const header = document.createElement('div');\n      header.className = 'list-group-item text-muted small fw-semibold';\n      header.textContent = group.title;\n      listEl.appendChild(header);\n\n      group.ingredients.forEach(ingredient => {\n        const itemEl = document.createElement('div');\n        itemEl.className = 'list-group-item ingredient-result';\n\n        const summary = document.createElement('div');\n        summary.className = 'd-flex justify-content-between align-items-center ingredient-summary';\n        summary.setAttribute('role', 'button');\n        summary.setAttribute('tabindex', '0');\n        summary.innerHTML = `<span class=\"fw-semibold\">${ingredient.name || 'Ingredient'}</span>\n          <span class=\"badge bg-light text-dark\">${ingredient.forms.length} option${ingredient.forms.length === 1 ? '' : 's'}</span>`;\n\n        const formsContainer = document.createElement('div');\n        formsContainer.className = 'ingredient-form-options d-none mt-2 ps-3 border-start border-2';\n        ingredient.forms.forEach(form => {\n          const btn = document.createElement('button');\n          btn.type = 'button';\n          btn.className = 'btn btn-sm btn-outline-primary w-100 text-start mb-2 ingredient-form-option suggestion-item';\n          btn.innerHTML = `<div class=\"fw-semibold\">${form.text || form.display_name || form.name || 'Form'}</div>`;\n          btn.addEventListener('click', function(){\n            onPick(form, form.source || group.source);\n            listEl.classList.add('d-none');\n          });\n          formsContainer.appendChild(btn);\n        });\n\n        function toggleForms(e){\n          if (e.type === 'keydown' && e.key !== 'Enter' && e.key !== ' ') return;\n          e.preventDefault();\n          formsContainer.classList.toggle('d-none');\n        }\n\n        summary.addEventListener('click', toggleForms);\n        summary.addEventListener('keydown', toggleForms);\n\n        itemEl.appendChild(summary);\n        itemEl.appendChild(formsContainer);\n        listEl.appendChild(itemEl);\n\n        if (ingredient.forms.length === 1){\n          formsContainer.classList.remove('d-none');\n        }\n      });\n    });\n\n    listEl.classList.toggle('d-none', !hasAny);\n  }\n\n  function renderDefinitionResults(listEl, items, onPick){\n    listEl.innerHTML = '';\n    let hasAny = false;\n    (items || []).forEach(item => {\n      hasAny = true;\n      const entry = document.createElement('a');\n      entry.href = '#';\n      entry.className = 'list-group-item list-group-item-action suggestion-item';\n      const meta = item.inci_name ? `<div class=\"small text-muted\">${item.inci_name}</div>` : '';\n      entry.innerHTML = `<div class=\"fw-semibold\">${item.text || item.name}</div>${meta}`;\n      entry.addEventListener('click', function(e){\n        e.preventDefault();\n        onPick(item, 'definition');\n        listEl.classList.add('d-none');\n      });\n      listEl.appendChild(entry);\n    });\n    listEl.classList.toggle('d-none', !hasAny);\n    if (!hasAny && listEl.dataset.emptyMessage) {\n      const empty = document.createElement('div');\n      empty.className = 'list-group-item text-muted small';\n      empty.textContent = listEl.dataset.emptyMessage;\n      listEl.appendChild(empty);\n      listEl.classList.remove('d-none');\n    }\n  }\n\n  function expandGlobalItems(items){\n    const expanded = [];\n    (items || []).forEach(item => {\n      if (item && Array.isArray(item.forms) && item.forms.length){\n        const baseIngredientName = (item.ingredient && item.ingredient.name) || item.ingredient_name || null;\n        const categoryName = (item.ingredient && item.ingredient.ingredient_category_name)\n          || item.ingredient_category_name\n          || (item.ingredient_category && item.ingredient_category.name)\n          || null;\n        const categoryTags = item.category_tags || [];\n        item.forms.forEach(form => {\n          const physical = form.physical_form || {};\n          const display = form.display_name || form.text || form.name || (baseIngredientName && form.physical_form_name ? `${baseIngredientName}, ${form.physical_form_name}` : (item.display_name || item.text || item.name || ''));\n          expanded.push({\n            id: form.id,\n            text: display,\n            item_type: form.item_type || item.item_type,\n            default_unit: form.default_unit || form.unit || item.default_unit || item.unit || null,\n            source: 'global',\n            global_item_id: form.id,\n            ingredient_id: form.ingredient_id || (item.ingredient && item.ingredient.id) || item.ingredient_id || null,\n            ingredient_name: form.ingredient_name || baseIngredientName,\n            physical_form_id: form.physical_form_id || (physical && physical.id) || null,\n            physical_form_name: form.physical_form_name || (physical && physical.name) || null,\n            ingredient_category_name: categoryName,\n            category_tags: categoryTags,\n            density: form.density || item.density || null,\n            capacity: form.capacity || item.capacity || null,\n            capacity_unit: form.capacity_unit || item.capacity_unit || null,\n            container_material: form.container_material || item.container_material || null,\n            container_type: form.container_type || item.container_type || null,\n            container_style: form.container_style || item.container_style || null,\n            container_color: form.container_color || item.container_color || null,\n            default_is_perishable: form.default_is_perishable ?? item.default_is_perishable,\n            recommended_shelf_life_days: form.recommended_shelf_life_days ?? item.recommended_shelf_life_days,\n            saponification_value: form.saponification_value ?? item.saponification_value ?? null,\n            iodine_value: form.iodine_value ?? item.iodine_value ?? null,\n            fatty_acid_profile: form.fatty_acid_profile ?? item.fatty_acid_profile ?? null,\n            melting_point_c: form.melting_point_c ?? item.melting_point_c ?? null,\n          });\n        });\n      } else if (item) {\n        const displayName = item.display_name || item.text || item.name || '';\n        const categoryName = (item.ingredient && item.ingredient.ingredient_category_name)\n          || item.ingredient_category_name\n          || (item.ingredient_category && item.ingredient_category.name)\n          || null;\n        expanded.push({\n          id: item.id,\n          text: displayName,\n          source: 'global',\n          item_type: item.item_type,\n          global_item_id: item.id,\n          ingredient_name: (item.ingredient && item.ingredient.name) || item.ingredient_name || item.name,\n          ingredient_category_name: categoryName,\n          category_tags: item.category_tags || [],\n          physical_form_name: (item.physical_form && item.physical_form.name) || item.physical_form_name || null,\n          default_unit: item.default_unit || item.unit || null,\n          density: item.density || null,\n          capacity: item.capacity || null,\n          capacity_unit: item.capacity_unit || null,\n          container_material: item.container_material || null,\n          container_type: item.container_type || null,\n          container_style: item.container_style || null,\n          container_color: item.container_color || null,\n          default_is_perishable: item.default_is_perishable,\n          recommended_shelf_life_days: item.recommended_shelf_life_days,\n          saponification_value: item.saponification_value || null,\n          iodine_value: item.iodine_value || null,\n          fatty_acid_profile: item.fatty_acid_profile || null,\n          melting_point_c: item.melting_point_c || null,\n        });\n      }\n    });\n    return expanded;\n  }\n\n  function groupInventoryByIngredient(items){\n    const map = new Map();\n    (items || []).forEach(item => {\n      const baseName = item.ingredient_name || item.text || item.name || '';\n      const key = item.ingredient_id ? `id:${item.ingredient_id}` : `name:${normalizedName(baseName)}`;\n      const entry = map.get(key) || {\n        ingredient_id: item.ingredient_id || null,\n        name: baseName,\n        forms: [],\n      };\n      entry.forms.push({\n        id: item.id,\n        text: item.text || baseName,\n        ingredient_name: baseName,\n        physical_form_name: item.physical_form_name || null,\n        default_unit: item.default_unit || item.unit || null,\n        source: 'inventory',\n        global_item_id: item.global_item_id || null,\n      });\n      map.set(key, entry);\n    });\n    return Array.from(map.values());\n  }\n\n  function groupGlobalByIngredient(rawGroups, dedupeIds){\n    const groups = [];\n    (rawGroups || []).forEach(group => {\n      const forms = (group.forms || []).map(form => ({\n        id: form.id,\n        text: form.name || form.display_name || form.text,\n        ingredient_name: form.ingredient_name || group.name || (group.ingredient && group.ingredient.name) || 'Ingredient',\n        physical_form_name: form.physical_form_name || null,\n        default_unit: form.default_unit || form.unit || null,\n        source: 'global',\n        global_item_id: form.id,\n        density: form.density || null,\n        capacity: form.capacity || null,\n        capacity_unit: form.capacity_unit || null,\n        container_material: form.container_material || null,\n        container_type: form.container_type || null,\n        container_style: form.container_style || null,\n        container_color: form.container_color || null,\n        saponification_value: form.saponification_value || null,\n        iodine_value: form.iodine_value || null,\n        fatty_acid_profile: form.fatty_acid_profile || null,\n        melting_point_c: form.melting_point_c || null,\n      }));\n      const filteredForms = dedupeIds\n        ? forms.filter(form => !form.global_item_id || !dedupeIds.has(String(form.global_item_id)))\n        : forms;\n      if (filteredForms.length){\n        groups.push({\n          ingredient_id: group.ingredient_id || group.id || null,\n          name: group.name || (group.ingredient && group.ingredient.name) || (forms[0] && forms[0].ingredient_name) || 'Ingredient',\n          forms: filteredForms,\n        });\n      }\n    });\n    return groups;\n  }\n\n  function fetchIngredientDefinitions(q){\n    const params = new URLSearchParams({ q });\n    return fetch(`/api/ingredients/definitions/search?${params.toString()}`)\n      .then(r => r.json())\n      .catch(() => ({ results: [] }));\n  }\n\n  function attachMergedInventoryGlobalTypeahead(options){\n    const opts = { ...DEFAULT_OPTIONS, ...options };\n    const inputEl = opts.inputEl;\n    const invHiddenEl = opts.invHiddenEl;\n    const giHiddenEl = opts.giHiddenEl;\n    const listEl = ensureListContainer(opts.listEl);\n    const mode = opts.mode || 'recipe';\n    const searchTypeOption = opts.searchType || 'ingredient';\n    const includeInventoryOption = opts.includeInventory;\n    const includeGlobalOption = opts.includeGlobal;\n    const ingredientFirstOption = opts.ingredientFirst;\n    const displayVariant = opts.displayVariant;\n    const resultFilter = typeof opts.resultFilter === 'function' ? opts.resultFilter : null;\n    const onSelection = typeof opts.onSelection === 'function' ? opts.onSelection : null;\n    const globalUrlBuilder = opts.globalUrlBuilder;\n\n    if (!inputEl || (!invHiddenEl && mode === 'recipe') || (!giHiddenEl && opts.requireHidden !== false)) return;\n\n    if (listEl && !listEl.classList.contains('list-group')) {\n      listEl.classList.add('list-group');\n    }\n    if (!listEl.parentNode && inputEl.parentNode) {\n      inputEl.parentNode.appendChild(listEl);\n    }\n\n    function buildInventoryUrl(q, effectiveSearchType){\n      const params = new URLSearchParams({ q });\n      if (effectiveSearchType && effectiveSearchType !== 'all') params.set('type', effectiveSearchType);\n      return `/inventory/api/search?${params.toString()}`;\n    }\n\n    function buildGlobalUrl(q, effectiveSearchType, useIngredientFirst){\n      if (typeof globalUrlBuilder === 'function') {\n        return globalUrlBuilder(q, effectiveSearchType, useIngredientFirst);\n      }\n      const params = new URLSearchParams({ q });\n      if (effectiveSearchType && effectiveSearchType !== 'all') params.set('type', effectiveSearchType);\n      if (effectiveSearchType === 'ingredient' && useIngredientFirst) params.set('group', 'ingredient');\n      const base = mode === 'public' ? '/api/public/global-items/search' : '/api/ingredients/global-items/search';\n      return `${base}?${params.toString()}`;\n    }\n\n    const doSearch = debounce(function(){\n      const q = (inputEl.value || '').trim();\n      if (!q){\n        listEl.classList.add('d-none');\n        listEl.innerHTML = '';\n        if (invHiddenEl) invHiddenEl.value = '';\n        if (giHiddenEl) giHiddenEl.value = '';\n        return;\n      }\n\n      const effectiveSearchType = (resolveOption(searchTypeOption) || 'ingredient').toLowerCase();\n      const includeInventory = resolveOption(includeInventoryOption);\n      const includeGlobal = resolveOption(includeGlobalOption);\n      const ingredientFirst = effectiveSearchType === 'ingredient' && !!resolveOption(ingredientFirstOption);\n      const variant = displayVariant || (ingredientFirst ? 'grouped' : 'compact');\n\n      if (effectiveSearchType === 'ingredient_definition' || effectiveSearchType === 'definition') {\n        fetchIngredientDefinitions(q).then(results => {\n          const items = (results && results.results) || [];\n          renderDefinitionResults(listEl, items.map(item => ({\n            id: item.id,\n            text: item.name,\n            name: item.name,\n            inci_name: item.inci_name,\n            slug: item.slug,\n            ingredient_category_id: item.ingredient_category_id,\n            ingredient_category_name: item.ingredient_category_name,\n          })), handleSelection);\n        }).catch(() => listEl.classList.add('d-none'));\n        return;\n      }\n\n      const inventoryPromise = includeInventory !== false\n        ? fetch(buildInventoryUrl(q, effectiveSearchType)).then(r => r.json()).catch(() => ({ results: [] }))\n        : Promise.resolve({ results: [] });\n      const globalPromise = includeGlobal !== false\n        ? fetch(buildGlobalUrl(q, effectiveSearchType, ingredientFirst)).then(r => r.json()).catch(() => ({ results: [] }))\n        : Promise.resolve({ results: [] });\n\n      Promise.all([inventoryPromise, globalPromise]).then(results => {\n        const inventoryRaw = (results[0] && results[0].results) || [];\n        const globalRaw = (results[1] && results[1].results) || [];\n        const inventory = resultFilter\n          ? inventoryRaw.filter(item => resultFilter(item, 'inventory'))\n          : inventoryRaw;\n        const filteredGlobalRaw = resultFilter\n          ? globalRaw.filter(item => resultFilter(item, 'global'))\n          : globalRaw;\n        const seenGlobalIds = buildGlobalIdSet(inventory);\n        const globalExpanded = expandGlobalItems(filteredGlobalRaw)\n          .filter(item => !item.global_item_id || !seenGlobalIds.has(String(item.global_item_id)))\n          .filter(item => (resultFilter ? resultFilter(item, 'global') : true));\n\n        if (ingredientFirst) {\n          const inventoryGroups = groupInventoryByIngredient(inventory);\n          const globalGroups = groupGlobalByIngredient(filteredGlobalRaw, seenGlobalIds);\n          const ingredientGroups = [];\n          if (inventoryGroups.length) {\n            ingredientGroups.push({ title: 'Your Inventory', source: 'inventory', ingredients: inventoryGroups });\n          }\n          if (globalGroups.length) {\n            ingredientGroups.push({ title: 'Global Library', source: 'global', ingredients: globalGroups });\n          }\n          renderIngredientFirst(listEl, ingredientGroups, handleSelection);\n          return;\n        }\n\n        const mergedGroups = [];\n        if (inventory.length) {\n          mergedGroups.push({ title: 'Your Inventory', source: 'inventory', items: inventory });\n        }\n        if (globalExpanded.length) {\n          mergedGroups.push({ title: 'Global Library', source: 'global', items: globalExpanded });\n        }\n        renderFlatList(listEl, mergedGroups, handleSelection, {\n          showSourceBadge: opts.showSourceBadge !== false,\n          showSubtitle: variant === 'detailed'\n        });\n      }).catch(() => {\n        listEl.classList.add('d-none');\n      });\n    }, 200);\n\n    function handleSelection(picked, source){\n      inputEl.value = picked.text || picked.display_name || picked.name || '';\n      if (source === 'inventory') {\n        if (invHiddenEl) invHiddenEl.value = picked.id_numeric || picked.id || '';\n        if (giHiddenEl) giHiddenEl.value = picked.global_item_id || '';\n      } else {\n        if (giHiddenEl) giHiddenEl.value = picked.global_item_id || picked.id || '';\n        if (invHiddenEl) invHiddenEl.value = '';\n      }\n      if (typeof onSelection === 'function') {\n        onSelection(picked, source);\n      }\n    }\n\n    inputEl.addEventListener('input', function(){\n      if (invHiddenEl) invHiddenEl.value = '';\n      if (giHiddenEl) giHiddenEl.value = '';\n      doSearch();\n    });\n\n    document.addEventListener('click', function(e){\n      if (!listEl.contains(e.target) && !inputEl.contains(e.target)) {\n        listEl.classList.add('d-none');\n      }\n    });\n  }\n\n  window.attachMergedInventoryGlobalTypeahead = attachMergedInventoryGlobalTypeahead;\n  window.renderInventoryTypeaheadList = renderFlatList;\n})(window);\n", "(function(window){\n  'use strict';\n\n  function buildToolLineRow(kind, options){\n    var context = (options && options.context) || 'public';\n    var unitOptionsHtml = (options && options.unitOptionsHtml) || '';\n    var mode = (options && options.mode) || (context === 'public' ? 'public' : 'recipe');\n\n    var row = document.createElement('div');\n    row.className = 'row g-2 align-items-end mb-2';\n    row.innerHTML = [\n      '<div class=\"col-md-6\">',\n      '  <label class=\"form-label\">', (kind === 'container' ? 'Container' : (kind === 'consumable' ? 'Consumable' : 'Ingredient')), '</label>',\n      '  <div class=\"position-relative\">',\n      '    <input type=\"text\" class=\"form-control tool-typeahead\" placeholder=\"Search global...\" autocomplete=\"off\">',\n      '    <input type=\"hidden\" class=\"tool-gi-id\">',\n      '    <div class=\"list-group position-absolute w-100 d-none\" data-role=\"suggestions\"></div>',\n      '  </div>',\n      '</div>',\n      '<div class=\"col-md-3 ', (kind==='container'?'d-none':''), '\">',\n      '  <label class=\"form-label\">Quantity</label>',\n      '  <input type=\"number\" step=\"0.01\" min=\"0\" class=\"form-control tool-qty\">',\n      '</div>',\n      '<div class=\"col-md-3 ', (kind==='container'?'d-none':''), '\">',\n      '  <label class=\"form-label\">Unit</label>',\n      '  <select class=\"form-select tool-unit\">',\n           unitOptionsHtml,\n      '  </select>',\n      '</div>',\n      '<div class=\"col-md-3 ', (kind!=='container'?'d-none':''), '\">',\n      '  <label class=\"form-label\">Count</label>',\n      '  <input type=\"number\" min=\"1\" step=\"1\" class=\"form-control tool-qty\">',\n      '</div>',\n      '<div class=\"col-md-2 d-grid\">',\n      '  <button type=\"button\" class=\"btn btn-outline-danger tool-remove\">Remove</button>',\n      '</div>'\n    ].join('');\n\n    var input = row.querySelector('.tool-typeahead');\n    var giHidden = row.querySelector('.tool-gi-id');\n    var list = row.querySelector('[data-role=\"suggestions\"]');\n\n    if (typeof window.attachMergedInventoryGlobalTypeahead === 'function'){\n      const searchType = kind === 'container' ? 'container' : (kind === 'consumable' ? 'consumable' : 'ingredient');\n      const includeInventory = context !== 'public';\n      window.attachMergedInventoryGlobalTypeahead({\n        inputEl: input,\n        giHiddenEl: giHidden,\n        listEl: list,\n        mode: mode,\n        context: context,\n        ingredientFirst: kind === 'ingredient',\n        searchType,\n        includeInventory,\n        includeGlobal: true\n      });\n    }\n    row.querySelector('.tool-remove').addEventListener('click', function(){ row.remove(); });\n    return row;\n  }\n\n  window.buildToolLineRow = buildToolLineRow;\n\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n\n  SoapTool.config = {\n    unitOptionsHtml: (window.soapToolConfig && window.soapToolConfig.unitOptionsHtml) || '',\n    calcLimit: Number.isFinite(window.SOAP_CALC_LIMIT) ? window.SOAP_CALC_LIMIT : null,\n    calcTier: window.SOAP_CALC_TIER || 'guest',\n    useCsvPrimary: !!(window.soapToolConfig && window.soapToolConfig.useCsvPrimary),\n    isAuthenticated: window.__IS_AUTHENTICATED__ === true,\n  };\n\n  SoapTool.state = {\n    lastCalc: null,\n    calcRequestSeq: 0,\n    lastOilEdit: null,\n    lastFragranceEdit: null,\n    selectedOilProfile: null,\n    wasCapped: false,\n    lastPreviewRow: null,\n    lastRemovedOil: null,\n    lastRemovedOilIndex: null,\n    lastSaveToastAt: 0,\n    lastRecipePayload: null,\n    totalOilsGrams: 0,\n    currentUnit: 'g',\n  };\n\n  SoapTool.helpers = {\n    round,\n    toNumber,\n    clamp,\n    formatTime,\n    getStorage,\n    buildSoapcalcSearchBuilder,\n  };\n\n  function round(value, decimals = 3){\n    if (!isFinite(value)) return 0;\n    const factor = Math.pow(10, decimals);\n    return Math.round(value * factor) / factor;\n  }\n\n  function toNumber(value){\n    let cleaned = value;\n    if (typeof cleaned === 'string') {\n      cleaned = cleaned.replace(/,/g, '').trim();\n    }\n    const num = parseFloat(cleaned);\n    return isFinite(num) ? num : 0;\n  }\n\n  function clamp(value, min, max){\n    if (!isFinite(value)) return min;\n    if (value < min) return min;\n    if (max !== undefined && max !== null && value > max) return max;\n    return value;\n  }\n\n  function formatTime(ts){\n    if (!ts) return 'Not saved yet';\n    const date = new Date(ts);\n    return `Saved ${date.toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' })}`;\n  }\n\n  function getStorage(){\n    try {\n      return window.localStorage;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  function buildSoapcalcSearchBuilder(){\n    const buildGilUrl = (q, effectiveSearchType, useIngredientFirst) => {\n      const params = new URLSearchParams({ q });\n      if (effectiveSearchType && effectiveSearchType !== 'all') params.set('type', effectiveSearchType);\n      if (effectiveSearchType === 'ingredient' && useIngredientFirst) params.set('group', 'ingredient');\n      return `/api/public/global-items/search?${params.toString()}`;\n    };\n    const buildCsvUrl = (q, _searchType, useIngredientFirst) => {\n      const params = new URLSearchParams({ q });\n      if (useIngredientFirst) params.set('group', 'ingredient');\n      return `/api/public/soapcalc-items/search?${params.toString()}`;\n    };\n    return SoapTool.config.useCsvPrimary === true ? buildCsvUrl : buildGilUrl;\n  }\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n\n  const QUALITY_RANGES = {\n    hardness: [29, 54],\n    cleansing: [12, 22],\n    conditioning: [44, 69],\n    bubbly: [14, 46],\n    creamy: [16, 48],\n  };\n\n  const QUALITY_HINTS = {\n    hardness: 'Durable bar that resists mush.',\n    cleansing: 'Higher values feel more stripping.',\n    conditioning: 'Silky, moisturizing feel.',\n    bubbly: 'Fluffy lather and big bubbles.',\n    creamy: 'Stable, creamy lather.',\n  };\n\n  const QUALITY_FEEL_HINTS = {\n    hardness: {\n      low: 'Soft bar, slower unmold.',\n      ok: 'Balanced hardness for daily use.',\n      high: 'Very hard bar, can feel brittle.',\n    },\n    cleansing: {\n      low: 'Very mild cleansing.',\n      ok: 'Balanced cleansing.',\n      high: 'Strong cleansing, can be drying.',\n    },\n    conditioning: {\n      low: 'Less conditioning feel.',\n      ok: 'Smooth and conditioning.',\n      high: 'Very conditioning, may feel oily.',\n    },\n    bubbly: {\n      low: 'Low bubbly lather.',\n      ok: 'Balanced bubbly lather.',\n      high: 'Very bubbly, big foam.',\n    },\n    creamy: {\n      low: 'Light creamy lather.',\n      ok: 'Creamy and stable.',\n      high: 'Dense creamy lather.',\n    },\n  };\n\n  const IODINE_RANGE = [41, 70];\n  const IODINE_SCALE_MAX = 100;\n  const INS_RANGE = [136, 170];\n  const INS_SCALE_MAX = 250;\n\n  const QUALITY_BASE = {\n    hardness: (QUALITY_RANGES.hardness[0] + QUALITY_RANGES.hardness[1]) / 2,\n    cleansing: (QUALITY_RANGES.cleansing[0] + QUALITY_RANGES.cleansing[1]) / 2,\n    conditioning: (QUALITY_RANGES.conditioning[0] + QUALITY_RANGES.conditioning[1]) / 2,\n    bubbly: (QUALITY_RANGES.bubbly[0] + QUALITY_RANGES.bubbly[1]) / 2,\n    creamy: (QUALITY_RANGES.creamy[0] + QUALITY_RANGES.creamy[1]) / 2,\n  };\n\n  const QUALITY_PRESETS = {\n    balanced: {\n      hardness: 40,\n      cleansing: 15,\n      conditioning: 55,\n      bubbly: 25,\n      creamy: 25,\n      iodine: 55,\n      ins: 160,\n    },\n    bubbly: {\n      hardness: 35,\n      cleansing: 20,\n      conditioning: 50,\n      bubbly: 35,\n      creamy: 25,\n      iodine: 60,\n      ins: 150,\n    },\n    creamy: {\n      hardness: 45,\n      cleansing: 12,\n      conditioning: 60,\n      bubbly: 20,\n      creamy: 35,\n      iodine: 50,\n      ins: 155,\n    },\n    hard: {\n      hardness: 50,\n      cleansing: 18,\n      conditioning: 48,\n      bubbly: 22,\n      creamy: 28,\n      iodine: 45,\n      ins: 165,\n    },\n    gentle: {\n      hardness: 35,\n      cleansing: 10,\n      conditioning: 65,\n      bubbly: 15,\n      creamy: 20,\n      iodine: 65,\n      ins: 140,\n    },\n    castile: {\n      hardness: 20,\n      cleansing: 5,\n      conditioning: 75,\n      bubbly: 10,\n      creamy: 15,\n      iodine: 80,\n      ins: 110,\n    },\n    shampoo: {\n      hardness: 30,\n      cleansing: 22,\n      conditioning: 50,\n      bubbly: 30,\n      creamy: 25,\n      iodine: 60,\n      ins: 145,\n    },\n    utility: {\n      hardness: 70,\n      cleansing: 50,\n      conditioning: 20,\n      bubbly: 50,\n      creamy: 20,\n      iodine: 10,\n      ins: 250,\n    },\n    luxury: {\n      hardness: 55,\n      cleansing: 10,\n      conditioning: 55,\n      bubbly: 15,\n      creamy: 40,\n      iodine: 50,\n      ins: 150,\n    },\n    palmFree: {\n      hardness: 42,\n      cleansing: 16,\n      conditioning: 58,\n      bubbly: 22,\n      creamy: 28,\n      iodine: 55,\n      ins: 155,\n    },\n  };\n\n  const FATTY_BAR_COLORS = {\n    lauric: 'var(--color-primary)',\n    myristic: 'var(--color-info)',\n    palmitic: 'var(--color-warning)',\n    stearic: 'var(--color-muted)',\n    ricinoleic: 'var(--color-info-hover)',\n    oleic: 'var(--color-success)',\n    linoleic: 'var(--color-primary-hover)',\n    linolenic: 'var(--color-danger)',\n  };\n\n  const FATTY_DISPLAY_KEYS = [\n    'lauric',\n    'myristic',\n    'palmitic',\n    'stearic',\n    'ricinoleic',\n    'oleic',\n    'linoleic',\n    'linolenic',\n  ];\n\n  const OIL_TIP_RULES = [\n    { match: /coconut|palm kernel|babassu|murumuru/i, tip: 'High lauric oils trace fast and feel cleansing; keep superfat >= 5%.' },\n    { match: /olive|avocado|rice bran|canola|sunflower|safflower|almond|apricot|macadamia|camellia|grapeseed|hazelnut/i, tip: 'High-oleic liquid oils trace slowly and stay softer early on; allow a longer cure.' },\n    { match: /castor/i, tip: 'Castor boosts lather but can feel sticky above 10-15%.' },\n    { match: /cocoa|shea|mango|kokum|sal|illipe|tallow|lard|palm|stearic/i, tip: 'Hard fats/butters set up quickly; melt fully and keep batter warm for a smooth pour.' },\n    { match: /beeswax|candelilla|carnauba|wax/i, tip: 'Waxes harden fast and can seize; keep usage low and add hot.' },\n    { match: /hemp|flax|linseed|evening primrose|borage|rosehip|black currant|chia|pomegranate/i, tip: 'High-PUFA oils shorten shelf life; keep low and add antioxidant.' },\n  ];\n\n  const UNIT_FACTORS = { g: 1, oz: 28.3495, lb: 453.592 };\n\n  const STAGE_CONFIGS = [\n    { id: 1, tabId: 'soapStage1Tab', paneId: 'soapStage1Pane', required: true },\n    { id: 2, tabId: 'soapStage2Tab', paneId: 'soapStage2Pane', required: true },\n    { id: 3, tabId: 'soapStage3Tab', paneId: 'soapStage3Pane', required: true },\n    { id: 4, tabId: 'soapStage4Tab', paneId: 'soapStage4Pane', required: false },\n    { id: 5, tabId: 'soapStage5Tab', paneId: 'soapStage5Pane', required: false },\n  ];\n\n  const OIL_CATEGORY_SET = new Set(['Oils (Carrier & Fixed)', 'Butters & Solid Fats', 'Waxes']);\n  const FRAGRANCE_CATEGORY_SET = new Set(['Essential Oils', 'Fragrance Oils']);\n  const LACTATE_CATEGORY_SET = new Set(['Aqueous Solutions & Blends', 'Preservatives & Additives']);\n  const SUGAR_CATEGORY_SET = new Set(['Sugars & Syrups']);\n  const SALT_CATEGORY_SET = new Set(['Salts & Minerals']);\n  const CITRIC_CATEGORY_SET = new Set(['Preservatives & Additives', 'Salts & Minerals', 'Aqueous Solutions & Blends']);\n\n  SoapTool.constants = {\n    QUALITY_RANGES,\n    QUALITY_HINTS,\n    QUALITY_FEEL_HINTS,\n    IODINE_RANGE,\n    IODINE_SCALE_MAX,\n    INS_RANGE,\n    INS_SCALE_MAX,\n    QUALITY_BASE,\n    QUALITY_PRESETS,\n    FATTY_BAR_COLORS,\n    FATTY_DISPLAY_KEYS,\n    OIL_TIP_RULES,\n    UNIT_FACTORS,\n    STAGE_CONFIGS,\n    OIL_CATEGORY_SET,\n    FRAGRANCE_CATEGORY_SET,\n    LACTATE_CATEGORY_SET,\n    SUGAR_CATEGORY_SET,\n    SALT_CATEGORY_SET,\n    CITRIC_CATEGORY_SET,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { toNumber } = SoapTool.helpers;\n\n  function computeIodine(oils){\n    let totalWeight = 0;\n    let weighted = 0;\n    oils.forEach(oil => {\n      if (oil.iodine > 0) {\n        totalWeight += oil.grams;\n        weighted += oil.iodine * oil.grams;\n      }\n    });\n    return {\n      iodine: totalWeight > 0 ? weighted / totalWeight : 0,\n      coverageWeight: totalWeight,\n    };\n  }\n\n  function computeFattyAcids(oils){\n    const totals = {};\n    let coveredWeight = 0;\n    oils.forEach(oil => {\n      if (!oil.fattyProfile || typeof oil.fattyProfile !== 'object') {\n        return;\n      }\n      coveredWeight += oil.grams;\n      Object.entries(oil.fattyProfile).forEach(([key, pct]) => {\n        const value = toNumber(pct);\n        if (value > 0) {\n          totals[key] = (totals[key] || 0) + oil.grams * (value / 100);\n        }\n      });\n    });\n    const percent = {};\n    if (coveredWeight > 0) {\n      Object.entries(totals).forEach(([key, grams]) => {\n        percent[key] = (grams / coveredWeight) * 100;\n      });\n    }\n    return { percent, coveredWeight };\n  }\n\n  function computeQualities(fattyPercent){\n    const get = key => fattyPercent[key] || 0;\n    return {\n      hardness: get('lauric') + get('myristic') + get('palmitic') + get('stearic'),\n      cleansing: get('lauric') + get('myristic'),\n      conditioning: get('oleic') + get('linoleic') + get('linolenic') + get('ricinoleic'),\n      bubbly: get('lauric') + get('myristic') + get('ricinoleic'),\n      creamy: get('palmitic') + get('stearic') + get('ricinoleic'),\n    };\n  }\n\n  function computeOilQualityScores(fattyProfile){\n    if (!fattyProfile || typeof fattyProfile !== 'object') {\n      return {\n        hardness: 0,\n        cleansing: 0,\n        conditioning: 0,\n        bubbly: 0,\n        creamy: 0,\n      };\n    }\n    const profile = {\n      lauric: toNumber(fattyProfile.lauric),\n      myristic: toNumber(fattyProfile.myristic),\n      palmitic: toNumber(fattyProfile.palmitic),\n      stearic: toNumber(fattyProfile.stearic),\n      ricinoleic: toNumber(fattyProfile.ricinoleic),\n      oleic: toNumber(fattyProfile.oleic),\n      linoleic: toNumber(fattyProfile.linoleic),\n      linolenic: toNumber(fattyProfile.linolenic),\n    };\n    const qualities = computeQualities(profile);\n    return {\n      hardness: (qualities.hardness || 0) / 100,\n      cleansing: (qualities.cleansing || 0) / 100,\n      conditioning: (qualities.conditioning || 0) / 100,\n      bubbly: (qualities.bubbly || 0) / 100,\n      creamy: (qualities.creamy || 0) / 100,\n    };\n  }\n\n  SoapTool.calc = {\n    computeIodine,\n    computeFattyAcids,\n    computeQualities,\n    computeOilQualityScores,\n  };\n\n  window.SoapCalcService = SoapTool.calc;\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { round, toNumber, clamp } = SoapTool.helpers;\n  const { UNIT_FACTORS } = SoapTool.constants;\n  const state = SoapTool.state;\n\n  function toGrams(value){\n    return clamp(toNumber(value), 0) * (UNIT_FACTORS[state.currentUnit] || 1);\n  }\n\n  function fromGrams(value){\n    const grams = clamp(value, 0);\n    return grams / (UNIT_FACTORS[state.currentUnit] || 1);\n  }\n\n  function formatWeight(value){\n    if (!isFinite(value) || value <= 0) return '--';\n    return `${round(fromGrams(value), 2)} ${state.currentUnit}`;\n  }\n\n  function formatPercent(value){\n    if (!isFinite(value)) return '--';\n    return `${round(value, 1)}%`;\n  }\n\n  function updateUnitLabels(){\n    document.querySelectorAll('.unit-label').forEach(el => {\n      el.textContent = state.currentUnit;\n    });\n    document.querySelectorAll('.unit-suffix').forEach(el => {\n      el.dataset.suffix = state.currentUnit;\n    });\n  }\n\n  function setUnit(unit, options = {}){\n    if (!unit) return;\n    if (unit === state.currentUnit) {\n      updateUnitLabels();\n      return;\n    }\n    const prevUnit = state.currentUnit;\n    state.currentUnit = unit;\n    updateUnitLabels();\n    if (options.skipConvert) return;\n    const ratio = (UNIT_FACTORS[prevUnit] || 1) / (UNIT_FACTORS[unit] || 1);\n    document.querySelectorAll('.oil-grams').forEach(input => {\n      const value = toNumber(input.value);\n      if (value > 0) input.value = round(value * ratio, 2);\n    });\n    document.querySelectorAll('.fragrance-grams').forEach(input => {\n      const value = toNumber(input.value);\n      if (value > 0) input.value = round(value * ratio, 2);\n    });\n    const oilTarget = document.getElementById('oilTotalTarget');\n    if (oilTarget && oilTarget.value) {\n      const value = toNumber(oilTarget.value);\n      if (value > 0) oilTarget.value = round(value * ratio, 2);\n    }\n    const moldWater = document.getElementById('moldWaterWeight');\n    if (moldWater && moldWater.value) {\n      const value = toNumber(moldWater.value);\n      if (value > 0) moldWater.value = round(value * ratio, 2);\n    }\n    SoapTool.oils.updateOilTotals();\n    SoapTool.mold.updateMoldSuggested();\n    SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n    if (SoapTool.bulkOilsModal && typeof SoapTool.bulkOilsModal.onUnitChanged === 'function') {\n      SoapTool.bulkOilsModal.onUnitChanged();\n    }\n    if (!options.skipAutoCalc) {\n      SoapTool.runner.calculateAll({ consumeQuota: false, showAlerts: false });\n    }\n  }\n\n  SoapTool.units = {\n    toGrams,\n    fromGrams,\n    formatWeight,\n    formatPercent,\n    updateUnitLabels,\n    setUnit,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const state = SoapTool.state;\n\n  const ALERT_ICONS = {\n    info: 'fa-info-circle',\n    warning: 'fa-exclamation-triangle',\n    danger: 'fa-times-circle',\n    success: 'fa-check-circle'\n  };\n\n  function pulseValue(el){\n    if (!el) return;\n    el.classList.remove('soap-number-pulse');\n    void el.offsetWidth;\n    el.classList.add('soap-number-pulse');\n  }\n\n  function getToastInstance(id){\n    const el = document.getElementById(id);\n    if (!el || !window.bootstrap?.Toast) return null;\n    return bootstrap.Toast.getOrCreateInstance(el);\n  }\n\n  function showAutosaveToast(){\n    const now = Date.now();\n    if (now - state.lastSaveToastAt < 3500) return;\n    state.lastSaveToastAt = now;\n    const toast = getToastInstance('soapAutosaveToast');\n    if (toast) toast.show();\n  }\n\n  function showUndoToast(message){\n    const toastEl = document.getElementById('soapUndoToast');\n    if (!toastEl) return;\n    const body = toastEl.querySelector('.toast-body');\n    if (body) body.textContent = message || 'Oil removed.';\n    const toast = getToastInstance('soapUndoToast');\n    if (toast) toast.show();\n  }\n\n  function updateResultsMeta(){\n    const badge = document.getElementById('resultsReadyBadge');\n    const updatedAt = document.getElementById('resultsUpdatedAt');\n    if (badge) badge.classList.remove('d-none');\n    if (updatedAt) {\n      updatedAt.textContent = `Updated ${new Date().toLocaleTimeString([], { hour: 'numeric', minute: '2-digit' })}`;\n    }\n  }\n\n  function updateResultsWarnings(waterData){\n    const concentrationEl = document.getElementById('lyeConcentrationWarning');\n    const ratioEl = document.getElementById('waterRatioWarning');\n    if (concentrationEl) {\n      const concentration = waterData?.lyeConcentration || 0;\n      let message = '';\n      if (concentration > 40) message = 'High concentration';\n      if (concentration > 0 && concentration < 25) message = 'Low concentration';\n      concentrationEl.textContent = message;\n      concentrationEl.classList.toggle('d-none', !message);\n    }\n    if (ratioEl) {\n      const ratio = waterData?.waterRatio || 0;\n      let message = '';\n      if (ratio > 0 && ratio < 1.8) message = 'Low water';\n      if (ratio > 2.7) message = 'High water';\n      ratioEl.textContent = message;\n      ratioEl.classList.toggle('d-none', !message);\n    }\n  }\n\n  function applyHelperVisibility(){\n    document.querySelectorAll('#soapToolPage .form-text').forEach(text => {\n      const wrapper = text.closest('.col-md-2, .col-md-3, .col-md-4, .col-md-6, .col-md-8, .col-lg-6, .col-lg-4, .col-12');\n      if (wrapper) wrapper.classList.add('soap-field');\n    });\n  }\n\n  function validateNumericField(input){\n    if (!input || input.type !== 'number') return;\n    const raw = input.value;\n    if (raw === '') {\n      input.classList.remove('is-invalid');\n      return;\n    }\n    const value = parseFloat(raw);\n    const min = input.getAttribute('min');\n    const max = input.getAttribute('max');\n    const tooLow = min !== null && min !== '' && value < parseFloat(min);\n    const tooHigh = max !== null && max !== '' && value > parseFloat(max);\n    input.classList.toggle('is-invalid', !isFinite(value) || tooLow || tooHigh);\n  }\n\n  function flashStage(stageItem){\n    if (!stageItem) return;\n    const target = stageItem.querySelector?.('.soap-stage-card') || stageItem;\n    target.classList.add('soap-stage-highlight');\n    setTimeout(() => target.classList.remove('soap-stage-highlight'), 900);\n  }\n\n  function showSoapAlert(type, message, options = {}){\n    const alertStack = document.getElementById('soapAlertStack');\n    if (!alertStack) return;\n    const icon = ALERT_ICONS[type] || ALERT_ICONS.info;\n    const alert = document.createElement('div');\n    alert.className = `alert alert-${type} d-flex align-items-start gap-2`;\n    alert.innerHTML = `\n      <i class=\"fas ${icon} mt-1\"></i>\n      <div class=\"flex-grow-1\">${message}</div>\n      ${options.dismissible ? '<button type=\"button\" class=\"btn-close\" data-role=\"dismiss\"></button>' : ''}\n    `;\n    if (options.dismissible) {\n      alert.querySelector('[data-role=\"dismiss\"]')?.addEventListener('click', () => alert.remove());\n    }\n    alertStack.prepend(alert);\n    if (!options.persist) {\n      setTimeout(() => {\n        if (alert.parentNode) alert.remove();\n      }, options.timeoutMs || 4500);\n    }\n  }\n\n  function clearSoapAlerts(){\n    const alertStack = document.getElementById('soapAlertStack');\n    if (!alertStack) return;\n    alertStack.querySelectorAll('.alert').forEach(el => el.remove());\n  }\n\n  SoapTool.ui = {\n    pulseValue,\n    getToastInstance,\n    showAutosaveToast,\n    showUndoToast,\n    updateResultsMeta,\n    updateResultsWarnings,\n    applyHelperVisibility,\n    validateNumericField,\n    flashStage,\n    showSoapAlert,\n    clearSoapAlerts,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n\n  function syncStageHeight(){\n    const stagePane = document.getElementById('soapStagePane');\n    const qualityCard = document.getElementById('soapQualityCard');\n    if (!stagePane || !qualityCard) return;\n    const shouldSync = window.matchMedia('(min-width: 768px)').matches;\n    if (!shouldSync) {\n      stagePane.classList.remove('is-height-synced');\n      stagePane.style.removeProperty('--soap-stage-height');\n      return;\n    }\n    const qualityHeight = qualityCard.offsetHeight;\n    if (!qualityHeight) {\n      stagePane.classList.remove('is-height-synced');\n      stagePane.style.removeProperty('--soap-stage-height');\n      return;\n    }\n    stagePane.style.setProperty('--soap-stage-height', `${qualityHeight}px`);\n    stagePane.classList.add('is-height-synced');\n  }\n\n  const scheduleStageHeightSync = () => {\n    window.requestAnimationFrame(syncStageHeight);\n  };\n\n  SoapTool.layout = {\n    syncStageHeight,\n    scheduleStageHeightSync,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { clamp, toNumber, round } = SoapTool.helpers;\n  const { toGrams, fromGrams } = SoapTool.units;\n\n  function updateMoldSuggested(){\n    const settings = getMoldSettings();\n    const targetInput = document.getElementById('oilTotalTarget');\n    const targetHint = document.getElementById('oilTargetHint');\n    if (targetInput && settings.effectiveCapacity > 0 && toGrams(targetInput.value) <= 0) {\n      targetInput.value = settings.targetOils > 0 ? round(fromGrams(settings.targetOils), 2) : '';\n    }\n    if (targetHint) {\n      if (settings.effectiveCapacity > 0) {\n        targetHint.textContent = 'Linked to mold sizing. Edit oil % or total oils target to update the other.';\n      } else {\n        targetHint.textContent = 'Auto-fills when mold sizing is set.';\n      }\n    }\n    const note = document.getElementById('moldSuggestionNote');\n    if (note) {\n      let message = 'Target oils are capped to the mold size above.';\n      if (settings.shape === 'cylinder' && settings.waterWeight > 0) {\n        if (settings.useCylinder) {\n          message = `Cylinder correction applied (${round(settings.cylinderFactor * 100, 0)}% of capacity).`;\n        } else {\n          message = 'Cylinder mold selected. Apply a correction if you want headspace or a smaller fill.';\n        }\n      }\n      note.textContent = message;\n    }\n    updateWetBatterWarning();\n  }\n\n  function updateWetBatterWarning(batchYieldG = null){\n    const warning = document.getElementById('moldWetBatterWarning');\n    if (!warning) return;\n\n    const hide = () => {\n      warning.classList.add('d-none');\n      warning.textContent = '';\n    };\n\n    const settings = getMoldSettings();\n    const state = SoapTool.state || {};\n    const lastCalc = state.lastCalc || null;\n    const currentTotalOils = SoapTool.oils?.getTotalOilsGrams ? SoapTool.oils.getTotalOilsGrams() : 0;\n    const calcTotalOils = toNumber(lastCalc?.totalOils);\n    let batchYield = toNumber(batchYieldG);\n    if (!isFinite(batchYield) || batchYield <= 0) {\n      batchYield = toNumber(lastCalc?.batchYield);\n    }\n\n    // Avoid stale warnings while stage inputs have changed but a fresh calc is pending.\n    if (\n      (batchYieldG === null || batchYieldG === undefined)\n      && calcTotalOils > 0\n      && currentTotalOils > 0\n      && Math.abs(calcTotalOils - currentTotalOils) > 0.01\n    ) {\n      hide();\n      return;\n    }\n\n    if (!isFinite(batchYield) || batchYield <= 0 || settings.effectiveCapacity <= 0) {\n      hide();\n      return;\n    }\n\n    const overBy = batchYield - settings.effectiveCapacity;\n    if (overBy <= 0.01) {\n      hide();\n      return;\n    }\n\n    const unit = state.currentUnit || 'g';\n    warning.textContent = `Full wet batter is ${round(fromGrams(batchYield), 2)} ${unit}, exceeding mold capacity ${round(fromGrams(settings.effectiveCapacity), 2)} ${unit} by ${round(fromGrams(overBy), 2)} ${unit}. Reduce oils target/% of mold or lower water/additives.`;\n    warning.classList.remove('d-none');\n  }\n\n  function syncTargetFromMold(){\n    const targetInput = document.getElementById('oilTotalTarget');\n    const settings = getMoldSettings();\n    if (!targetInput) return settings;\n    if (settings.effectiveCapacity > 0) {\n      targetInput.value = settings.targetOils > 0 ? round(fromGrams(settings.targetOils), 2) : '';\n    }\n    updateMoldSuggested();\n    return settings;\n  }\n\n  function syncMoldPctFromTarget(){\n    const targetInput = document.getElementById('oilTotalTarget');\n    const moldOilPct = document.getElementById('moldOilPct');\n    if (!targetInput || !moldOilPct) {\n      const settings = getMoldSettings();\n      updateMoldSuggested();\n      return settings;\n    }\n    const settings = getMoldSettings();\n    if (settings.effectiveCapacity > 0) {\n      const target = toGrams(targetInput.value);\n      const cappedTarget = clamp(target, 0, settings.effectiveCapacity);\n      if (target > settings.effectiveCapacity + 0.01) {\n        targetInput.value = round(fromGrams(cappedTarget), 2);\n      }\n      const nextPct = cappedTarget > 0 ? (cappedTarget / settings.effectiveCapacity) * 100 : 0;\n      moldOilPct.value = cappedTarget > 0 ? round(nextPct, 2) : '';\n    }\n    const nextSettings = getMoldSettings();\n    updateMoldSuggested();\n    return nextSettings;\n  }\n\n  function getMoldSettings(){\n    const waterWeight = toGrams(document.getElementById('moldWaterWeight').value);\n    const oilPct = clamp(toNumber(document.getElementById('moldOilPct').value), 0, 100);\n    const shape = document.getElementById('moldShape')?.value || 'loaf';\n    const useCylinder = !!document.getElementById('moldCylinderCorrection')?.checked;\n    const cylinderFactor = clamp(toNumber(document.getElementById('moldCylinderFactor')?.value), 0.5, 1);\n    const effectiveCapacity = waterWeight > 0 ? waterWeight * (useCylinder ? cylinderFactor : 1) : 0;\n    const targetOils = effectiveCapacity > 0 ? effectiveCapacity * (oilPct / 100) : 0;\n    return {\n      waterWeight,\n      oilPct,\n      shape,\n      useCylinder,\n      cylinderFactor,\n      effectiveCapacity,\n      targetOils,\n    };\n  }\n\n  function updateMoldShapeUI(){\n    const shape = document.getElementById('moldShape')?.value || 'loaf';\n    const options = document.getElementById('moldCylinderOptions');\n    if (options) {\n      options.classList.toggle('d-none', shape !== 'cylinder');\n    }\n    updateMoldSuggested();\n  }\n\n  SoapTool.mold = {\n    updateMoldSuggested,\n    updateWetBatterWarning,\n    syncTargetFromMold,\n    syncMoldPctFromTarget,\n    getMoldSettings,\n    updateMoldShapeUI,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { round, toNumber, clamp, buildSoapcalcSearchBuilder } = SoapTool.helpers;\n  const { toGrams, fromGrams } = SoapTool.units;\n  const { OIL_CATEGORY_SET, OIL_TIP_RULES } = SoapTool.constants;\n  const { computeQualities } = SoapTool.calc;\n  const state = SoapTool.state;\n\n  function attachOilTypeahead(row){\n    const input = row.querySelector('.oil-typeahead');\n    const hiddenSap = row.querySelector('.oil-sap-koh');\n    const hiddenIodine = row.querySelector('.oil-iodine');\n    const hiddenFatty = row.querySelector('.oil-fatty');\n    const hiddenGi = row.querySelector('.oil-gi-id');\n    const hiddenUnit = row.querySelector('.oil-default-unit');\n    const hiddenCategory = row.querySelector('.oil-category');\n    const list = row.querySelector('[data-role=\"suggestions\"]');\n    if (!input || !list || typeof window.attachMergedInventoryGlobalTypeahead !== 'function') {\n      return;\n    }\n    const builder = buildSoapcalcSearchBuilder();\n    window.attachMergedInventoryGlobalTypeahead({\n      inputEl: input,\n      listEl: list,\n      mode: 'public',\n      giHiddenEl: hiddenGi,\n      includeInventory: false,\n      includeGlobal: true,\n      ingredientFirst: true,\n      globalUrlBuilder: builder,\n      searchType: 'ingredient',\n      resultFilter: (item, source) => matchesCategory(item, OIL_CATEGORY_SET, source),\n      requireHidden: false,\n      onSelection: function(picked){\n        if (hiddenSap) {\n          hiddenSap.value = picked?.saponification_value || '';\n        }\n        if (hiddenIodine) {\n          hiddenIodine.value = picked?.iodine_value || '';\n        }\n        if (hiddenFatty) {\n          hiddenFatty.value = picked?.fatty_acid_profile ? JSON.stringify(picked.fatty_acid_profile) : '';\n        }\n        if (hiddenUnit) {\n          hiddenUnit.value = picked?.default_unit || '';\n        }\n        if (hiddenCategory) {\n          hiddenCategory.value = picked?.ingredient_category_name || '';\n        }\n        setSelectedOilProfile(picked);\n        updateOilTotals();\n        SoapTool.storage.queueStateSave();\n        SoapTool.storage.queueAutoCalc();\n      }\n    });\n    input.addEventListener('input', function(){\n      if (!this.value.trim()) {\n        if (hiddenSap) hiddenSap.value = '';\n        if (hiddenIodine) hiddenIodine.value = '';\n        if (hiddenFatty) hiddenFatty.value = '';\n        if (hiddenGi) hiddenGi.value = '';\n        if (hiddenUnit) hiddenUnit.value = '';\n        if (hiddenCategory) hiddenCategory.value = '';\n        clearSelectedOilProfile();\n      }\n    });\n  }\n\n  function buildOilRow(){\n    const template = document.getElementById('oilRowTemplate');\n    const row = template?.content?.querySelector('.oil-row')?.cloneNode(true);\n    if (!row) {\n      return document.createElement('div');\n    }\n    row.querySelectorAll('input').forEach(input => {\n      input.value = '';\n    });\n    row.querySelectorAll('.form-text').forEach(text => {\n      const wrapper = text.closest('.soap-field-stack, [class*=\"col-\"]');\n      if (wrapper) wrapper.classList.add('soap-field');\n    });\n    attachOilTypeahead(row);\n    row.querySelectorAll('.unit-suffix').forEach(el => {\n      el.dataset.suffix = state.currentUnit;\n    });\n    return row;\n  }\n\n  function getOilTargetGrams(){\n    const targetInput = document.getElementById('oilTotalTarget');\n    const manualTarget = toGrams(targetInput?.value);\n    if (manualTarget > 0) return manualTarget;\n    const mold = SoapTool.mold.getMoldSettings();\n    if (mold.targetOils > 0) return mold.targetOils;\n    return 0;\n  }\n\n  function deriveTargetFromRows(rows){\n    const derived = [];\n    rows.forEach(row => {\n      const grams = toGrams(row.querySelector('.oil-grams')?.value);\n      const pct = clamp(toNumber(row.querySelector('.oil-percent')?.value), 0);\n      if (grams > 0 && pct > 0) {\n        derived.push(grams / (pct / 100));\n      }\n    });\n    if (!derived.length) return 0;\n    const sum = derived.reduce((acc, value) => acc + value, 0);\n    return sum / derived.length;\n  }\n\n  function getRowLimits(row, target){\n    if (!row || !target || target <= 0) {\n      return { allowedGrams: null, allowedPct: null };\n    }\n    const rows = Array.from(document.querySelectorAll('#oilRows .oil-row'));\n    const otherTotal = rows.reduce((acc, current) => {\n      if (current === row) return acc;\n      return acc + toGrams(current.querySelector('.oil-grams')?.value);\n    }, 0);\n    const otherPct = rows.reduce((acc, current) => {\n      if (current === row) return acc;\n      return acc + clamp(toNumber(current.querySelector('.oil-percent')?.value), 0);\n    }, 0);\n    const allowedPct = Math.max(0, 100 - otherPct);\n    const allowedByTotal = Math.max(0, target - otherTotal);\n    const allowedByPct = (target * allowedPct) / 100;\n    const allowedGrams = Math.max(0, Math.min(allowedByTotal, allowedByPct));\n    return { allowedGrams, allowedPct };\n  }\n\n  function setOilHint(row, field, message){\n    if (!row) return;\n    const hint = row.querySelector(`[data-role=\"oil-${field}-hint\"]`);\n    if (!hint) return;\n    if (message) {\n      hint.textContent = message;\n      hint.classList.add('is-visible');\n    } else {\n      hint.textContent = '';\n      hint.classList.remove('is-visible');\n    }\n  }\n\n  function bounceInput(input){\n    if (!input) return;\n    input.classList.remove('oil-input-bounce');\n    void input.offsetWidth;\n    input.classList.add('oil-input-bounce');\n  }\n\n  function validateOilEntry(row, field, options = {}){\n    const target = getOilTargetGrams();\n    if (!row || !target || target <= 0) {\n      setOilHint(row, field, '');\n      return;\n    }\n    const gramsInput = row.querySelector('.oil-grams');\n    const pctInput = row.querySelector('.oil-percent');\n    const limits = getRowLimits(row, target);\n    if (field === 'grams' && gramsInput) {\n      const grams = toGrams(gramsInput.value);\n      let message = '';\n      if (grams > target + 0.01) {\n        message = 'Entry exceeds the max oils allowed in stage 2.';\n      } else if (limits.allowedGrams !== null && grams > limits.allowedGrams + 0.01) {\n        message = `Must be under ${round(fromGrams(limits.allowedGrams), 2)} ${state.currentUnit} to stay within the stage 2 oil limit.`;\n      }\n      if (message) {\n        const nextValue = limits.allowedGrams !== null ? round(fromGrams(limits.allowedGrams), 2) : round(fromGrams(target), 2);\n        gramsInput.value = nextValue > 0 ? nextValue : '';\n        setOilHint(row, field, message);\n        gramsInput.classList.add('oil-input-warning');\n        bounceInput(gramsInput);\n        updateOilTotals();\n      } else {\n        gramsInput.classList.remove('oil-input-warning');\n        setOilHint(row, field, '');\n      }\n    }\n    if (field === 'percent' && pctInput) {\n      const pct = clamp(toNumber(pctInput.value), 0);\n      let message = '';\n      if (pct > 100.01) {\n        message = 'Entry exceeds the max oils allowed in stage 2.';\n      } else if (limits.allowedPct !== null && pct > limits.allowedPct + 0.01) {\n        message = `Must be under ${round(limits.allowedPct, 2)}% to stay within the stage 2 oil limit.`;\n      }\n      if (message) {\n        const nextPct = limits.allowedPct !== null ? round(limits.allowedPct, 2) : 100;\n        pctInput.value = nextPct > 0 ? nextPct : '';\n        setOilHint(row, field, message);\n        pctInput.classList.add('oil-input-warning');\n        bounceInput(pctInput);\n        updateOilTotals();\n      } else {\n        pctInput.classList.remove('oil-input-warning');\n        setOilHint(row, field, '');\n      }\n    }\n  }\n\n  function scaleOilsToTarget(target, options = {}){\n    const rows = Array.from(document.querySelectorAll('#oilRows .oil-row'));\n    const nextTarget = target ?? getOilTargetGrams();\n    const force = !!options.force;\n    if (!nextTarget || nextTarget <= 0 || !rows.length) {\n      state.lastOilTarget = nextTarget;\n      return;\n    }\n    const totalPct = rows.reduce((sum, row) => sum + clamp(toNumber(row.querySelector('.oil-percent')?.value), 0), 0);\n    const totalWeight = rows.reduce((sum, row) => sum + toGrams(row.querySelector('.oil-grams')?.value), 0);\n    if (totalPct <= 0 && totalWeight <= 0) {\n      state.lastOilTarget = nextTarget;\n      return;\n    }\n    if (!force && state.lastOilTarget && Math.abs(state.lastOilTarget - nextTarget) < 0.01) {\n      return;\n    }\n    if (totalPct > 0) {\n      rows.forEach(row => {\n        const pctInput = row.querySelector('.oil-percent');\n        const gramsInput = row.querySelector('.oil-grams');\n        const pct = clamp(toNumber(pctInput?.value), 0);\n        const share = totalPct > 0 ? (pct / totalPct) : 0;\n        if (gramsInput) {\n          gramsInput.value = share > 0 ? round(fromGrams(nextTarget * share), 2) : '';\n        }\n        if (pctInput) {\n          pctInput.value = share > 0 ? round(share * 100, 2) : '';\n        }\n      });\n    } else if (totalWeight > 0) {\n      const ratio = nextTarget / totalWeight;\n      rows.forEach(row => {\n        const gramsInput = row.querySelector('.oil-grams');\n        const pctInput = row.querySelector('.oil-percent');\n        const grams = toGrams(gramsInput?.value);\n        if (gramsInput) {\n          const nextGrams = grams > 0 ? grams * ratio : 0;\n          gramsInput.value = nextGrams > 0 ? round(fromGrams(nextGrams), 2) : '';\n        }\n        if (pctInput) {\n          const nextGrams = toGrams(gramsInput?.value);\n          pctInput.value = nextGrams > 0 ? round((nextGrams / nextTarget) * 100, 2) : '';\n        }\n      });\n    }\n    state.lastOilTarget = nextTarget;\n    updateOilTotals({ skipEnforce: true });\n  }\n\n  function enforceOilTargetCap(rows, target){\n    if (!state.lastOilEdit || !state.lastOilEdit.row) return false;\n    const lastRow = state.lastOilEdit.row;\n    const otherTotal = rows.reduce((acc, row) => {\n      if (row === lastRow) return acc;\n      return acc + toGrams(row.querySelector('.oil-grams')?.value);\n    }, 0);\n    const allowed = Math.max(0, target - otherTotal);\n    const gramsInput = lastRow.querySelector('.oil-grams');\n    const pctInput = lastRow.querySelector('.oil-percent');\n    if (!gramsInput || !pctInput) return false;\n    gramsInput.value = allowed > 0 ? round(fromGrams(allowed), 2) : '';\n    pctInput.value = allowed > 0 ? round((allowed / target) * 100, 2) : '';\n    state.wasCapped = true;\n    return true;\n  }\n\n  function updateOilLimitWarning({ totalWeight, totalPct, target, capped }){\n    const warning = document.getElementById('oilLimitWarning');\n    if (!warning) return;\n    const messages = [];\n    if (capped) {\n      messages.push('Oil total hit the mold cap and was adjusted.');\n    }\n    if (target > 0 && totalWeight > target + 0.01) {\n      const over = totalWeight - target;\n      messages.push(`Oil weights exceed the target by ${round(fromGrams(over), 2)} ${state.currentUnit}.`);\n    }\n    if (totalPct > 100.01) {\n      messages.push(`Oil percentages are over 100% by ${round(totalPct - 100, 2)}%.`);\n    }\n    if (messages.length) {\n      warning.classList.remove('d-none');\n      warning.innerHTML = `${messages.join(' ')} Adjust oils or mold % to continue.`;\n    } else {\n      warning.classList.add('d-none');\n      warning.textContent = '';\n    }\n  }\n\n  function updateOilTotals(options = {}){\n    if (!options.skipEnforce) {\n      state.wasCapped = false;\n    }\n    const rows = Array.from(document.querySelectorAll('#oilRows .oil-row'));\n    const mold = SoapTool.mold.getMoldSettings();\n    let target = getOilTargetGrams();\n    if (!target && !mold.targetOils) {\n      const derived = deriveTargetFromRows(rows);\n      if (derived > 0) {\n        target = derived;\n        const targetInput = document.getElementById('oilTotalTarget');\n        if (targetInput && !targetInput.value) {\n          targetInput.value = round(fromGrams(derived), 2);\n        }\n      }\n    }\n\n    let totalWeight = 0;\n    let totalPct = 0;\n\n    rows.forEach(row => {\n      const gramsInput = row.querySelector('.oil-grams');\n      const pctInput = row.querySelector('.oil-percent');\n      let grams = toGrams(gramsInput?.value);\n      let pct = clamp(toNumber(pctInput?.value), 0);\n      if (target > 0) {\n        if (state.lastOilEdit && state.lastOilEdit.row === row && state.lastOilEdit.field === 'percent') {\n          grams = pct > 0 ? target * (pct / 100) : 0;\n          gramsInput.value = pct > 0 ? round(fromGrams(grams), 2) : '';\n        } else {\n          if (grams > 0) {\n            pct = (grams / target) * 100;\n            pctInput.value = round(pct, 2);\n          } else if (pct > 0) {\n            grams = target * (pct / 100);\n            gramsInput.value = round(fromGrams(grams), 2);\n          }\n        }\n        totalPct += pct;\n      }\n      if (grams > 0) totalWeight += grams;\n    });\n\n    if (target <= 0) {\n      if (totalWeight > 0) {\n        totalPct = 0;\n        rows.forEach(row => {\n          const gramsInput = row.querySelector('.oil-grams');\n          const pctInput = row.querySelector('.oil-percent');\n          const grams = toGrams(gramsInput?.value);\n          if (grams > 0) {\n            const pct = (grams / totalWeight) * 100;\n            pctInput.value = round(pct, 2);\n            totalPct += pct;\n          }\n        });\n      } else {\n        totalPct = rows.reduce((sum, row) => sum + clamp(toNumber(row.querySelector('.oil-percent')?.value), 0), 0);\n      }\n    }\n\n    if (!options.skipEnforce && mold.targetOils > 0 && totalWeight > mold.targetOils + 0.01) {\n      if (enforceOilTargetCap(rows, mold.targetOils)) {\n        return updateOilTotals({ skipEnforce: true });\n      }\n    }\n\n    state.totalOilsGrams = totalWeight;\n    const totalLabel = document.getElementById('oilTotalComputed');\n    if (totalLabel) {\n      totalLabel.textContent = totalWeight > 0 ? `${round(fromGrams(totalWeight), 2)} ${state.currentUnit}` : '--';\n    }\n    document.getElementById('oilPercentTotal').textContent = round(totalPct, 2);\n    updateOilLimitWarning({ totalWeight, totalPct, target, capped: state.wasCapped });\n    SoapTool.additives.updateAdditivesOutput(totalWeight);\n    SoapTool.mold.updateMoldSuggested();\n    updateOilTips();\n    return { totalWeight, totalPct, target };\n  }\n\n  function normalizeOils(){\n    const rows = Array.from(document.querySelectorAll('#oilRows .oil-row'));\n    if (!rows.length) return;\n    const target = getOilTargetGrams();\n    let totalPct = rows.reduce((sum, row) => sum + clamp(toNumber(row.querySelector('.oil-percent')?.value), 0), 0);\n    if (!totalPct && target > 0) {\n      totalPct = rows.reduce((sum, row) => {\n        const grams = toGrams(row.querySelector('.oil-grams')?.value);\n        return sum + (grams > 0 ? (grams / target) * 100 : 0);\n      }, 0);\n    }\n    if (totalPct <= 0) return;\n    rows.forEach(row => {\n      const pctInput = row.querySelector('.oil-percent');\n      const gramsInput = row.querySelector('.oil-grams');\n      const pct = clamp(toNumber(pctInput.value), 0);\n      const nextPct = (pct / totalPct) * 100;\n      pctInput.value = round(nextPct, 2);\n      if (target > 0) {\n        gramsInput.value = nextPct > 0 ? round(fromGrams(target * (nextPct / 100)), 2) : '';\n      }\n    });\n    updateOilTotals();\n  }\n\n  function collectOilData(){\n    const oils = [];\n    document.querySelectorAll('#oilRows .oil-row').forEach(row => {\n      const name = row.querySelector('.oil-typeahead')?.value?.trim();\n      const grams = toGrams(row.querySelector('.oil-grams')?.value);\n      const sapKoh = toNumber(row.querySelector('.oil-sap-koh')?.value);\n      const iodine = toNumber(row.querySelector('.oil-iodine')?.value);\n      const fattyRaw = row.querySelector('.oil-fatty')?.value || '';\n      const gi = row.querySelector('.oil-gi-id')?.value || '';\n      const defaultUnit = row.querySelector('.oil-default-unit')?.value || '';\n      const categoryName = row.querySelector('.oil-category')?.value || '';\n      let fattyProfile = null;\n      if (fattyRaw) {\n        try {\n          fattyProfile = JSON.parse(fattyRaw);\n        } catch (_) {\n          fattyProfile = null;\n        }\n      }\n      if (grams <= 0) return;\n      oils.push({\n        name: name || null,\n        grams,\n        sapKoh,\n        iodine,\n        fattyProfile,\n        global_item_id: gi ? parseInt(gi) : null,\n        default_unit: defaultUnit || null,\n        ingredient_category_name: categoryName || null,\n      });\n    });\n    return oils;\n  }\n\n  function updateSelectedOilProfileDisplay({ name, sapKoh, iodine, fattyProfile } = {}){\n    const floatCard = document.getElementById('oilProfileFloat');\n    const setText = (id, value) => {\n      const el = document.getElementById(id);\n      if (el) el.textContent = value;\n    };\n    const nameLabel = name || 'Pick an oil to preview';\n    setText('selectedOilName', nameLabel);\n    setText('selectedOilModalName', nameLabel);\n    if (floatCard) {\n      floatCard.classList.toggle('d-none', !name);\n    }\n    const sapValue = sapKoh > 0 ? round(sapKoh, 1) : '--';\n    const iodineValue = iodine > 0 ? round(iodine, 1) : '--';\n    setText('selectedOilSap', sapValue);\n    setText('selectedOilModalSap', sapValue);\n    setText('selectedOilIodine', iodineValue);\n    setText('selectedOilModalIodine', iodineValue);\n\n    const qualities = fattyProfile ? computeQualities(fattyProfile) : {};\n    const setValue = (id, value) => {\n      const safe = isFinite(value) && value > 0 ? round(value, 1) : '--';\n      setText(id, safe);\n    };\n    setValue('selectedOilHardness', qualities.hardness);\n    setValue('selectedOilModalHardness', qualities.hardness);\n    setValue('selectedOilCleansing', qualities.cleansing);\n    setValue('selectedOilModalCleansing', qualities.cleansing);\n    setValue('selectedOilConditioning', qualities.conditioning);\n    setValue('selectedOilModalConditioning', qualities.conditioning);\n    setValue('selectedOilBubbly', qualities.bubbly);\n    setValue('selectedOilModalBubbly', qualities.bubbly);\n    setValue('selectedOilCreamy', qualities.creamy);\n    setValue('selectedOilModalCreamy', qualities.creamy);\n\n    const fattyKeys = ['lauric', 'myristic', 'palmitic', 'stearic', 'ricinoleic', 'oleic', 'linoleic', 'linolenic'];\n    fattyKeys.forEach(key => {\n      const baseId = `selectedOil${key.charAt(0).toUpperCase()}${key.slice(1)}`;\n      const modalId = `selectedOilModal${key.charAt(0).toUpperCase()}${key.slice(1)}`;\n      const value = fattyProfile ? toNumber(fattyProfile[key]) : 0;\n      const safe = value > 0 ? round(value, 1) : '--';\n      setText(baseId, safe);\n      setText(modalId, safe);\n    });\n  }\n\n  function setSelectedOilProfile(picked){\n    if (!picked) {\n      clearSelectedOilProfile();\n      return;\n    }\n    state.selectedOilProfile = picked;\n    let fattyProfile = picked.fatty_acid_profile || null;\n    if (typeof fattyProfile === 'string') {\n      try {\n        fattyProfile = JSON.parse(fattyProfile);\n      } catch (_) {\n        fattyProfile = null;\n      }\n    }\n    updateSelectedOilProfileDisplay({\n      name: picked.text || picked.display_name || picked.name,\n      sapKoh: toNumber(picked.saponification_value),\n      iodine: toNumber(picked.iodine_value),\n      fattyProfile,\n    });\n  }\n\n  function setSelectedOilProfileFromRow(row){\n    if (!row) return;\n    const name = row.querySelector('.oil-typeahead')?.value?.trim();\n    const sapKoh = toNumber(row.querySelector('.oil-sap-koh')?.value);\n    const iodine = toNumber(row.querySelector('.oil-iodine')?.value);\n    const fattyRaw = row.querySelector('.oil-fatty')?.value || '';\n    let fattyProfile = null;\n    if (fattyRaw) {\n      try {\n        fattyProfile = JSON.parse(fattyRaw);\n      } catch (_) {\n        fattyProfile = null;\n      }\n    }\n    updateSelectedOilProfileDisplay({\n      name,\n      sapKoh,\n      iodine,\n      fattyProfile,\n    });\n  }\n\n  function clearSelectedOilProfile(){\n    state.selectedOilProfile = null;\n    state.lastPreviewRow = null;\n    updateSelectedOilProfileDisplay();\n  }\n\n  function updateOilTips(){\n    const tipBox = document.getElementById('oilBlendTips');\n    if (!tipBox) return;\n    const oils = collectOilData().filter(oil => oil.grams > 0 || oil.percent > 0);\n    if (!oils.length) {\n      tipBox.classList.add('d-none');\n      tipBox.textContent = '';\n      return;\n    }\n    const tips = new Set();\n    oils.forEach(oil => {\n      const name = (oil.name || '').toLowerCase();\n      if (name) {\n        OIL_TIP_RULES.forEach(rule => {\n          if (rule.match.test(name)) tips.add(rule.tip);\n        });\n      }\n      if (oil.fattyProfile && typeof oil.fattyProfile === 'object') {\n        const lauric = toNumber(oil.fattyProfile.lauric);\n        const myristic = toNumber(oil.fattyProfile.myristic);\n        const palmitic = toNumber(oil.fattyProfile.palmitic);\n        const stearic = toNumber(oil.fattyProfile.stearic);\n        const ricinoleic = toNumber(oil.fattyProfile.ricinoleic);\n        const oleic = toNumber(oil.fattyProfile.oleic);\n        const linoleic = toNumber(oil.fattyProfile.linoleic);\n        const linolenic = toNumber(oil.fattyProfile.linolenic);\n        if (lauric + myristic >= 30) {\n          tips.add(`${oil.name || 'This oil'} is high in lauric/myristic; expect faster trace and stronger cleansing.`);\n        }\n        if (palmitic + stearic >= 40) {\n          tips.add(`${oil.name || 'This oil'} is high in palmitic/stearic; expect a harder bar and quicker set-up.`);\n        }\n        if (oleic >= 60) {\n          tips.add(`${oil.name || 'This oil'} is high oleic; trace may be slow and bars may start softer.`);\n        }\n        if (linoleic + linolenic >= 20) {\n          tips.add(`${oil.name || 'This oil'} is high in PUFAs; keep the % lower to reduce DOS risk.`);\n        }\n        if (ricinoleic >= 60) {\n          tips.add(`${oil.name || 'This oil'} boosts lather but can feel tacky; keep under 10-15%.`);\n        }\n      }\n    });\n    const tipList = Array.from(tips).slice(0, 6);\n    if (!tipList.length) {\n      tipBox.classList.add('d-none');\n      tipBox.textContent = '';\n      return;\n    }\n    tipBox.classList.remove('d-none');\n    tipBox.innerHTML = `<strong>Blend behavior tips:</strong><ul class=\"mb-0\">${tipList.map(tip => `<li>${tip}</li>`).join('')}</ul>`;\n  }\n\n  function getTotalOilsGrams(){\n    return state.totalOilsGrams || 0;\n  }\n\n  function serializeOilRow(row){\n    if (!row) return null;\n    return {\n      name: row.querySelector('.oil-typeahead')?.value || '',\n      grams: row.querySelector('.oil-grams')?.value || '',\n      percent: row.querySelector('.oil-percent')?.value || '',\n      sap: row.querySelector('.oil-sap-koh')?.value || '',\n      iodine: row.querySelector('.oil-iodine')?.value || '',\n      fattyRaw: row.querySelector('.oil-fatty')?.value || '',\n      gi: row.querySelector('.oil-gi-id')?.value || '',\n      defaultUnit: row.querySelector('.oil-default-unit')?.value || '',\n      categoryName: row.querySelector('.oil-category')?.value || '',\n    };\n  }\n\n  function matchesCategory(item, allowedSet, source){\n    const category = getItemCategoryName(item);\n    if (!category) {\n      return source === 'inventory';\n    }\n    return allowedSet.has(category);\n  }\n\n  function getItemCategoryName(item){\n    if (!item || typeof item !== 'object') return null;\n    return (item.ingredient && item.ingredient.ingredient_category_name)\n      || item.ingredient_category_name\n      || (item.ingredient_category && item.ingredient_category.name)\n      || null;\n  }\n\n  SoapTool.oils = {\n    attachOilTypeahead,\n    buildOilRow,\n    getOilTargetGrams,\n    updateOilTotals,\n    normalizeOils,\n    collectOilData,\n    setSelectedOilProfileFromRow,\n    clearSelectedOilProfile,\n    updateOilTips,\n    getTotalOilsGrams,\n    serializeOilRow,\n    validateOilEntry,\n    scaleOilsToTarget,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const bulk = SoapTool.bulkOils = SoapTool.bulkOils || {};\n  const { toNumber, clamp } = SoapTool.helpers;\n  const state = SoapTool.state;\n\n  const FATTY_KEYS = Array.isArray(SoapTool.constants?.FATTY_DISPLAY_KEYS)\n    ? SoapTool.constants.FATTY_DISPLAY_KEYS.slice()\n    : ['lauric', 'myristic', 'palmitic', 'stearic', 'ricinoleic', 'oleic', 'linoleic', 'linolenic'];\n  const LOCAL_SORT_KEYS = new Set(['selected_pct', 'selected_weight_g']);\n  const PAGE_SIZE = 25;\n  const SCROLL_FETCH_THRESHOLD = 140;\n  const SEARCH_DEBOUNCE_MS = 260;\n  const DEFAULT_MODAL_STATE = {\n    mode: 'basics',\n    viewSelected: false,\n    query: '',\n    sortKey: 'name',\n    sortDir: 'asc',\n    selection: {},\n    recordByKey: {},\n    visibleRecords: [],\n    offset: 0,\n    totalCount: 0,\n    hasMore: true,\n    loading: false,\n    requestToken: 0,\n  };\n\n  function queueStateSave(){\n    SoapTool.storage?.queueStateSave?.();\n  }\n\n  function showAlert(level, message){\n    SoapTool.ui?.showSoapAlert?.(level, message, { dismissible: true, timeoutMs: 6000 });\n  }\n\n  function getRefs(){\n    return {\n      modalEl: document.getElementById('bulkOilModal'),\n      openBtn: document.getElementById('openBulkOilModal'),\n      searchInput: document.getElementById('bulkOilSearchInput'),\n      modeToggle: document.getElementById('bulkOilDisplayAllToggle'),\n      viewSelectedToggle: document.getElementById('bulkOilViewSelectedToggle'),\n      statusEl: document.getElementById('bulkOilCatalogStatus'),\n      summaryEl: document.getElementById('bulkOilSelectedSummary'),\n      stageCountEl: document.getElementById('bulkOilSelectionCount'),\n      bodyEl: document.getElementById('bulkOilCatalogBody'),\n      scrollEl: document.getElementById('bulkOilCatalogScroll'),\n      importBtn: document.getElementById('bulkOilImportBtn'),\n      clearBtn: document.getElementById('bulkOilClearSelectionBtn'),\n      unitLabelEl: document.getElementById('bulkOilWeightUnitLabel'),\n    };\n  }\n\n  function isSupportedSortKey(sortKey){\n    if (!sortKey) return false;\n    if (sortKey === 'name') return true;\n    if (LOCAL_SORT_KEYS.has(sortKey)) return true;\n    return FATTY_KEYS.includes(sortKey);\n  }\n\n  function ensureModalState(){\n    if (!state.bulkOilModal || typeof state.bulkOilModal !== 'object') {\n      state.bulkOilModal = JSON.parse(JSON.stringify(DEFAULT_MODAL_STATE));\n    }\n    const modalState = state.bulkOilModal;\n    modalState.mode = modalState.mode === 'all' ? 'all' : 'basics';\n    modalState.viewSelected = !!modalState.viewSelected;\n    modalState.query = typeof modalState.query === 'string' ? modalState.query : '';\n    modalState.sortKey = isSupportedSortKey(modalState.sortKey) ? modalState.sortKey : 'name';\n    modalState.sortDir = modalState.sortDir === 'desc' ? 'desc' : 'asc';\n    modalState.selection = modalState.selection && typeof modalState.selection === 'object' ? modalState.selection : {};\n    modalState.recordByKey = modalState.recordByKey && typeof modalState.recordByKey === 'object' ? modalState.recordByKey : {};\n    modalState.visibleRecords = Array.isArray(modalState.visibleRecords) ? modalState.visibleRecords : [];\n    modalState.offset = Math.max(0, parseInt(modalState.offset, 10) || 0);\n    modalState.totalCount = Math.max(0, parseInt(modalState.totalCount, 10) || 0);\n    modalState.hasMore = modalState.hasMore !== false;\n    modalState.loading = !!modalState.loading;\n    modalState.requestToken = Math.max(0, parseInt(modalState.requestToken, 10) || 0);\n    return modalState;\n  }\n\n  function normalizeFattyProfile(rawProfile){\n    const profile = {};\n    const input = rawProfile && typeof rawProfile === 'object' ? rawProfile : {};\n    FATTY_KEYS.forEach(key => {\n      const value = toNumber(input[key]);\n      if (value > 0) {\n        profile[key] = value;\n      }\n    });\n    return profile;\n  }\n\n  function normalizeCatalogRecord(raw){\n    const fattyProfile = normalizeFattyProfile(raw?.fatty_profile);\n    const name = String(raw?.name || '').trim();\n    const source = String(raw?.source || 'soapcalc').trim().toLowerCase() || 'soapcalc';\n    const globalItemId = Number.isInteger(raw?.global_item_id)\n      ? raw.global_item_id\n      : (toNumber(raw?.global_item_id) > 0 ? parseInt(raw.global_item_id, 10) : null);\n    const key = String(raw?.key || (globalItemId ? `global:${globalItemId}` : `${source}:${name.toLowerCase()}`));\n    return {\n      key,\n      name,\n      sap_koh: toNumber(raw?.sap_koh),\n      iodine: toNumber(raw?.iodine),\n      fatty_profile: fattyProfile,\n      default_unit: String(raw?.default_unit || 'gram'),\n      ingredient_category_name: String(raw?.ingredient_category_name || 'Oils (Carrier & Fixed)'),\n      global_item_id: globalItemId,\n      source,\n      is_basic: !!raw?.is_basic,\n    };\n  }\n\n  function updateSelectionCounters(){\n    const refs = getRefs();\n    const modalState = ensureModalState();\n    const count = Object.keys(modalState.selection || {}).length;\n    const summary = `Selected: ${count}`;\n    if (refs.summaryEl) refs.summaryEl.textContent = summary;\n    if (refs.stageCountEl) refs.stageCountEl.textContent = String(count);\n  }\n\n  function selectionForRecordKey(recordKey){\n    const modalState = ensureModalState();\n    return modalState.selection?.[recordKey] || null;\n  }\n\n  function setSelection(record, values = {}){\n    const modalState = ensureModalState();\n    if (!record || !record.key) return null;\n    const existing = modalState.selection[record.key] || {};\n    const next = {\n      key: record.key,\n      name: record.name,\n      sap_koh: record.sap_koh,\n      iodine: record.iodine,\n      fatty_profile: record.fatty_profile || {},\n      default_unit: record.default_unit || 'gram',\n      ingredient_category_name: record.ingredient_category_name || '',\n      global_item_id: record.global_item_id || null,\n      source: record.source || 'soapcalc',\n      is_basic: !!record.is_basic,\n      selected_pct: clamp(toNumber(values.selected_pct ?? existing.selected_pct), 0, 100),\n      selected_weight_g: clamp(toNumber(values.selected_weight_g ?? existing.selected_weight_g), 0),\n    };\n    modalState.selection[record.key] = next;\n    return next;\n  }\n\n  function removeSelection(recordKey){\n    const modalState = ensureModalState();\n    if (modalState.selection?.[recordKey]) {\n      delete modalState.selection[recordKey];\n    }\n  }\n\n  function getRecordByKey(recordKey){\n    const modalState = ensureModalState();\n    return modalState.recordByKey?.[recordKey] || null;\n  }\n\n  function serializeSelection(){\n    const modalState = ensureModalState();\n    return {\n      mode: modalState.mode,\n      view_selected: !!modalState.viewSelected,\n      query: modalState.query,\n      sort_key: modalState.sortKey,\n      sort_dir: modalState.sortDir,\n      selections: Object.values(modalState.selection || {}).map(item => ({\n        key: item.key,\n        name: item.name,\n        sap_koh: item.sap_koh,\n        iodine: item.iodine,\n        fatty_profile: item.fatty_profile || {},\n        default_unit: item.default_unit,\n        ingredient_category_name: item.ingredient_category_name,\n        global_item_id: item.global_item_id,\n        source: item.source,\n        is_basic: !!item.is_basic,\n        selected_pct: clamp(toNumber(item.selected_pct), 0, 100),\n        selected_weight_g: clamp(toNumber(item.selected_weight_g), 0),\n      })),\n    };\n  }\n\n  function restoreState(savedState){\n    const modalState = ensureModalState();\n    modalState.mode = savedState?.mode === 'all' ? 'all' : 'basics';\n    modalState.viewSelected = !!savedState?.view_selected;\n    modalState.query = typeof savedState?.query === 'string' ? savedState.query : '';\n    modalState.sortKey = isSupportedSortKey(savedState?.sort_key) ? savedState.sort_key : 'name';\n    modalState.sortDir = savedState?.sort_dir === 'desc' ? 'desc' : 'asc';\n    const selection = {};\n    const rows = Array.isArray(savedState?.selections) ? savedState.selections : [];\n    rows.forEach(raw => {\n      const key = String(raw?.key || '').trim();\n      const name = String(raw?.name || '').trim();\n      if (!key || !name) return;\n      selection[key] = {\n        key,\n        name,\n        sap_koh: toNumber(raw?.sap_koh),\n        iodine: toNumber(raw?.iodine),\n        fatty_profile: normalizeFattyProfile(raw?.fatty_profile),\n        default_unit: String(raw?.default_unit || 'gram'),\n        ingredient_category_name: String(raw?.ingredient_category_name || ''),\n        global_item_id: toNumber(raw?.global_item_id) > 0 ? parseInt(raw.global_item_id, 10) : null,\n        source: String(raw?.source || 'soapcalc'),\n        is_basic: !!raw?.is_basic,\n        selected_pct: clamp(toNumber(raw?.selected_pct), 0, 100),\n        selected_weight_g: clamp(toNumber(raw?.selected_weight_g), 0),\n      };\n    });\n    modalState.selection = selection;\n    modalState.visibleRecords = [];\n    modalState.offset = 0;\n    modalState.totalCount = 0;\n    modalState.hasMore = true;\n    modalState.loading = false;\n    updateSelectionCounters();\n  }\n\n  bulk.shared = {\n    FATTY_KEYS,\n    LOCAL_SORT_KEYS,\n    PAGE_SIZE,\n    SCROLL_FETCH_THRESHOLD,\n    SEARCH_DEBOUNCE_MS,\n    queueStateSave,\n    showAlert,\n    getRefs,\n    ensureModalState,\n    normalizeFattyProfile,\n    normalizeCatalogRecord,\n    updateSelectionCounters,\n    selectionForRecordKey,\n    setSelection,\n    removeSelection,\n    getRecordByKey,\n    serializeSelection,\n    restoreState,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const bulk = SoapTool.bulkOils = SoapTool.bulkOils || {};\n  const shared = bulk.shared;\n  if (!shared) return;\n\n  const { round, toNumber } = SoapTool.helpers;\n  const { fromGrams } = SoapTool.units;\n  const {\n    FATTY_KEYS,\n    LOCAL_SORT_KEYS,\n    getRefs,\n    ensureModalState,\n    selectionForRecordKey,\n    updateSelectionCounters,\n  } = shared;\n\n  function updateStatusText(text){\n    const refs = getRefs();\n    if (refs.statusEl) refs.statusEl.textContent = text;\n  }\n\n  function refreshCatalogStatus(){\n    const modalState = ensureModalState();\n    const modeLabel = modalState.mode === 'all' ? 'all oils' : 'SoapCalc basics';\n    if (modalState.loading && !modalState.visibleRecords.length) {\n      updateStatusText('Loading oils...');\n      return;\n    }\n    if (!modalState.visibleRecords.length) {\n      const noMatchLabel = modalState.query ? 'No oils match that search.' : 'No oils available.';\n      updateStatusText(noMatchLabel);\n      return;\n    }\n    const loaded = modalState.visibleRecords.length;\n    const total = modalState.totalCount;\n    const moreHint = modalState.hasMore ? ' \u2022 scroll for more' : '';\n    const queryHint = modalState.query ? ` \u2022 search: \"${modalState.query}\"` : '';\n    updateStatusText(`Loaded ${loaded}/${total} in ${modeLabel}${queryHint}${moreHint}`);\n  }\n\n  function compareValues(aValue, bValue, dir){\n    if (typeof aValue === 'string' || typeof bValue === 'string') {\n      const left = String(aValue || '').toLowerCase();\n      const right = String(bValue || '').toLowerCase();\n      if (left < right) return dir === 'asc' ? -1 : 1;\n      if (left > right) return dir === 'asc' ? 1 : -1;\n      return 0;\n    }\n    const aNum = toNumber(aValue);\n    const bNum = toNumber(bValue);\n    if (aNum < bNum) return dir === 'asc' ? -1 : 1;\n    if (aNum > bNum) return dir === 'asc' ? 1 : -1;\n    return 0;\n  }\n\n  function localSortValue(record, sortKey){\n    if (sortKey === 'selected_pct') return selectionForRecordKey(record.key)?.selected_pct || 0;\n    if (sortKey === 'selected_weight_g') return selectionForRecordKey(record.key)?.selected_weight_g || 0;\n    return '';\n  }\n\n  function applyLocalSelectionSortIfNeeded(){\n    const modalState = ensureModalState();\n    if (!LOCAL_SORT_KEYS.has(modalState.sortKey)) return;\n    modalState.visibleRecords.sort((left, right) => {\n      const primary = compareValues(\n        localSortValue(left, modalState.sortKey),\n        localSortValue(right, modalState.sortKey),\n        modalState.sortDir\n      );\n      if (primary !== 0) return primary;\n      return compareValues(left.name || '', right.name || '', 'asc');\n    });\n  }\n\n  function applyViewSelectedOrderingIfNeeded(){\n    const modalState = ensureModalState();\n    if (!modalState.viewSelected) return;\n    const selected = [];\n    const others = [];\n    modalState.visibleRecords.forEach(record => {\n      if (selectionForRecordKey(record.key)) {\n        selected.push(record);\n      } else {\n        others.push(record);\n      }\n    });\n    modalState.visibleRecords = selected.concat(others);\n  }\n\n  function applyClientOrdering(){\n    applyLocalSelectionSortIfNeeded();\n    applyViewSelectedOrderingIfNeeded();\n  }\n\n  function normalizeServerSortKey(sortKey){\n    const key = String(sortKey || '').trim().toLowerCase();\n    if (key === 'name') return key;\n    if (FATTY_KEYS.includes(key)) return key;\n    return 'name';\n  }\n\n  function sortButtonsLabel(){\n    const modalState = ensureModalState();\n    document.querySelectorAll('.bulk-oil-sort').forEach(button => {\n      if (!button.dataset.label) {\n        button.dataset.label = String(button.textContent || '').replace(/[\u25B2\u25BC]\\s*$/, '').trim();\n      }\n      const label = button.dataset.label || '';\n      const key = button.dataset.sortKey || '';\n      if (modalState.sortKey === key) {\n        button.textContent = `${label} ${modalState.sortDir === 'asc' ? '\u25B2' : '\u25BC'}`;\n      } else {\n        button.textContent = label;\n      }\n    });\n  }\n\n  function updateRowFromSelection(row, record){\n    const selection = selectionForRecordKey(record.key);\n    const checkbox = row.querySelector('.bulk-oil-check');\n    const pctInput = row.querySelector('.bulk-oil-pct');\n    const weightInput = row.querySelector('.bulk-oil-weight');\n    if (checkbox) checkbox.checked = !!selection;\n    if (pctInput) pctInput.value = selection && selection.selected_pct > 0 ? round(selection.selected_pct, 2) : '';\n    if (weightInput) {\n      weightInput.value = selection && selection.selected_weight_g > 0\n        ? round(fromGrams(selection.selected_weight_g), 2)\n        : '';\n    }\n  }\n\n  function createFattyCell(value){\n    const cell = document.createElement('td');\n    cell.className = 'bulk-oil-acid';\n    const numeric = toNumber(value);\n    cell.textContent = numeric > 0 ? round(numeric, 1).toString() : '--';\n    return cell;\n  }\n\n  function createRow(record){\n    const row = document.createElement('tr');\n    row.dataset.recordKey = record.key;\n\n    const pickCell = document.createElement('td');\n    pickCell.className = 'text-center';\n    const checkbox = document.createElement('input');\n    checkbox.type = 'checkbox';\n    checkbox.className = 'form-check-input bulk-oil-check';\n    pickCell.appendChild(checkbox);\n    row.appendChild(pickCell);\n\n    const nameCell = document.createElement('td');\n    nameCell.className = 'bulk-oil-name';\n    const title = document.createElement('div');\n    title.className = 'fw-semibold small';\n    title.textContent = record.name;\n    const detail = document.createElement('div');\n    detail.className = 'text-muted small';\n    const category = record.ingredient_category_name ? ` \u00B7 ${record.ingredient_category_name}` : '';\n    detail.textContent = `${record.source}${category}`;\n    nameCell.appendChild(title);\n    nameCell.appendChild(detail);\n    row.appendChild(nameCell);\n\n    FATTY_KEYS.forEach(key => {\n      row.appendChild(createFattyCell(record.fatty_profile?.[key]));\n    });\n\n    const pctCell = document.createElement('td');\n    const pctInput = document.createElement('input');\n    pctInput.type = 'number';\n    pctInput.min = '0';\n    pctInput.max = '100';\n    pctInput.step = '0.1';\n    pctInput.className = 'form-control form-control-sm bulk-oil-input bulk-oil-pct';\n    pctCell.appendChild(pctInput);\n    row.appendChild(pctCell);\n\n    const weightCell = document.createElement('td');\n    const weightInput = document.createElement('input');\n    weightInput.type = 'number';\n    weightInput.min = '0';\n    weightInput.step = '0.1';\n    weightInput.className = 'form-control form-control-sm bulk-oil-input bulk-oil-weight';\n    weightCell.appendChild(weightInput);\n    row.appendChild(weightCell);\n\n    updateRowFromSelection(row, record);\n    return row;\n  }\n\n  function renderVisibleRecords(){\n    const refs = getRefs();\n    const modalState = ensureModalState();\n    if (!refs.bodyEl) return;\n    refs.bodyEl.innerHTML = '';\n    const fragment = document.createDocumentFragment();\n    modalState.visibleRecords.forEach(record => {\n      fragment.appendChild(createRow(record));\n    });\n    refs.bodyEl.appendChild(fragment);\n    sortButtonsLabel();\n    updateSelectionCounters();\n    refreshCatalogStatus();\n  }\n\n  bulk.render = {\n    updateStatusText,\n    refreshCatalogStatus,\n    applyLocalSelectionSortIfNeeded,\n    applyViewSelectedOrderingIfNeeded,\n    applyClientOrdering,\n    normalizeServerSortKey,\n    sortButtonsLabel,\n    renderVisibleRecords,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const bulk = SoapTool.bulkOils = SoapTool.bulkOils || {};\n  const shared = bulk.shared;\n  const render = bulk.render;\n  if (!shared || !render) return;\n\n  const {\n    PAGE_SIZE,\n    getRefs,\n    ensureModalState,\n    normalizeCatalogRecord,\n  } = shared;\n  const {\n    refreshCatalogStatus,\n    normalizeServerSortKey,\n    applyClientOrdering,\n    renderVisibleRecords,\n    updateStatusText,\n  } = render;\n\n  function resetVisibleCatalogForFetch(){\n    const modalState = ensureModalState();\n    const refs = getRefs();\n    modalState.visibleRecords = [];\n    modalState.offset = 0;\n    modalState.totalCount = 0;\n    modalState.hasMore = true;\n    if (refs.bodyEl) refs.bodyEl.innerHTML = '';\n    if (refs.scrollEl) refs.scrollEl.scrollTop = 0;\n  }\n\n  async function fetchCatalogPage({ reset = false } = {}){\n    const modalState = ensureModalState();\n    const refs = getRefs();\n    if (!refs.modalEl) return;\n    if (modalState.loading && !reset) return;\n    if (!modalState.hasMore && !reset) return;\n\n    if (reset) {\n      resetVisibleCatalogForFetch();\n    }\n\n    const requestToken = modalState.requestToken + 1;\n    modalState.requestToken = requestToken;\n    modalState.loading = true;\n    refreshCatalogStatus();\n\n    const params = new URLSearchParams();\n    params.set('mode', modalState.mode);\n    params.set('offset', String(modalState.offset));\n    params.set('limit', String(PAGE_SIZE));\n    params.set('q', modalState.query || '');\n    params.set('sort_key', normalizeServerSortKey(modalState.sortKey));\n    params.set('sort_dir', modalState.sortDir === 'desc' ? 'desc' : 'asc');\n\n    try {\n      const response = await fetch(`/tools/api/soap/oils-catalog?${params.toString()}`);\n      if (!response.ok) {\n        throw new Error('Unable to load oils catalog');\n      }\n      const payload = await response.json();\n      if (!payload || payload.success !== true || !payload.result || !Array.isArray(payload.result.records)) {\n        throw new Error('Invalid oils catalog response');\n      }\n      if (requestToken !== modalState.requestToken) {\n        return;\n      }\n      const records = payload.result.records.map(normalizeCatalogRecord);\n      const nextOffset = Math.max(0, parseInt(payload.result.next_offset, 10) || (modalState.offset + records.length));\n      const totalCount = Math.max(records.length, parseInt(payload.result.count, 10) || 0);\n      const hasMore = !!payload.result.has_more;\n\n      records.forEach(record => {\n        modalState.recordByKey[record.key] = record;\n      });\n      modalState.visibleRecords = reset\n        ? records.slice()\n        : modalState.visibleRecords.concat(records);\n      modalState.offset = nextOffset;\n      modalState.totalCount = totalCount;\n      modalState.hasMore = hasMore;\n      applyClientOrdering();\n      renderVisibleRecords();\n    } catch (_) {\n      if (requestToken === modalState.requestToken) {\n        updateStatusText('Unable to load oils catalog.');\n      }\n      throw _;\n    } finally {\n      if (requestToken === modalState.requestToken) {\n        modalState.loading = false;\n        refreshCatalogStatus();\n      }\n    }\n  }\n\n  bulk.api = {\n    fetchCatalogPage,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const bulk = SoapTool.bulkOils = SoapTool.bulkOils || {};\n  const shared = bulk.shared;\n  const render = bulk.render;\n  const api = bulk.api;\n  if (!shared || !render || !api) return;\n\n  const { round, toNumber, clamp } = SoapTool.helpers;\n  const { toGrams, fromGrams } = SoapTool.units;\n  const state = SoapTool.state;\n  const {\n    LOCAL_SORT_KEYS,\n    SCROLL_FETCH_THRESHOLD,\n    SEARCH_DEBOUNCE_MS,\n    queueStateSave,\n    showAlert,\n    getRefs,\n    ensureModalState,\n    updateSelectionCounters,\n    setSelection,\n    removeSelection,\n    getRecordByKey,\n    serializeSelection,\n    restoreState,\n  } = shared;\n  const {\n    applyClientOrdering,\n    sortButtonsLabel,\n    renderVisibleRecords,\n  } = render;\n  const { fetchCatalogPage } = api;\n\n  let modalInstance = null;\n  let searchDebounceTimer = null;\n\n  function closeModal(){\n    const refs = getRefs();\n    if (!refs.modalEl) return;\n    if (!modalInstance && window.bootstrap?.Modal) {\n      modalInstance = window.bootstrap.Modal.getOrCreateInstance(refs.modalEl);\n    }\n    if (modalInstance) modalInstance.hide();\n  }\n\n  function getStageRowsContainer(){\n    return document.getElementById('oilRows');\n  }\n\n  function getStageRows(){\n    return Array.from(document.querySelectorAll('#oilRows .oil-row'));\n  }\n\n  function normalizeName(value){\n    return String(value || '').trim().toLowerCase();\n  }\n\n  function stageRowName(row){\n    return normalizeName(row?.querySelector('.oil-typeahead')?.value);\n  }\n\n  function stageRowGi(row){\n    const raw = String(row?.querySelector('.oil-gi-id')?.value || '').trim();\n    return raw ? raw : '';\n  }\n\n  function stageRowByKey(recordKey, fallbackRecord){\n    const normalizedKey = String(recordKey || '').trim();\n    if (!normalizedKey) return null;\n    const rows = getStageRows();\n    let row = rows.find(entry => String(entry.dataset.bulkOilKey || '') === normalizedKey);\n    if (row) return row;\n    const gi = String(fallbackRecord?.global_item_id || '').trim();\n    if (gi) {\n      row = rows.find(entry => stageRowGi(entry) === gi);\n      if (row) return row;\n    }\n    const name = normalizeName(fallbackRecord?.name);\n    if (name) {\n      row = rows.find(entry => stageRowName(entry) === name);\n      if (row) return row;\n    }\n    return null;\n  }\n\n  function applySelectionToStageRow(row, item){\n    if (!row || !item) return;\n    row.dataset.bulkOilKey = item.key || '';\n    const nameInput = row.querySelector('.oil-typeahead');\n    const sapInput = row.querySelector('.oil-sap-koh');\n    const iodineInput = row.querySelector('.oil-iodine');\n    const fattyInput = row.querySelector('.oil-fatty');\n    const giInput = row.querySelector('.oil-gi-id');\n    const unitInput = row.querySelector('.oil-default-unit');\n    const categoryInput = row.querySelector('.oil-category');\n    const gramsInput = row.querySelector('.oil-grams');\n    const percentInput = row.querySelector('.oil-percent');\n\n    if (nameInput) nameInput.value = item.name || '';\n    if (sapInput) sapInput.value = item.sap_koh > 0 ? round(item.sap_koh, 3) : '';\n    if (iodineInput) iodineInput.value = item.iodine > 0 ? round(item.iodine, 3) : '';\n    if (fattyInput) fattyInput.value = item.fatty_profile && Object.keys(item.fatty_profile).length ? JSON.stringify(item.fatty_profile) : '';\n    if (giInput) giInput.value = item.global_item_id || '';\n    if (unitInput) unitInput.value = item.default_unit || '';\n    if (categoryInput) categoryInput.value = item.ingredient_category_name || '';\n    if (percentInput) percentInput.value = item.selected_pct > 0 ? round(item.selected_pct, 2) : '';\n    if (gramsInput) gramsInput.value = item.selected_weight_g > 0 ? round(fromGrams(item.selected_weight_g), 2) : '';\n  }\n\n  function upsertStageRowForSelection(item){\n    if (!item || !item.key) return null;\n    let row = stageRowByKey(item.key, item);\n    const oilRows = getStageRowsContainer();\n    if (!row && oilRows) {\n      row = SoapTool.oils.buildOilRow();\n      if (row) {\n        oilRows.appendChild(row);\n      }\n    }\n    applySelectionToStageRow(row, item);\n    return row;\n  }\n\n  function removeStageRowForSelection(recordKey, fallbackRecord){\n    const row = stageRowByKey(recordKey, fallbackRecord);\n    if (!row) return;\n    if (state.lastOilEdit && state.lastOilEdit.row === row) {\n      state.lastOilEdit = null;\n      SoapTool.oils.clearSelectedOilProfile();\n    }\n    row.remove();\n  }\n\n  function clearStageRows(){\n    const rows = getStageRows();\n    rows.forEach(row => {\n      if (state.lastOilEdit && state.lastOilEdit.row === row) {\n        state.lastOilEdit = null;\n      }\n      row.remove();\n    });\n    SoapTool.oils.clearSelectedOilProfile();\n  }\n\n  function notifyStageOilChanged(){\n    SoapTool.oils.updateOilTotals();\n    SoapTool.stages.updateStageStatuses();\n    SoapTool.storage.queueStateSave();\n    SoapTool.storage.queueAutoCalc();\n  }\n\n  function normalizeSelectionKey(rawName, rawGi, rawKey){\n    const explicit = String(rawKey || '').trim();\n    if (explicit) return explicit;\n    const gi = String(rawGi || '').trim();\n    if (gi) return `global:${gi}`;\n    const name = normalizeName(rawName);\n    if (name) return `soapcalc:${name}`;\n    return '';\n  }\n\n  function buildSelectionFromStage(){\n    const selection = {};\n    getStageRows().forEach(row => {\n      const name = String(row.querySelector('.oil-typeahead')?.value || '').trim();\n      const sap = toNumber(row.querySelector('.oil-sap-koh')?.value);\n      const iodine = toNumber(row.querySelector('.oil-iodine')?.value);\n      const giRaw = String(row.querySelector('.oil-gi-id')?.value || '').trim();\n      const unit = String(row.querySelector('.oil-default-unit')?.value || 'gram');\n      const categoryName = String(row.querySelector('.oil-category')?.value || '');\n      const selectedPct = clamp(toNumber(row.querySelector('.oil-percent')?.value), 0, 100);\n      const selectedWeightG = clamp(toGrams(row.querySelector('.oil-grams')?.value), 0);\n      const fattyRaw = String(row.querySelector('.oil-fatty')?.value || '');\n      let fattyProfile = {};\n      if (fattyRaw) {\n        try {\n          const parsed = JSON.parse(fattyRaw);\n          fattyProfile = shared.normalizeFattyProfile(parsed);\n        } catch (_) {\n          fattyProfile = {};\n        }\n      }\n      const key = normalizeSelectionKey(name, giRaw, row.dataset.bulkOilKey);\n      if (!key) return;\n      const hasMaterial = name || selectedPct > 0 || selectedWeightG > 0 || sap > 0 || iodine > 0 || Object.keys(fattyProfile).length > 0;\n      if (!hasMaterial) return;\n      row.dataset.bulkOilKey = key;\n      selection[key] = {\n        key,\n        name: name || 'Unnamed oil',\n        sap_koh: sap,\n        iodine,\n        fatty_profile: fattyProfile,\n        default_unit: unit || 'gram',\n        ingredient_category_name: categoryName,\n        global_item_id: giRaw ? parseInt(giRaw, 10) : null,\n        source: giRaw ? 'global' : 'soapcalc',\n        is_basic: !giRaw,\n        selected_pct: selectedPct,\n        selected_weight_g: selectedWeightG,\n      };\n    });\n    return selection;\n  }\n\n  function hydrateSelectionFromStage(){\n    const modalState = ensureModalState();\n    modalState.selection = buildSelectionFromStage();\n    updateSelectionCounters();\n  }\n\n  function syncAllSelectionsToStage(){\n    const modalState = ensureModalState();\n    const selectedItems = Object.values(modalState.selection || {});\n    const expectedKeys = new Set(selectedItems.map(item => item.key));\n    getStageRows().forEach(row => {\n      const key = String(row.dataset.bulkOilKey || '').trim();\n      if (!key || !expectedKeys.has(key)) {\n        row.remove();\n      }\n    });\n    selectedItems\n      .slice()\n      .sort((left, right) => String(left.name || '').localeCompare(String(right.name || '')))\n      .forEach(item => {\n        upsertStageRowForSelection(item);\n      });\n    notifyStageOilChanged();\n  }\n\n  async function openModal(){\n    const refs = getRefs();\n    const modalState = ensureModalState();\n    if (!refs.modalEl) return;\n    hydrateSelectionFromStage();\n    if (!modalInstance && window.bootstrap?.Modal) {\n      modalInstance = window.bootstrap.Modal.getOrCreateInstance(refs.modalEl);\n    }\n    if (refs.searchInput) refs.searchInput.value = modalState.query || '';\n    if (refs.modeToggle) refs.modeToggle.checked = modalState.mode === 'all';\n    if (refs.viewSelectedToggle) refs.viewSelectedToggle.checked = !!modalState.viewSelected;\n    if (refs.unitLabelEl) refs.unitLabelEl.textContent = state.currentUnit || 'g';\n    if (modalInstance) modalInstance.show();\n    sortButtonsLabel();\n    updateSelectionCounters();\n    try {\n      await fetchCatalogPage({ reset: true });\n    } catch (_) {\n      showAlert('danger', 'Unable to load bulk oils catalog right now.');\n    }\n  }\n\n  function handleBodyInput(event){\n    const target = event.target;\n    if (!(target instanceof HTMLElement)) return;\n    const row = target.closest('tr[data-record-key]');\n    if (!row) return;\n    const recordKey = row.dataset.recordKey || '';\n    const record = getRecordByKey(recordKey);\n    if (!record) return;\n\n    const checkbox = row.querySelector('.bulk-oil-check');\n    const pctInput = row.querySelector('.bulk-oil-pct');\n    const weightInput = row.querySelector('.bulk-oil-weight');\n    const pct = clamp(toNumber(pctInput?.value), 0, 100);\n    const selectedWeightG = clamp(toGrams(weightInput?.value), 0);\n    const hasValues = pct > 0 || selectedWeightG > 0;\n    const isChecked = !!checkbox?.checked;\n\n    if (isChecked || hasValues) {\n      if (checkbox) checkbox.checked = true;\n      const selected = setSelection(record, {\n        selected_pct: pct,\n        selected_weight_g: selectedWeightG,\n      });\n      upsertStageRowForSelection(selected);\n    } else {\n      removeSelection(recordKey);\n      removeStageRowForSelection(recordKey, record);\n    }\n\n    const modalState = ensureModalState();\n    const shouldReorder = LOCAL_SORT_KEYS.has(modalState.sortKey) || modalState.viewSelected;\n    if (shouldReorder) {\n      applyClientOrdering();\n      renderVisibleRecords();\n    } else {\n      updateSelectionCounters();\n    }\n    notifyStageOilChanged();\n    queueStateSave();\n  }\n\n  async function handleModeToggle(checked){\n    const modalState = ensureModalState();\n    modalState.mode = checked ? 'all' : 'basics';\n    queueStateSave();\n    try {\n      await fetchCatalogPage({ reset: true });\n    } catch (_) {\n      showAlert('danger', 'Unable to load bulk oils catalog right now.');\n    }\n  }\n\n  function handleViewSelectedToggle(checked){\n    const modalState = ensureModalState();\n    modalState.viewSelected = !!checked;\n    applyClientOrdering();\n    renderVisibleRecords();\n    queueStateSave();\n  }\n\n  async function handleSortClick(event){\n    const button = event.target instanceof HTMLElement ? event.target.closest('.bulk-oil-sort') : null;\n    if (!button) return;\n    const sortKey = button.getAttribute('data-sort-key') || 'name';\n    const modalState = ensureModalState();\n    if (modalState.sortKey === sortKey) {\n      modalState.sortDir = modalState.sortDir === 'asc' ? 'desc' : 'asc';\n    } else {\n      modalState.sortKey = sortKey;\n      modalState.sortDir = sortKey === 'name' ? 'asc' : 'desc';\n    }\n    queueStateSave();\n    if (LOCAL_SORT_KEYS.has(modalState.sortKey)) {\n      applyClientOrdering();\n      renderVisibleRecords();\n      return;\n    }\n    try {\n      await fetchCatalogPage({ reset: true });\n    } catch (_) {\n      showAlert('danger', 'Unable to load oils in that sort order.');\n    }\n  }\n\n  function clearSelection(){\n    const modalState = ensureModalState();\n    modalState.selection = {};\n    clearStageRows();\n    if (LOCAL_SORT_KEYS.has(modalState.sortKey) || modalState.viewSelected) {\n      applyClientOrdering();\n    }\n    renderVisibleRecords();\n    notifyStageOilChanged();\n    queueStateSave();\n  }\n\n  async function handleScroll(){\n    const refs = getRefs();\n    const modalState = ensureModalState();\n    if (!refs.scrollEl) return;\n    if (modalState.loading || !modalState.hasMore) return;\n    const isNearBottom = refs.scrollEl.scrollTop + refs.scrollEl.clientHeight >= refs.scrollEl.scrollHeight - SCROLL_FETCH_THRESHOLD;\n    if (!isNearBottom) return;\n    try {\n      await fetchCatalogPage({ reset: false });\n    } catch (_) {\n      showAlert('danger', 'Unable to load more oils right now.');\n    }\n  }\n\n  function scheduleSearchReload(){\n    if (searchDebounceTimer) window.clearTimeout(searchDebounceTimer);\n    searchDebounceTimer = window.setTimeout(async () => {\n      try {\n        await fetchCatalogPage({ reset: true });\n      } catch (_) {\n        showAlert('danger', 'Unable to search oils right now.');\n      }\n    }, SEARCH_DEBOUNCE_MS);\n  }\n\n  function saveAndClose(){\n    syncAllSelectionsToStage();\n    queueStateSave();\n    closeModal();\n  }\n\n  function onUnitChanged(){\n    const refs = getRefs();\n    if (refs.unitLabelEl) refs.unitLabelEl.textContent = state.currentUnit || 'g';\n    if (refs.modalEl?.classList.contains('show')) {\n      renderVisibleRecords();\n    }\n  }\n\n  function bindEvents(){\n    const refs = getRefs();\n    if (!refs.modalEl) return;\n    if (refs.openBtn) {\n      refs.openBtn.addEventListener('click', () => {\n        openModal();\n      });\n    }\n    if (refs.searchInput) {\n      refs.searchInput.addEventListener('input', () => {\n        const modalState = ensureModalState();\n        modalState.query = refs.searchInput.value || '';\n        queueStateSave();\n        scheduleSearchReload();\n      });\n    }\n    if (refs.modeToggle) {\n      refs.modeToggle.addEventListener('change', async () => {\n        await handleModeToggle(!!refs.modeToggle.checked);\n      });\n    }\n    if (refs.viewSelectedToggle) {\n      refs.viewSelectedToggle.addEventListener('change', () => {\n        handleViewSelectedToggle(!!refs.viewSelectedToggle.checked);\n      });\n    }\n    if (refs.scrollEl) {\n      refs.scrollEl.addEventListener('scroll', handleScroll);\n    }\n    if (refs.bodyEl) {\n      refs.bodyEl.addEventListener('input', handleBodyInput);\n      refs.bodyEl.addEventListener('change', handleBodyInput);\n    }\n    refs.modalEl.querySelectorAll('.bulk-oil-sort').forEach(button => {\n      button.addEventListener('click', handleSortClick);\n    });\n    if (refs.importBtn) {\n      refs.importBtn.addEventListener('click', () => {\n        saveAndClose();\n      });\n    }\n    if (refs.clearBtn) {\n      refs.clearBtn.addEventListener('click', () => {\n        clearSelection();\n      });\n    }\n    refs.modalEl.addEventListener('shown.bs.modal', () => {\n      const localRefs = getRefs();\n      if (localRefs.searchInput) localRefs.searchInput.focus();\n    });\n  }\n\n  bindEvents();\n  updateSelectionCounters();\n  sortButtonsLabel();\n\n  SoapTool.bulkOilsModal = {\n    openModal,\n    serializeSelection,\n    restoreState,\n    onUnitChanged,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { toNumber, round, clamp, buildSoapcalcSearchBuilder } = SoapTool.helpers;\n  const { formatWeight, toGrams, fromGrams } = SoapTool.units;\n  const { FRAGRANCE_CATEGORY_SET } = SoapTool.constants;\n  const state = SoapTool.state;\n\n  function attachAdditiveTypeahead(inputId, hiddenId, categorySet, unitId, categoryId){\n    const input = document.getElementById(inputId);\n    const hidden = document.getElementById(hiddenId);\n    const hiddenUnit = unitId ? document.getElementById(unitId) : null;\n    const hiddenCategory = categoryId ? document.getElementById(categoryId) : null;\n    const list = input?.parentElement?.querySelector('[data-role=\"suggestions\"]');\n    if (!input || !list || typeof window.attachMergedInventoryGlobalTypeahead !== 'function') return;\n    const builder = buildSoapcalcSearchBuilder();\n    window.attachMergedInventoryGlobalTypeahead({\n      inputEl: input,\n      listEl: list,\n      mode: 'public',\n      giHiddenEl: hidden,\n      includeInventory: false,\n      includeGlobal: true,\n      ingredientFirst: false,\n      globalUrlBuilder: builder,\n      searchType: 'ingredient',\n      resultFilter: (item, source) => {\n        const category = getItemCategoryName(item);\n        if (!category) return source === 'inventory';\n        return categorySet.has(category);\n      },\n      requireHidden: false,\n      onSelection: function(picked){\n        if (hiddenUnit) hiddenUnit.value = picked?.default_unit || '';\n        if (hiddenCategory) hiddenCategory.value = picked?.ingredient_category_name || '';\n        SoapTool.storage.queueStateSave();\n      }\n    });\n    input.addEventListener('input', function(){\n      if (!this.value.trim()) {\n        if (hiddenUnit) hiddenUnit.value = '';\n        if (hiddenCategory) hiddenCategory.value = '';\n      }\n    });\n  }\n\n  function readAdditivePct({ pctId, weightId }){\n    const pctInput = document.getElementById(pctId);\n    const pctRaw = pctInput?.value;\n    if (pctRaw !== '' && pctRaw !== null && pctRaw !== undefined) {\n      return toNumber(pctRaw);\n    }\n    const totalOils = clamp(SoapTool.oils?.getTotalOilsGrams?.() || 0, 0);\n    if (totalOils <= 0) return 0;\n    const weightGrams = toGrams(document.getElementById(weightId)?.value);\n    if (weightGrams <= 0) return 0;\n    return (weightGrams / totalOils) * 100;\n  }\n\n  function collectAdditiveSettings(){\n    return {\n      lactatePct: readAdditivePct({ pctId: 'additiveLactatePct', weightId: 'additiveLactateWeight' }),\n      sugarPct: readAdditivePct({ pctId: 'additiveSugarPct', weightId: 'additiveSugarWeight' }),\n      saltPct: readAdditivePct({ pctId: 'additiveSaltPct', weightId: 'additiveSaltWeight' }),\n      citricPct: readAdditivePct({ pctId: 'additiveCitricPct', weightId: 'additiveCitricWeight' }),\n      lactateName: document.getElementById('additiveLactateName')?.value?.trim() || 'Sodium Lactate',\n      sugarName: document.getElementById('additiveSugarName')?.value?.trim() || 'Sugar',\n      saltName: document.getElementById('additiveSaltName')?.value?.trim() || 'Salt',\n      citricName: document.getElementById('additiveCitricName')?.value?.trim() || 'Citric Acid',\n    };\n  }\n\n  function applyComputedOutputs(outputs){\n    const setOutput = (id, value) => {\n      const el = document.getElementById(id);\n      if (!el) return;\n      if (el.tagName === 'INPUT') {\n        el.value = value;\n      } else {\n        el.textContent = value;\n      }\n    };\n    const toDisplay = (grams) => (grams > 0 ? round(fromGrams(grams), 2) : '');\n    setOutput('additiveLactateWeight', toDisplay(toNumber(outputs?.lactateG)));\n    setOutput('additiveSugarWeight', toDisplay(toNumber(outputs?.sugarG)));\n    setOutput('additiveSaltWeight', toDisplay(toNumber(outputs?.saltG)));\n    setOutput('additiveCitricWeight', toDisplay(toNumber(outputs?.citricG)));\n    setOutput('additiveCitricLyeOut', formatWeight(toNumber(outputs?.citricLyeG)));\n  }\n\n  function updateAdditivesOutput(totalOils){\n    const expectedOils = clamp(toNumber(totalOils), 0);\n    const calc = SoapTool.state?.lastCalc;\n    const calcOils = clamp(toNumber(calc?.totalOils), 0);\n    const oilsMatch = Math.abs(calcOils - expectedOils) < 0.01;\n    const outputs = (calc?.additives && oilsMatch)\n      ? calc.additives\n      : { lactateG: 0, sugarG: 0, saltG: 0, citricG: 0, citricLyeG: 0 };\n    applyComputedOutputs(outputs);\n    return outputs;\n  }\n\n  function attachFragranceTypeahead(row){\n    const input = row.querySelector('.fragrance-typeahead');\n    const hidden = row.querySelector('.fragrance-gi-id');\n    const hiddenUnit = row.querySelector('.fragrance-default-unit');\n    const hiddenCategory = row.querySelector('.fragrance-category');\n    const list = row.querySelector('[data-role=\"suggestions\"]');\n    if (!input || !list || typeof window.attachMergedInventoryGlobalTypeahead !== 'function') return;\n    const builder = buildSoapcalcSearchBuilder();\n    window.attachMergedInventoryGlobalTypeahead({\n      inputEl: input,\n      listEl: list,\n      mode: 'public',\n      giHiddenEl: hidden,\n      includeInventory: false,\n      includeGlobal: true,\n      ingredientFirst: false,\n      globalUrlBuilder: builder,\n      searchType: 'ingredient',\n      resultFilter: (item, source) => {\n        const category = getItemCategoryName(item);\n        if (!category) return source === 'inventory';\n        return FRAGRANCE_CATEGORY_SET.has(category);\n      },\n      requireHidden: false,\n      onSelection: function(picked){\n        if (hiddenUnit) hiddenUnit.value = picked?.default_unit || '';\n        if (hiddenCategory) hiddenCategory.value = picked?.ingredient_category_name || '';\n        SoapTool.storage.queueStateSave();\n      }\n    });\n    input.addEventListener('input', function(){\n      if (!this.value.trim()) {\n        if (hiddenUnit) hiddenUnit.value = '';\n        if (hiddenCategory) hiddenCategory.value = '';\n      }\n    });\n  }\n\n  function buildFragranceRow(){\n    const template = document.getElementById('fragranceRowTemplate');\n    const row = template?.content?.querySelector('.fragrance-row')?.cloneNode(true);\n    if (!row) return document.createElement('div');\n    row.querySelectorAll('input').forEach(input => {\n      input.value = '';\n    });\n    attachFragranceTypeahead(row);\n    row.querySelectorAll('.unit-suffix').forEach(el => {\n      el.dataset.suffix = state.currentUnit;\n    });\n    return row;\n  }\n\n  function updateFragranceTotals(totalOils){\n    const rows = Array.from(document.querySelectorAll('#fragranceRows .fragrance-row'));\n    const target = clamp(totalOils || SoapTool.oils.getTotalOilsGrams() || 0, 0);\n    let totalGrams = 0;\n    let totalPct = 0;\n    rows.forEach(row => {\n      const gramsInput = row.querySelector('.fragrance-grams');\n      const pctInput = row.querySelector('.fragrance-percent');\n      const grams = toGrams(gramsInput?.value);\n      const pct = clamp(toNumber(pctInput?.value), 0);\n      let effectiveGrams = grams;\n      let effectivePct = pct;\n      if (target > 0) {\n        if (effectiveGrams <= 0 && effectivePct > 0) {\n          effectiveGrams = target * (effectivePct / 100);\n        } else if (effectivePct <= 0 && effectiveGrams > 0) {\n          effectivePct = (effectiveGrams / target) * 100;\n        }\n      }\n      if (effectiveGrams > 0) totalGrams += effectiveGrams;\n      totalPct += effectivePct;\n    });\n    const totalPctEl = document.getElementById('fragrancePercentTotal');\n    if (totalPctEl) totalPctEl.textContent = round(totalPct, 2);\n    const totalWeightEl = document.getElementById('fragranceTotalComputed');\n    if (totalWeightEl) totalWeightEl.textContent = totalGrams > 0 ? formatWeight(totalGrams) : '--';\n    return { totalGrams, totalPct };\n  }\n\n  function collectFragranceData(){\n    const rows = [];\n    document.querySelectorAll('#fragranceRows .fragrance-row').forEach(row => {\n      const name = row.querySelector('.fragrance-typeahead')?.value?.trim() || '';\n      const grams = row.querySelector('.fragrance-grams')?.value || '';\n      const percent = row.querySelector('.fragrance-percent')?.value || '';\n      const gi = row.querySelector('.fragrance-gi-id')?.value || '';\n      const defaultUnit = row.querySelector('.fragrance-default-unit')?.value || '';\n      const categoryName = row.querySelector('.fragrance-category')?.value || '';\n      if (!name && !grams && !percent && !gi) return;\n      rows.push({\n        name,\n        grams,\n        percent,\n        gi,\n        defaultUnit,\n        categoryName,\n      });\n    });\n    return rows;\n  }\n\n  function updateVisualGuidance(data){\n    const list = document.getElementById('soapVisualGuidanceList');\n    if (!list) return;\n    const tips = Array.isArray(data?.tips) && data.tips.length\n      ? data.tips\n      : ['No visual flags detected for this formula.'];\n    list.innerHTML = tips.map(tip => `<li>${tip}</li>`).join('');\n  }\n\n  function getItemCategoryName(item){\n    if (!item || typeof item !== 'object') return null;\n    return (item.ingredient && item.ingredient.ingredient_category_name)\n      || item.ingredient_category_name\n      || (item.ingredient_category && item.ingredient_category.name)\n      || null;\n  }\n\n  SoapTool.additives = {\n    attachAdditiveTypeahead,\n    collectAdditiveSettings,\n    applyComputedOutputs,\n    updateAdditivesOutput,\n    updateVisualGuidance,\n  };\n  SoapTool.fragrances = {\n    buildFragranceRow,\n    updateFragranceTotals,\n    collectFragranceData,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { toNumber } = SoapTool.helpers;\n  const { STAGE_CONFIGS } = SoapTool.constants;\n\n  function openStageByIndex(index){\n    const stage = STAGE_CONFIGS[index];\n    if (!stage) return;\n    const tabButton = document.getElementById(stage.tabId);\n    if (!tabButton) return;\n    if (window.bootstrap?.Tab) {\n      bootstrap.Tab.getOrCreateInstance(tabButton).show();\n    } else {\n      document.querySelectorAll('#soapStageTabList .nav-link').forEach(btn => {\n        btn.classList.remove('active');\n        btn.setAttribute('aria-selected', 'false');\n      });\n      document.querySelectorAll('#soapStageTabContent .tab-pane').forEach(pane => {\n        pane.classList.remove('show', 'active');\n      });\n      tabButton.classList.add('active');\n      tabButton.setAttribute('aria-selected', 'true');\n      const pane = document.getElementById(stage.paneId);\n      if (pane) pane.classList.add('show', 'active');\n    }\n    SoapTool.layout.scheduleStageHeightSync();\n    tabButton.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });\n  }\n\n  function resetStage(stageId){\n    if (stageId === 1) {\n      const unitGrams = document.getElementById('unitGrams');\n      if (unitGrams) unitGrams.checked = true;\n      SoapTool.units.setUnit('g', { skipAutoCalc: true });\n      document.getElementById('moldWaterWeight').value = '';\n      document.getElementById('moldOilPct').value = '65';\n      document.getElementById('oilTotalTarget').value = '';\n      document.getElementById('moldShape').value = 'loaf';\n      const correction = document.getElementById('moldCylinderCorrection');\n      if (correction) correction.checked = false;\n      document.getElementById('moldCylinderFactor').value = '0.85';\n      SoapTool.mold.updateMoldShapeUI();\n      if (SoapTool.mold?.updateWetBatterWarning) {\n        SoapTool.mold.updateWetBatterWarning(0);\n      }\n    }\n    if (stageId === 2) {\n      const oilRows = document.getElementById('oilRows');\n      if (oilRows) {\n        oilRows.innerHTML = '';\n        oilRows.appendChild(SoapTool.oils.buildOilRow());\n      }\n      SoapTool.oils.updateOilTotals();\n    }\n    if (stageId === 3) {\n      const lyeNaoh = document.getElementById('lyeTypeNaoh');\n      if (lyeNaoh) lyeNaoh.checked = true;\n      const waterMethod = document.getElementById('waterMethod');\n      if (waterMethod) waterMethod.value = 'percent';\n      const superfat = document.getElementById('lyeSuperfat');\n      if (superfat) superfat.value = '5';\n      const purity = document.getElementById('lyePurity');\n      if (purity) purity.value = '100';\n      const waterPct = document.getElementById('waterPct');\n      if (waterPct) waterPct.value = '33';\n      const lyeConcentration = document.getElementById('lyeConcentration');\n      if (lyeConcentration) lyeConcentration.value = '33';\n      const waterRatio = document.getElementById('waterRatio');\n      if (waterRatio) waterRatio.value = '2';\n      SoapTool.runner.applyLyeSelection();\n      SoapTool.runner.setWaterMethod();\n      SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n    }\n    if (stageId === 4) {\n      document.getElementById('additiveLactatePct').value = '1';\n      document.getElementById('additiveSugarPct').value = '1';\n      document.getElementById('additiveSaltPct').value = '0.5';\n      document.getElementById('additiveCitricPct').value = '0';\n      ['additiveLactateName', 'additiveSugarName', 'additiveSaltName', 'additiveCitricName']\n        .forEach(id => { const el = document.getElementById(id); if (el) el.value = ''; });\n      ['additiveLactateGi', 'additiveSugarGi', 'additiveSaltGi', 'additiveCitricGi']\n        .forEach(id => { const el = document.getElementById(id); if (el) el.value = ''; });\n      SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n    }\n    if (stageId === 5) {\n      const fragranceRows = document.getElementById('fragranceRows');\n      if (fragranceRows) {\n        fragranceRows.innerHTML = '';\n        if (SoapTool.fragrances?.buildFragranceRow) {\n          fragranceRows.appendChild(SoapTool.fragrances.buildFragranceRow());\n        }\n      }\n      const totalPct = document.getElementById('fragrancePercentTotal');\n      if (totalPct) totalPct.textContent = '0';\n      const totalWeight = document.getElementById('fragranceTotalComputed');\n      if (totalWeight) totalWeight.textContent = '--';\n    }\n    SoapTool.storage.queueStateSave();\n    SoapTool.storage.queueAutoCalc();\n    updateStageStatuses();\n  }\n\n  function getStageCompletion(stageId){\n    if (stageId === 1) {\n      const moldWeight = toNumber(document.getElementById('moldWaterWeight').value);\n      const oilTarget = toNumber(document.getElementById('oilTotalTarget').value);\n      const moldPct = toNumber(document.getElementById('moldOilPct').value);\n      const hasUnit = !!document.querySelector('input[name=\"weight_unit\"]:checked');\n      const complete = hasUnit && (moldWeight > 0 || oilTarget > 0) && moldPct > 0;\n      return { state: complete ? 'complete' : 'incomplete', label: complete ? 'Sized' : 'Needs target' };\n    }\n    if (stageId === 2) {\n      const rows = Array.from(document.querySelectorAll('#oilRows .oil-row'));\n      const hasOil = rows.some(row => {\n        const name = row.querySelector('.oil-typeahead')?.value?.trim();\n        const grams = toNumber(row.querySelector('.oil-grams')?.value);\n        const pct = toNumber(row.querySelector('.oil-percent')?.value);\n        return name && (grams > 0 || pct > 0);\n      });\n      return { state: hasOil ? 'complete' : 'incomplete', label: hasOil ? 'Oils added' : 'Add oils' };\n    }\n    if (stageId === 3) {\n      const superfat = toNumber(document.getElementById('lyeSuperfat').value);\n      const method = document.getElementById('waterMethod')?.value;\n      const hasLye = !!document.querySelector('input[name=\"lye_type\"]:checked');\n      const complete = hasLye && !!method && superfat >= 0;\n      return { state: complete ? 'complete' : 'incomplete', label: complete ? 'Configured' : 'Set lye' };\n    }\n    if (stageId === 4) {\n      const hasAdditive = ['additiveLactatePct', 'additiveSugarPct', 'additiveSaltPct', 'additiveCitricPct']\n        .some(id => toNumber(document.getElementById(id).value) > 0);\n      return { state: 'optional', label: hasAdditive ? 'Added' : 'Optional' };\n    }\n    if (stageId === 5) {\n      const rows = Array.from(document.querySelectorAll('#fragranceRows .fragrance-row'));\n      const hasFragrance = rows.some(row => {\n        const name = row.querySelector('.fragrance-typeahead')?.value?.trim();\n        const grams = toNumber(row.querySelector('.fragrance-grams')?.value);\n        const pct = toNumber(row.querySelector('.fragrance-percent')?.value);\n        return name || grams > 0 || pct > 0;\n      });\n      return { state: 'optional', label: hasFragrance ? 'Added' : 'Optional' };\n    }\n    return { state: 'incomplete', label: 'Incomplete' };\n  }\n\n  function updateStageStatuses(){\n    const tabList = document.getElementById('soapStageTabList');\n    if (tabList) {\n      tabList.querySelectorAll('.soap-stage-status').forEach(el => el.remove());\n    }\n    const progress = document.getElementById('soapStageProgress');\n    if (progress) progress.textContent = '';\n  }\n\n  SoapTool.stages = {\n    openStageByIndex,\n    resetStage,\n    updateStageStatuses,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { round, toNumber, clamp } = SoapTool.helpers;\n  const { computeFattyAcids, computeQualities, computeOilQualityScores } = SoapTool.calc;\n  const {\n    QUALITY_RANGES,\n    QUALITY_HINTS,\n    QUALITY_FEEL_HINTS,\n    IODINE_RANGE,\n    IODINE_SCALE_MAX,\n    INS_RANGE,\n    INS_SCALE_MAX,\n    QUALITY_BASE,\n    QUALITY_PRESETS,\n    FATTY_BAR_COLORS,\n    FATTY_DISPLAY_KEYS,\n  } = SoapTool.constants;\n\n  const { pulseValue, showSoapAlert } = SoapTool.ui;\n\n  function setBarFill({ barId, fillId, value, max, label }){\n    const bar = document.getElementById(barId);\n    const fill = document.getElementById(fillId);\n    if (!bar || !fill) return null;\n    const safeValue = isFinite(value) ? value : 0;\n    const clamped = Math.max(0, Math.min(max, safeValue));\n    const width = max > 0 ? (clamped / max) * 100 : 0;\n    fill.style.width = `${width}%`;\n    bar.setAttribute('aria-valuemin', '0');\n    bar.setAttribute('aria-valuemax', String(max));\n    bar.setAttribute('aria-valuenow', clamped.toFixed(1));\n    if (label) {\n      bar.setAttribute('aria-label', label);\n    }\n    return { bar, fill, value: safeValue };\n  }\n\n  function setQualityBarColor(fill, value, range){\n    if (!fill || !range) return;\n    fill.classList.remove('bg-success', 'bg-warning', 'bg-danger', 'bg-secondary');\n    if (!isFinite(value)) {\n      fill.classList.add('bg-secondary');\n      return;\n    }\n    if (value < range[0]) {\n      fill.classList.add('bg-warning');\n    } else if (value > range[1]) {\n      fill.classList.add('bg-danger');\n    } else {\n      fill.classList.add('bg-success');\n    }\n  }\n\n  function setScaledBar(barId, fillId, value, range, max, label){\n    const result = setBarFill({ barId, fillId, value, max, label });\n    if (!result) return;\n    setQualityBarColor(result.fill, value, range);\n  }\n\n  function setQualityRangeBars(){\n    const rangeConfig = {\n      hardness: { range: QUALITY_RANGES.hardness, scale: 100 },\n      cleansing: { range: QUALITY_RANGES.cleansing, scale: 100 },\n      conditioning: { range: QUALITY_RANGES.conditioning, scale: 100 },\n      bubbly: { range: QUALITY_RANGES.bubbly, scale: 100 },\n      creamy: { range: QUALITY_RANGES.creamy, scale: 100 },\n      iodine: { range: IODINE_RANGE, scale: IODINE_SCALE_MAX },\n      ins: { range: INS_RANGE, scale: INS_SCALE_MAX },\n    };\n    Object.entries(rangeConfig).forEach(([key, config]) => {\n      const [min, max] = config.range;\n      const scale = config.scale;\n      const name = key.charAt(0).toUpperCase() + key.slice(1);\n      const barId = key === 'iodine' ? 'iodineBar' : (key === 'ins' ? 'insBar' : `quality${name}Bar`);\n      const safe = document.getElementById(`quality${name}Safe`);\n      if (safe) {\n        const startPct = Math.max(0, Math.min(100, (min / scale) * 100));\n        const widthPct = Math.max(0, Math.min(100, ((max - min) / scale) * 100));\n        safe.style.left = `${startPct}%`;\n        safe.style.width = `${widthPct}%`;\n        safe.title = `Safe range ${round(min, 0)}-${round(max, 0)}`;\n      }\n      const bar = document.getElementById(barId);\n      if (bar) {\n        bar.dataset.safeRange = `${round(min, 0)}-${round(max, 0)}`;\n      }\n      const minLabel = document.getElementById(`quality${name}RangeMin`);\n      const maxLabel = document.getElementById(`quality${name}RangeMax`);\n      if (minLabel) minLabel.textContent = round(min, 0);\n      if (maxLabel) maxLabel.textContent = round(max, 0);\n    });\n  }\n\n  function updateQualitySliders(qualities, superfat){\n    const hardness = clamp(qualities.hardness || 0, 0, 100);\n    const bubbly = clamp(qualities.bubbly || 0, 0, 100);\n    const conditioning = clamp(qualities.conditioning || 0, 0, 100);\n    const greasyScore = clamp(conditioning + (superfat || 0) * 3, 0, 100);\n    const hardEl = document.getElementById('feelHardness');\n    const bubblyEl = document.getElementById('feelBubbly');\n    const conditioningEl = document.getElementById('feelConditioning');\n    const greasyEl = document.getElementById('feelGreasy');\n    if (hardEl) hardEl.value = round(hardness, 1);\n    if (bubblyEl) bubblyEl.value = round(bubbly, 1);\n    if (conditioningEl) conditioningEl.value = round(conditioning, 1);\n    if (greasyEl) greasyEl.value = round(greasyScore, 1);\n  }\n\n  function updateFattyBar(fattyPercent){\n    FATTY_DISPLAY_KEYS.forEach(key => {\n      const el = document.getElementById(`fattyBar${key.charAt(0).toUpperCase()}${key.slice(1)}`);\n      if (!el) return;\n      const value = clamp(toNumber(fattyPercent[key]), 0, 100);\n      const width = value;\n      el.style.width = `${width}%`;\n      el.style.backgroundColor = FATTY_BAR_COLORS[key] || 'var(--color-muted)';\n      el.title = `${key.charAt(0).toUpperCase()}${key.slice(1)}: ${round(value, 1)}%`;\n    });\n  }\n\n  function getQualityTargets(){\n    const preset = document.getElementById('qualityPreset')?.value || 'balanced';\n    const focusEls = Array.from(document.querySelectorAll('.quality-focus:checked'));\n    if (preset === 'none' && !focusEls.length) return null;\n    const base = preset === 'none'\n      ? { ...QUALITY_BASE }\n      : (QUALITY_PRESETS[preset] ? { ...QUALITY_PRESETS[preset] } : { ...QUALITY_BASE });\n    focusEls.forEach(el => {\n      const attr = el.dataset.attr;\n      const direction = el.dataset.direction;\n      const range = QUALITY_RANGES[attr];\n      if (!range) return;\n      base[attr] = direction === 'low' ? range[0] : range[1];\n    });\n    return base;\n  }\n\n  function updateQualityTargets(){\n    const targets = getQualityTargets();\n    const markers = {\n      hardness: document.getElementById('qualityHardnessTarget'),\n      cleansing: document.getElementById('qualityCleansingTarget'),\n      conditioning: document.getElementById('qualityConditioningTarget'),\n      bubbly: document.getElementById('qualityBubblyTarget'),\n      creamy: document.getElementById('qualityCreamyTarget'),\n      iodine: document.getElementById('iodineTarget'),\n      ins: document.getElementById('insTarget'),\n    };\n    Object.entries(markers).forEach(([key, marker]) => {\n      if (!marker) return;\n      const labelEl = document.getElementById(`${marker.id}Label`);\n      if (!targets) {\n        marker.classList.add('d-none');\n        if (labelEl) labelEl.textContent = '';\n        return;\n      }\n      const value = toNumber(targets[key]);\n      if (!isFinite(value)) {\n        marker.classList.add('d-none');\n        if (labelEl) labelEl.textContent = '';\n        return;\n      }\n      const scaleMax = key === 'iodine' ? IODINE_SCALE_MAX : (key === 'ins' ? INS_SCALE_MAX : 100);\n      const clamped = clamp(value, 0, scaleMax);\n      marker.classList.remove('d-none');\n      marker.style.left = `${(clamped / scaleMax) * 100}%`;\n      marker.setAttribute('aria-label', `Apply ${key} target`);\n      marker.setAttribute('role', 'button');\n      marker.setAttribute('tabindex', '0');\n      marker.title = `Target ${key}: ${round(value, 1)}`;\n      if (labelEl) {\n        labelEl.textContent = round(value, 1);\n      }\n    });\n  }\n\n  function applyQualityTargets(){\n    const targets = getQualityTargets();\n    if (!targets) {\n      showSoapAlert('info', 'Select a quality target to nudge the blend.', { dismissible: true, timeoutMs: 5000 });\n      return;\n    }\n    const rows = Array.from(document.querySelectorAll('#oilRows .oil-row'));\n    const oils = rows.map(row => {\n      const grams = SoapTool.units.toGrams(row.querySelector('.oil-grams')?.value);\n      const fattyRaw = row.querySelector('.oil-fatty')?.value || '';\n      let fattyProfile = null;\n      if (fattyRaw) {\n        try {\n          fattyProfile = JSON.parse(fattyRaw);\n        } catch (_) {\n          fattyProfile = null;\n        }\n      }\n      return { row, grams, fattyProfile };\n    }).filter(item => item.grams > 0);\n\n    if (!oils.length) {\n      showSoapAlert('warning', 'Add oils before nudging toward a target.', { dismissible: true, timeoutMs: 5000 });\n      return;\n    }\n\n    const fatty = computeFattyAcids(oils.map(oil => ({\n      grams: oil.grams,\n      fattyProfile: oil.fattyProfile,\n    })));\n    const currentQualities = computeQualities(fatty.percent);\n    const deltas = {\n      hardness: clamp((targets.hardness - currentQualities.hardness) / 100, -1, 1),\n      cleansing: clamp((targets.cleansing - currentQualities.cleansing) / 100, -1, 1),\n      conditioning: clamp((targets.conditioning - currentQualities.conditioning) / 100, -1, 1),\n      bubbly: clamp((targets.bubbly - currentQualities.bubbly) / 100, -1, 1),\n      creamy: clamp((targets.creamy - currentQualities.creamy) / 100, -1, 1),\n    };\n\n    const totalOils = oils.reduce((sum, oil) => sum + oil.grams, 0);\n    const adjusted = [];\n    let totalAdjusted = 0;\n    const strength = 0.8;\n    const missingFatty = oils.filter(oil => !oil.fattyProfile || typeof oil.fattyProfile !== 'object').length;\n    if (missingFatty === oils.length) {\n      showSoapAlert('warning', 'None of the selected oils have fatty acid data, so targets cannot be applied.', { dismissible: true, timeoutMs: 6000 });\n      return;\n    }\n    if (missingFatty) {\n      showSoapAlert('info', 'Some oils are missing fatty acid data. The nudge will only use oils with profiles.', { dismissible: true, timeoutMs: 5000 });\n    }\n\n    oils.forEach(oil => {\n      const scores = computeOilQualityScores(oil.fattyProfile);\n      const adjustment = (deltas.hardness * scores.hardness)\n        + (deltas.cleansing * scores.cleansing)\n        + (deltas.conditioning * scores.conditioning)\n        + (deltas.bubbly * scores.bubbly)\n        + (deltas.creamy * scores.creamy);\n      const factor = clamp(1 + adjustment * strength, 0.2, 1.8);\n      const next = oil.grams * factor;\n      adjusted.push({ row: oil.row, grams: next });\n      totalAdjusted += next;\n    });\n\n    if (totalAdjusted <= 0) {\n      showSoapAlert('warning', 'Unable to adjust blend with current data.', { dismissible: true, timeoutMs: 5000 });\n      return;\n    }\n\n    const scale = totalOils / totalAdjusted;\n    const target = SoapTool.oils.getOilTargetGrams() || totalOils;\n    adjusted.forEach(item => {\n      const grams = item.grams * scale;\n      const gramsInput = item.row.querySelector('.oil-grams');\n      const pctInput = item.row.querySelector('.oil-percent');\n      if (gramsInput) gramsInput.value = grams > 0 ? round(SoapTool.units.fromGrams(grams), 2) : '';\n      if (pctInput && target > 0) {\n        const percent = (grams / target) * 100;\n        pctInput.value = percent > 0 ? round(percent, 2) : '';\n      }\n    });\n\n    SoapTool.oils.updateOilTotals();\n    SoapTool.storage.queueStateSave();\n    SoapTool.storage.queueAutoCalc();\n    showSoapAlert('info', 'Blend nudged toward selected targets. Re-check results and adjust as needed.', { dismissible: true, timeoutMs: 6000 });\n  }\n\n  function updateQualitiesDisplay(data){\n    const {\n      qualities,\n      fattyPercent,\n      coveragePct,\n      iodine,\n      ins,\n      sapAvg,\n      superfat,\n      warnings: serviceWarnings,\n    } = data;\n\n    const hasCoverage = coveragePct > 0;\n\n    function setQuality(name, value){\n      const label = document.getElementById(`quality${name}Value`);\n      const hintEl = document.getElementById(`quality${name}Hint`);\n      if (!label) return;\n      label.textContent = hasCoverage && isFinite(value) ? round(value, 1) : '--';\n      pulseValue(label);\n      const rangeKey = name.toLowerCase();\n      const range = QUALITY_RANGES[rangeKey];\n      const fillResult = setBarFill({\n        barId: `quality${name}Bar`,\n        fillId: `quality${name}Fill`,\n        value: hasCoverage ? value : 0,\n        max: 100,\n        label: name\n      });\n      if (fillResult && range) {\n        setQualityBarColor(fillResult.fill, value, range);\n        if (hasCoverage && isFinite(value)) {\n          fillResult.bar.title = `${name}: ${round(value, 1)} (safe ${range[0]}-${range[1]}). ${QUALITY_HINTS[rangeKey] || ''}`.trim();\n        } else {\n          fillResult.bar.title = `${name}: -- (safe ${range[0]}-${range[1]}). ${QUALITY_HINTS[rangeKey] || ''}`.trim();\n        }\n      }\n      if (hintEl && range) {\n        if (!hasCoverage || !isFinite(value)) {\n          hintEl.textContent = '';\n        } else if (value < range[0]) {\n          hintEl.textContent = QUALITY_FEEL_HINTS[rangeKey]?.low || '';\n        } else if (value > range[1]) {\n          hintEl.textContent = QUALITY_FEEL_HINTS[rangeKey]?.high || '';\n        } else {\n          hintEl.textContent = '';\n        }\n      }\n    }\n\n    setQuality('Hardness', qualities.hardness);\n    setQuality('Cleansing', qualities.cleansing);\n    setQuality('Conditioning', qualities.conditioning);\n    setQuality('Bubbly', qualities.bubbly);\n    setQuality('Creamy', qualities.creamy);\n\n    const coverageNote = document.getElementById('fattyCoverageNote');\n    if (coverageNote) {\n      coverageNote.textContent = coveragePct > 0\n        ? `Fatty acid coverage: ${round(coveragePct, 1)}% of oils`\n        : 'Fatty acid coverage: not enough data yet';\n    }\n\n    const iodineEl = document.getElementById('iodineValue');\n    const insEl = document.getElementById('insValue');\n    const sapEl = document.getElementById('sapAvgValue');\n    if (iodineEl) {\n      iodineEl.textContent = iodine > 0 ? round(iodine, 1) : '--';\n      pulseValue(iodineEl);\n    }\n    if (insEl) {\n      insEl.textContent = ins > 0 ? round(ins, 1) : '--';\n      pulseValue(insEl);\n    }\n    if (sapEl) {\n      sapEl.textContent = sapAvg > 0 ? round(sapAvg, 1) : '--';\n      pulseValue(sapEl);\n    }\n    setScaledBar('iodineBar', 'iodineFill', iodine, IODINE_RANGE, IODINE_SCALE_MAX, 'Iodine');\n    setScaledBar('insBar', 'insFill', ins, INS_RANGE, INS_SCALE_MAX, 'INS');\n\n    const sat = (fattyPercent.lauric || 0) + (fattyPercent.myristic || 0) + (fattyPercent.palmitic || 0) + (fattyPercent.stearic || 0);\n    const unsat = (fattyPercent.ricinoleic || 0) + (fattyPercent.oleic || 0) + (fattyPercent.linoleic || 0) + (fattyPercent.linolenic || 0);\n    const ratioEl = document.getElementById('fattySatRatioResult');\n    if (ratioEl) {\n      ratioEl.textContent = (sat + unsat) > 0 ? `${round(sat, 0)}:${round(unsat, 0)}` : '--';\n      pulseValue(ratioEl);\n    }\n\n    FATTY_DISPLAY_KEYS.forEach(key => {\n      const id = `fatty${key.charAt(0).toUpperCase()}${key.slice(1)}`;\n      const value = fattyPercent[key];\n      document.getElementById(id).textContent = hasCoverage && value ? `${round(value, 1)}%` : '--';\n    });\n    updateQualitySliders(qualities, superfat || 0);\n    updateFattyBar(fattyPercent);\n    updateQualityTargets();\n\n    const warnings = Array.isArray(serviceWarnings) ? serviceWarnings.slice() : [];\n    const warningBox = document.getElementById('soapQualityWarnings');\n    if (warnings.length) {\n      warningBox.classList.remove('d-none');\n      warningBox.innerHTML = `<strong>Guidance & flags:</strong><ul class=\"mb-0\">${warnings.map(w => `<li>${w}</li>`).join('')}</ul>`;\n    } else {\n      warningBox.classList.add('d-none');\n      warningBox.textContent = '';\n    }\n    SoapTool.layout.scheduleStageHeightSync();\n  }\n\n  function initQualityTooltips(){\n    document.querySelectorAll('.soap-quality-help').forEach(btn => {\n      const key = btn.dataset.quality;\n      if (QUALITY_HINTS[key]) {\n        btn.setAttribute('title', QUALITY_HINTS[key]);\n      }\n    });\n    if (window.bootstrap?.Tooltip) {\n      document.querySelectorAll('[data-bs-toggle=\"tooltip\"]').forEach(el => {\n        bootstrap.Tooltip.getOrCreateInstance(el);\n      });\n    }\n  }\n\n  SoapTool.quality = {\n    setQualityRangeBars,\n    updateQualityTargets,\n    applyQualityTargets,\n    updateQualitiesDisplay,\n    initQualityTooltips,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { round, toNumber, clamp } = SoapTool.helpers;\n\n  function deriveSapAverage(oils){\n    let sapWeighted = 0;\n    let sapWeightG = 0;\n    (oils || []).forEach(oil => {\n      const sapKoh = toNumber(oil?.sapKoh);\n      const grams = toNumber(oil?.grams);\n      if (sapKoh > 0 && grams > 0) {\n        sapWeighted += sapKoh * grams;\n        sapWeightG += grams;\n      }\n    });\n    return sapWeightG > 0 ? sapWeighted / sapWeightG : 0;\n  }\n\n  function buildSoapNotesBlob(calc){\n    const qualityReport = calc.qualityReport || {};\n    const fattyPercent = qualityReport.fatty_acids_pct || {};\n    const qualities = qualityReport.qualities || {};\n    const sapAvg = (isFinite(calc.sapAvg) && calc.sapAvg > 0)\n      ? calc.sapAvg\n      : (toNumber(qualityReport.sap_avg_koh) || deriveSapAverage(calc.oils || []));\n    const iodine = toNumber(qualityReport.iodine);\n    const ins = toNumber(qualityReport.ins) || ((sapAvg && iodine) ? (sapAvg - iodine) : 0);\n    const mold = SoapTool.mold.getMoldSettings();\n    return {\n      source: 'soap_tool',\n      schema_version: 1,\n      unit_display: SoapTool.state.currentUnit,\n      input_mode: 'mixed',\n      quality_preset: document.getElementById('qualityPreset')?.value || 'balanced',\n      quality_focus: Array.from(document.querySelectorAll('.quality-focus:checked')).map(el => el.id),\n      mold,\n      oils: (calc.oils || []).map(oil => ({\n        name: oil.name || null,\n        grams: round(oil.grams || 0, 2),\n        iodine: oil.iodine || null,\n        sap_koh: oil.sapKoh || null,\n        fatty_profile: oil.fattyProfile || null,\n        global_item_id: oil.global_item_id || null,\n        default_unit: oil.default_unit || null,\n        ingredient_category_name: oil.ingredient_category_name || null,\n      })),\n      totals: {\n        total_oils_g: round(calc.totalOils || 0, 2),\n        batch_yield_g: round(calc.batchYield || 0, 2),\n        lye_pure_g: round(calc.lyePure || 0, 2),\n        lye_adjusted_g: round(calc.lyeAdjusted || 0, 2),\n        water_g: round(calc.water || 0, 2),\n      },\n      lye: {\n        lye_type: calc.lyeType,\n        superfat: calc.superfat,\n        purity: calc.purity,\n        water_method: calc.waterMethod,\n        water_pct: calc.waterPct,\n        lye_concentration: calc.lyeConcentration,\n        water_ratio: calc.waterRatio,\n      },\n      additives: {\n        fragrance_pct: calc.additives?.fragrancePct || 0,\n        lactate_pct: calc.additives?.lactatePct || 0,\n        sugar_pct: calc.additives?.sugarPct || 0,\n        salt_pct: calc.additives?.saltPct || 0,\n        citric_pct: calc.additives?.citricPct || 0,\n        fragrance_g: round(calc.additives?.fragranceG || 0, 2),\n        lactate_g: round(calc.additives?.lactateG || 0, 2),\n        sugar_g: round(calc.additives?.sugarG || 0, 2),\n        salt_g: round(calc.additives?.saltG || 0, 2),\n        citric_g: round(calc.additives?.citricG || 0, 2),\n        citric_lye_g: round(calc.additives?.citricLyeG || 0, 2),\n      },\n      qualities: {\n        hardness: round(qualities.hardness || 0, 1),\n        cleansing: round(qualities.cleansing || 0, 1),\n        conditioning: round(qualities.conditioning || 0, 1),\n        bubbly: round(qualities.bubbly || 0, 1),\n        creamy: round(qualities.creamy || 0, 1),\n        iodine: round(iodine || 0, 1),\n        ins: round(ins || 0, 1),\n        sap_avg: round(sapAvg || 0, 1),\n      },\n      fatty_acids: fattyPercent,\n      updated_at: new Date().toISOString(),\n    };\n  }\n\n  function getAdditiveItem(nameId, giId, fallbackName, unitId, categoryId){\n    const name = document.getElementById(nameId)?.value?.trim();\n    const giRaw = document.getElementById(giId)?.value || '';\n    const defaultUnit = unitId ? document.getElementById(unitId)?.value || '' : '';\n    const categoryName = categoryId ? document.getElementById(categoryId)?.value || '' : '';\n    return {\n      name: name || fallbackName,\n      globalItemId: giRaw ? parseInt(giRaw) : undefined,\n      defaultUnit: defaultUnit || undefined,\n      categoryName: categoryName || undefined,\n    };\n  }\n\n  function collectFragranceRows(totalOils){\n    const rows = [];\n    const target = clamp(totalOils || SoapTool.oils.getTotalOilsGrams() || 0, 0);\n    document.querySelectorAll('#fragranceRows .fragrance-row').forEach(row => {\n      const name = row.querySelector('.fragrance-typeahead')?.value?.trim();\n      const giRaw = row.querySelector('.fragrance-gi-id')?.value || '';\n      const defaultUnit = row.querySelector('.fragrance-default-unit')?.value || '';\n      const categoryName = row.querySelector('.fragrance-category')?.value || '';\n      const gramsInput = row.querySelector('.fragrance-grams')?.value;\n      const pctInput = row.querySelector('.fragrance-percent')?.value;\n      let grams = SoapTool.units.toGrams(gramsInput);\n      const pct = clamp(toNumber(pctInput), 0);\n      if (grams <= 0 && pct > 0 && target > 0) {\n        grams = target * (pct / 100);\n      }\n      if (!name && !giRaw && grams <= 0) return;\n      rows.push({\n        name: name || 'Fragrance/Essential Oils',\n        globalItemId: giRaw ? parseInt(giRaw) : undefined,\n        defaultUnit: defaultUnit || undefined,\n        categoryName: categoryName || undefined,\n        grams,\n        pct,\n      });\n    });\n    return rows;\n  }\n\n  function collectDraftLines(wrapperId, kind){\n    const out = [];\n    document.querySelectorAll(`#${wrapperId} .row`).forEach(function(row){\n      const name = row.querySelector('.tool-typeahead')?.value?.trim();\n      const gi = row.querySelector('.tool-gi-id')?.value || '';\n      const qtyEl = row.querySelector('.tool-qty');\n      const unitEl = row.querySelector('.tool-unit');\n      const hasQty = qtyEl && qtyEl.value !== '';\n      if (!name && !gi) return;\n      if (kind === 'container'){\n        out.push({ name: name || undefined, global_item_id: gi ? parseInt(gi) : undefined, quantity: hasQty ? parseFloat(qtyEl.value) : 1 });\n      } else {\n        out.push({ name: name || undefined, global_item_id: gi ? parseInt(gi) : undefined, quantity: hasQty ? parseFloat(qtyEl.value) : 0, unit: (unitEl?.value || '').trim() || 'gram' });\n      }\n    });\n    return out;\n  }\n\n  function buildLineRow(kind){\n    const context = SoapTool.config.isAuthenticated ? 'member' : 'public';\n    const mode = SoapTool.config.isAuthenticated ? 'recipe' : 'public';\n    return buildToolLineRow(kind, { context, mode, unitOptionsHtml: SoapTool.config.unitOptionsHtml });\n  }\n\n  function addStubLine(kind, name){\n    const row = buildLineRow(kind);\n    const input = row.querySelector('.tool-typeahead');\n    const qty = row.querySelector('.tool-qty');\n    if (input) {\n      input.value = name;\n    }\n    if (qty && kind === 'container') {\n      qty.value = 1;\n    }\n    if (kind === 'container') {\n      document.getElementById('tool-containers').appendChild(row);\n    } else if (kind === 'consumable') {\n      document.getElementById('tool-consumables').appendChild(row);\n    } else {\n      document.getElementById('tool-ingredients').appendChild(row);\n    }\n  }\n\n  function buildSoapRecipePayload(calc){\n    const notesBlob = buildSoapNotesBlob(calc);\n    const baseIngredients = (calc.oils || []).map(oil => ({\n      name: oil.name || undefined,\n      global_item_id: oil.global_item_id || undefined,\n      quantity: oil.grams,\n      unit: 'gram',\n      default_unit: oil.default_unit || undefined,\n      ingredient_category_name: oil.ingredient_category_name || undefined,\n    }));\n    const lyeName = calc.lyeType === 'KOH' ? 'Potassium Hydroxide (KOH)' : 'Sodium Hydroxide (NaOH)';\n    if (calc.lyeAdjusted > 0) {\n      baseIngredients.push({ name: lyeName, quantity: round(calc.lyeAdjusted, 2), unit: 'gram' });\n    }\n    if (calc.water > 0) {\n      baseIngredients.push({ name: 'Distilled Water', quantity: round(calc.water, 2), unit: 'gram' });\n    }\n    const fragranceRows = collectFragranceRows(calc.totalOils || 0);\n    fragranceRows.forEach(item => {\n      if (item.grams > 0) {\n        baseIngredients.push({\n          name: item.name,\n          global_item_id: item.globalItemId,\n          quantity: round(item.grams, 2),\n          unit: 'gram',\n          default_unit: item.defaultUnit,\n          ingredient_category_name: item.categoryName,\n        });\n      }\n    });\n    if (calc.additives?.lactateG > 0) {\n      const item = getAdditiveItem('additiveLactateName', 'additiveLactateGi', 'Sodium Lactate', 'additiveLactateUnit', 'additiveLactateCategory');\n      baseIngredients.push({\n        name: item.name,\n        global_item_id: item.globalItemId,\n        quantity: round(calc.additives.lactateG, 2),\n        unit: 'gram',\n        default_unit: item.defaultUnit,\n        ingredient_category_name: item.categoryName,\n      });\n    }\n    if (calc.additives?.sugarG > 0) {\n      const item = getAdditiveItem('additiveSugarName', 'additiveSugarGi', 'Sugar', 'additiveSugarUnit', 'additiveSugarCategory');\n      baseIngredients.push({\n        name: item.name,\n        global_item_id: item.globalItemId,\n        quantity: round(calc.additives.sugarG, 2),\n        unit: 'gram',\n        default_unit: item.defaultUnit,\n        ingredient_category_name: item.categoryName,\n      });\n    }\n    if (calc.additives?.saltG > 0) {\n      const item = getAdditiveItem('additiveSaltName', 'additiveSaltGi', 'Salt', 'additiveSaltUnit', 'additiveSaltCategory');\n      baseIngredients.push({\n        name: item.name,\n        global_item_id: item.globalItemId,\n        quantity: round(calc.additives.saltG, 2),\n        unit: 'gram',\n        default_unit: item.defaultUnit,\n        ingredient_category_name: item.categoryName,\n      });\n    }\n    if (calc.additives?.citricG > 0) {\n      const item = getAdditiveItem('additiveCitricName', 'additiveCitricGi', 'Citric Acid', 'additiveCitricUnit', 'additiveCitricCategory');\n      baseIngredients.push({\n        name: item.name,\n        global_item_id: item.globalItemId,\n        quantity: round(calc.additives.citricG, 2),\n        unit: 'gram',\n        default_unit: item.defaultUnit,\n        ingredient_category_name: item.categoryName,\n      });\n      baseIngredients.push({ name: 'Extra Lye for Citric Acid', quantity: round(calc.additives.citricLyeG, 2), unit: 'gram' });\n    }\n    return {\n      name: 'Soap (Draft)',\n      instructions: 'Draft from Soap Tools',\n      predicted_yield: Math.round((calc.batchYield || 0) * 100) / 100,\n      predicted_yield_unit: 'gram',\n      category_name: 'Soaps',\n      category_data: {\n        soap_superfat: calc.superfat,\n        soap_lye_type: calc.lyeType,\n        soap_lye_purity: calc.purity,\n        soap_water_method: calc.waterMethod,\n        soap_water_pct: calc.waterPct,\n        soap_lye_concentration: calc.lyeConcentration,\n        soap_water_ratio: calc.waterRatio,\n        soap_oils_total_g: calc.totalOils,\n        soap_lye_g: calc.lyeAdjusted,\n        soap_water_g: calc.water,\n      },\n      ingredients: baseIngredients.concat(collectDraftLines('tool-ingredients', 'ingredient')),\n      consumables: collectDraftLines('tool-consumables', 'consumable'),\n      containers: collectDraftLines('tool-containers', 'container'),\n      notes: JSON.stringify(notesBlob),\n    };\n  }\n\n  SoapTool.recipePayload = {\n    collectFragranceRows,\n    collectDraftLines,\n    buildLineRow,\n    addStubLine,\n    buildSoapRecipePayload,\n  };\n})(window);\n\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { round, toNumber, clamp } = SoapTool.helpers;\n  const { formatWeight, formatPercent } = SoapTool.units;\n\n  function getLyeSelection(){\n    const selected = document.querySelector('input[name=\"lye_type\"]:checked')?.value || 'NaOH';\n    const purityInput = document.getElementById('lyePurity');\n    const purityRaw = purityInput?.value;\n    let purity = toNumber(purityInput?.value);\n    const lyeType = selected === 'NaOH' ? 'NaOH' : 'KOH';\n    if (purityRaw === '' || purityRaw === null || purityRaw === undefined || !isFinite(purity)) {\n      purity = 100;\n    }\n    return { selected, lyeType, purity };\n  }\n\n  function applyLyeSelection(){\n    const purityInput = document.getElementById('lyePurity');\n    const selection = getLyeSelection();\n    if (!purityInput) return;\n    purityInput.removeAttribute('readonly');\n    if (selection.selected === 'KOH90') {\n      const hint = document.getElementById('lyePurityHint');\n      if (hint) hint.textContent = '90% KOH selected. Safe default purity is 90%.';\n    } else {\n      const hint = document.getElementById('lyePurityHint');\n      if (hint) hint.textContent = 'Safe default is 100%.';\n    }\n  }\n\n  function getWaterMethodHelp(method){\n    if (method === 'concentration') {\n      return 'Concentration mode uses lye amount, so superfat and purity change water.';\n    }\n    if (method === 'ratio') {\n      return 'Ratio mode uses lye amount, so superfat and purity change water.';\n    }\n    return 'Percent mode uses oils total, so superfat changes lye but not water.';\n  }\n\n  function updateStageWaterSummary(summary = null, explicitMethod = null){\n    const waterOutput = document.getElementById('stageWaterOutput');\n    const hintOutput = document.getElementById('stageWaterComputedHint');\n    const method = explicitMethod || summary?.waterMethod || document.getElementById('waterMethod')?.value || 'percent';\n\n    if (waterOutput) {\n      const hasWater = summary && isFinite(summary.waterG) && summary.waterG > 0;\n      waterOutput.textContent = hasWater ? formatWeight(summary.waterG) : '--';\n    }\n    if (!hintOutput) return;\n\n    if (!summary || !isFinite(summary.totalOils) || summary.totalOils <= 0) {\n      hintOutput.textContent = `Set oils in Stage 2 to calculate water. ${getWaterMethodHelp(method)}`;\n      return;\n    }\n\n    if (method === 'concentration') {\n      const concentration = summary.lyeConcentrationInput || summary.lyeConcentration || 0;\n      hintOutput.textContent = `Using ${round(concentration, 1)}% lye concentration from ${formatWeight(summary.lyeAdjusted || 0)} lye.`;\n      return;\n    }\n    if (method === 'ratio') {\n      const ratio = summary.waterRatioInput || summary.waterRatio || 0;\n      hintOutput.textContent = `Using ${round(ratio, 2)} : 1 water-to-lye ratio from ${formatWeight(summary.lyeAdjusted || 0)} lye.`;\n      return;\n    }\n    hintOutput.textContent = `Using ${round(summary.waterPct || 0, 1)}% of total oils (${formatWeight(summary.totalOils)}).`;\n  }\n\n  function updateLiveCalculationPreview(summary = null, explicitMethod = null){\n    const anchorEl = document.getElementById('lyeWaterPreviewAnchor');\n    const lyeEl = document.getElementById('lyePreview');\n    const waterEl = document.getElementById('waterPreview');\n    const concEl = document.getElementById('concPreview');\n    const ratioEl = document.getElementById('ratioPreview');\n    if (!anchorEl && !lyeEl && !waterEl && !concEl && !ratioEl) return;\n\n    const setText = (el, value) => {\n      if (el) el.textContent = value;\n    };\n    const method = explicitMethod || summary?.waterMethod || document.getElementById('waterMethod')?.value || 'percent';\n    const totalOils = toNumber(summary?.totalOils);\n    const lye = toNumber(summary?.lyeAdjusted);\n    const water = toNumber(summary?.waterG);\n    if (totalOils <= 0 || lye <= 0) {\n      setText(anchorEl, 'Based on -- oils. All values update live as you change inputs.');\n      setText(lyeEl, '--');\n      setText(waterEl, '--');\n      setText(concEl, '--');\n      setText(ratioEl, '--');\n      return;\n    }\n\n    const concentration = toNumber(summary?.lyeConcentration) > 0\n      ? toNumber(summary?.lyeConcentration)\n      : ((lye + water) > 0 ? (lye / (lye + water)) * 100 : 0);\n    const ratio = toNumber(summary?.waterRatio) > 0\n      ? toNumber(summary?.waterRatio)\n      : (lye > 0 ? water / lye : 0);\n    setText(anchorEl, `Based on ${formatWeight(totalOils)} oils. All values update live as you change inputs.`);\n    setText(lyeEl, formatWeight(lye));\n    setText(waterEl, formatWeight(water));\n    setText(concEl, concentration > 0 ? formatPercent(concentration) : '--');\n    setText(ratioEl, ratio > 0 ? `${round(ratio, 2)} : 1` : '--');\n\n    if (method === 'concentration') {\n      const concentrationInput = toNumber(summary?.lyeConcentrationInput);\n      if (concentrationInput > 0) {\n        setText(concEl, formatPercent(concentrationInput));\n      }\n    }\n    if (method === 'ratio') {\n      const ratioInput = toNumber(summary?.waterRatioInput);\n      if (ratioInput > 0) {\n        setText(ratioEl, `${round(ratioInput, 2)} : 1`);\n      }\n    }\n  }\n\n  function setWaterMethod(){\n    const method = document.getElementById('waterMethod')?.value || 'percent';\n    document.querySelectorAll('.water-input').forEach(el => {\n      el.classList.toggle('d-none', el.dataset.method !== method);\n    });\n    updateStageWaterSummary(null, method);\n    updateLiveCalculationPreview(null, method);\n  }\n\n  function validateCalculation(){\n    const totals = SoapTool.oils.updateOilTotals();\n    const totalOils = totals.totalWeight;\n    const totalPct = totals.totalPct;\n    const errors = [];\n    const oils = SoapTool.oils.collectOilData();\n    const target = SoapTool.oils.getOilTargetGrams();\n    const percentInputs = Array.from(document.querySelectorAll('#oilRows .oil-percent'))\n      .map(input => clamp(toNumber(input.value), 0));\n    const hasPercent = percentInputs.some(value => value > 0);\n\n    if (!oils.length || totalOils <= 0) {\n      errors.push('Add at least one oil with a weight or percent.');\n    }\n    if (!target && totalOils <= 0 && hasPercent) {\n      errors.push('Enter a total oils target or weights to convert percentages.');\n    }\n    if (target > 0 && totalPct > 0 && Math.abs(totalPct - 100) > 0.5) {\n      errors.push('Oil percentages should total 100% (use Normalize to fix).');\n    }\n    if (target > 0 && totalOils > target + 0.01) {\n      errors.push('Oil weights exceed the mold target.');\n    } else if (!target && totalPct > 100.01) {\n      errors.push('Oil percentages exceed 100%.');\n    }\n    return { ok: errors.length === 0, errors, totals, oils };\n  }\n\n  function readSuperfatInput(){\n    const superfatInput = document.getElementById('lyeSuperfat');\n    const superfatRaw = superfatInput?.value;\n    let superfat = toNumber(superfatRaw);\n    if (superfatRaw === '' || superfatRaw === null || superfatRaw === undefined || !isFinite(superfat)) {\n      superfat = 5;\n    }\n    return superfat;\n  }\n\n  function sanitizeLyeInputs(){\n    const selection = getLyeSelection();\n    let purity = selection.purity;\n    if (!isFinite(purity)) {\n      purity = 100;\n    }\n\n    const waterMethod = document.getElementById('waterMethod')?.value || 'percent';\n    // Do not force defaults or clamp user typing for water inputs.\n    // Backend calculation logic owns method defaults/ranges.\n    const waterPct = toNumber(document.getElementById('waterPct')?.value);\n    const lyeConcentration = toNumber(document.getElementById('lyeConcentration')?.value);\n    const waterRatio = toNumber(document.getElementById('waterRatio')?.value);\n\n    return { purity, waterMethod, waterPct, lyeConcentration, waterRatio };\n  }\n\n  SoapTool.runnerInputs = {\n    getLyeSelection,\n    applyLyeSelection,\n    setWaterMethod,\n    updateStageWaterSummary,\n    updateLiveCalculationPreview,\n    validateCalculation,\n    readSuperfatInput,\n    sanitizeLyeInputs,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { getStorage } = SoapTool.helpers;\n\n  function readCalcUsage(){\n    if (!SoapTool.config.calcLimit) return { count: 0, date: null };\n    const storage = getStorage();\n    if (!storage) return { count: 0, date: null };\n    try {\n      const raw = storage.getItem('soap_calc_usage');\n      const today = new Date().toISOString().slice(0, 10);\n      if (!raw) return { count: 0, date: today };\n      const data = JSON.parse(raw);\n      if (!data || data.date !== today) {\n        return { count: 0, date: today };\n      }\n      return { count: Number(data.count) || 0, date: today };\n    } catch (_) {\n      return { count: 0, date: null };\n    }\n  }\n\n  function writeCalcUsage(count){\n    if (!SoapTool.config.calcLimit) return;\n    const storage = getStorage();\n    if (!storage) return;\n    const today = new Date().toISOString().slice(0, 10);\n    try {\n      storage.setItem('soap_calc_usage', JSON.stringify({ count, date: today }));\n    } catch (_) {}\n  }\n\n  function canConsumeCalcQuota(){\n    if (!SoapTool.config.calcLimit) return true;\n    const usage = readCalcUsage();\n    if (usage.count >= SoapTool.config.calcLimit) {\n      SoapTool.ui.showSoapAlert(\n        'warning',\n        `You have reached the ${SoapTool.config.calcLimit} calculation limit for ${SoapTool.config.calcTier} accounts. Create a free account or upgrade to keep calculating.`,\n        { dismissible: true }\n      );\n      return false;\n    }\n    return true;\n  }\n\n  function consumeCalcQuota(){\n    if (!SoapTool.config.calcLimit) return;\n    const usage = readCalcUsage();\n    const nextCount = usage.count + 1;\n    writeCalcUsage(nextCount);\n    const remaining = Math.max(0, SoapTool.config.calcLimit - nextCount);\n    if (remaining <= 1) {\n      SoapTool.ui.showSoapAlert(\n        'info',\n        `You have ${remaining} calculation${remaining === 1 ? '' : 's'} left on the ${SoapTool.config.calcTier} tier today.`,\n        { dismissible: true, timeoutMs: 6000 }\n      );\n    }\n  }\n\n  function maybeShowSignupModal(remaining){\n    if (!SoapTool.config.calcLimit || remaining === null || remaining > 1) return;\n    const modalEl = document.getElementById('soapSignupModal');\n    if (!modalEl) return;\n    if (window.bootstrap && window.bootstrap.Modal) {\n      const modal = window.bootstrap.Modal.getOrCreateInstance(modalEl);\n      modal.show();\n    } else {\n      SoapTool.ui.showSoapAlert(\n        'info',\n        'You are almost at the free limit. Create a free account to keep saving your work.',\n        { dismissible: true, timeoutMs: 7000 }\n      );\n    }\n  }\n\n  SoapTool.runnerQuota = {\n    canConsumeCalcQuota,\n    consumeCalcQuota,\n    maybeShowSignupModal,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const state = SoapTool.state;\n\n  function buildServicePayload({\n    oils,\n    selection,\n    superfat,\n    purity,\n    waterMethod,\n    waterPct,\n    lyeConcentration,\n    waterRatio,\n    totalOils,\n  }){\n    const additiveSettings = SoapTool.additives.collectAdditiveSettings();\n    const fragranceRows = SoapTool.recipePayload.collectFragranceRows(totalOils || 0);\n    return {\n      oils: (oils || []).map(oil => ({\n        name: oil.name || null,\n        grams: oil.grams || 0,\n        sap_koh: oil.sapKoh || 0,\n        iodine: oil.iodine || 0,\n        fatty_profile: oil.fattyProfile || null,\n        global_item_id: oil.global_item_id || null,\n        default_unit: oil.default_unit || null,\n        ingredient_category_name: oil.ingredient_category_name || null,\n      })),\n      fragrances: fragranceRows.map(row => ({\n        name: row.name || 'Fragrance/Essential Oils',\n        grams: row.grams || 0,\n        pct: row.pct || 0,\n      })),\n      additives: {\n        lactate_pct: additiveSettings.lactatePct || 0,\n        sugar_pct: additiveSettings.sugarPct || 0,\n        salt_pct: additiveSettings.saltPct || 0,\n        citric_pct: additiveSettings.citricPct || 0,\n        lactate_name: additiveSettings.lactateName || 'Sodium Lactate',\n        sugar_name: additiveSettings.sugarName || 'Sugar',\n        salt_name: additiveSettings.saltName || 'Salt',\n        citric_name: additiveSettings.citricName || 'Citric Acid',\n      },\n      lye: {\n        selected: selection?.selected || 'NaOH',\n        superfat,\n        purity,\n      },\n      water: {\n        method: waterMethod,\n        water_pct: waterPct,\n        lye_concentration: lyeConcentration,\n        water_ratio: waterRatio,\n      },\n      meta: {\n        unit_display: state.currentUnit || 'g',\n      }\n    };\n  }\n\n  async function calculateWithSoapService(payload){\n    const token = document.querySelector('meta[name=\"csrf-token\"]')?.getAttribute('content') || '';\n    const controller = new AbortController();\n    const timeoutId = window.setTimeout(() => controller.abort(), 2500);\n    try {\n      const response = await fetch('/tools/api/soap/calculate', {\n        method: 'POST',\n        signal: controller.signal,\n        headers: {\n          'Content-Type': 'application/json',\n          ...(token ? { 'X-CSRFToken': token } : {}),\n        },\n        body: JSON.stringify(payload || {}),\n      });\n      if (!response.ok) return null;\n      const data = await response.json();\n      if (!data || data.success !== true || typeof data.result !== 'object') return null;\n      return data.result;\n    } catch (_) {\n      return null;\n    } finally {\n      window.clearTimeout(timeoutId);\n    }\n  }\n\n  SoapTool.runnerService = {\n    buildServicePayload,\n    calculateWithSoapService,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { round, toNumber } = SoapTool.helpers;\n  const { formatWeight, formatPercent } = SoapTool.units;\n  const state = SoapTool.state;\n\n  const DEFAULT_ADDITIVES = {\n    lactateG: 0,\n    sugarG: 0,\n    saltG: 0,\n    citricG: 0,\n    citricLyeG: 0,\n    fragranceG: 0,\n    fragrancePct: 0,\n  };\n\n  function mapOilsForState(rows){\n    return (rows || []).map(oil => ({\n      name: oil.name || null,\n      grams: toNumber(oil.grams),\n      sapKoh: toNumber(oil.sap_koh ?? oil.sapKoh),\n      iodine: toNumber(oil.iodine),\n      fattyProfile: oil.fatty_profile || oil.fattyProfile || null,\n      global_item_id: oil.global_item_id || null,\n      default_unit: oil.default_unit || null,\n      ingredient_category_name: oil.ingredient_category_name || null,\n    }));\n  }\n\n  function setText(id, value){\n    const el = document.getElementById(id);\n    if (!el) return;\n    el.textContent = value;\n  }\n\n  function renderResultsCard({\n    resultsCard,\n    lyeAdjusted,\n    waterData,\n    batchYield,\n    totalOils,\n    superfat,\n  }){\n    const card = document.getElementById('resultsCard');\n    if (card) card.style.display = 'block';\n\n    const ratioValue = toNumber(resultsCard.water_lye_ratio) || waterData.waterRatio;\n    setText('lyeAdjustedOutput', formatWeight(toNumber(resultsCard.lye_adjusted_g) || lyeAdjusted));\n    setText('waterOutput', formatWeight(toNumber(resultsCard.water_g) || waterData.waterG));\n    setText('batchYieldOutput', formatWeight(batchYield));\n    setText(\n      'lyeConcentrationOutput',\n      formatPercent(toNumber(resultsCard.lye_concentration_pct) || waterData.lyeConcentration)\n    );\n    setText(\n      'waterRatioOutput',\n      (isFinite(ratioValue) && ratioValue > 0) ? round(ratioValue, 2).toString() : '--'\n    );\n    setText('totalOilsOutput', formatWeight(totalOils));\n    setText('superfatOutput', formatPercent(superfat));\n\n    [\n      'lyeAdjustedOutput',\n      'waterOutput',\n      'batchYieldOutput',\n      'lyeConcentrationOutput',\n      'waterRatioOutput',\n      'totalOilsOutput',\n      'superfatOutput',\n    ].forEach(id => SoapTool.ui.pulseValue(document.getElementById(id)));\n  }\n\n  function maybeShowGuidanceAlerts({ showAlerts, lyeTotals, purity, waterData }){\n    if (!showAlerts) return;\n    if (lyeTotals.usedFallback) {\n      SoapTool.ui.showSoapAlert(\n        'info',\n        'Some oils are missing SAP values, so an average SAP was used. Select oils with SAP data for the most accurate lye calculation.',\n        { dismissible: true, timeoutMs: 7000 }\n      );\n    }\n    if (purity < 100) {\n      SoapTool.ui.showSoapAlert(\n        'info',\n        `Lye purity is set to ${round(purity, 1)}%. Adjusting lye to match your real-world purity.`,\n        { dismissible: true, timeoutMs: 6000 }\n      );\n    }\n    if (waterData.lyeConcentration < 25 || waterData.lyeConcentration > 45) {\n      SoapTool.ui.showSoapAlert(\n        'warning',\n        'Your lye concentration is outside the common 25-45% range. Expect slower or faster trace.',\n        { dismissible: true, timeoutMs: 7000 }\n      );\n    }\n    const mold = SoapTool.mold.getMoldSettings();\n    if (mold.shape === 'cylinder' && mold.waterWeight > 0 && !mold.useCylinder) {\n      SoapTool.ui.showSoapAlert(\n        'info',\n        'Cylinder mold selected. Enable the cylinder correction if you want to leave headspace or reduce spill risk.',\n        { dismissible: true, timeoutMs: 7000 }\n      );\n    }\n  }\n\n  function applyServiceResult({\n    serviceResult,\n    validation,\n    selection,\n    superfat,\n    purity,\n    waterMethod,\n    waterPct,\n    lyeConcentrationInput,\n    waterRatioInput,\n    showAlerts,\n  }){\n    const lyeType = serviceResult.lye_type || selection.lyeType || 'NaOH';\n    const totalOils = toNumber(serviceResult.total_oils_g) || validation.totals.totalWeight;\n    const resolvedSuperfat = toNumber(serviceResult.superfat_pct);\n    const superfatValue = isFinite(resolvedSuperfat) ? resolvedSuperfat : superfat;\n    const lyeTotals = {\n      sapAvg: toNumber(serviceResult.sap_avg_koh),\n      usedFallback: !!serviceResult.used_sap_fallback,\n    };\n    const lyePure = toNumber(serviceResult.lye_pure_g);\n    const lyeAdjusted = toNumber(serviceResult.lye_adjusted_g);\n    const resolvedPurity = toNumber(serviceResult.lye_purity_pct) || purity;\n    const resolvedWaterMethod = serviceResult.water_method || waterMethod;\n    const resolvedWaterPct = toNumber(serviceResult.water_pct) || waterPct;\n    const resolvedLyeConcentrationInput = toNumber(serviceResult.lye_concentration_input_pct) || lyeConcentrationInput;\n    const resolvedWaterRatioInput = toNumber(serviceResult.water_ratio_input) || waterRatioInput;\n    const waterData = {\n      waterG: toNumber(serviceResult.water_g),\n      lyeConcentration: toNumber(serviceResult.lye_concentration_pct),\n      waterRatio: toNumber(serviceResult.water_lye_ratio),\n    };\n    const resultsCard = serviceResult.results_card || {};\n    const qualityReport = serviceResult.quality_report || {};\n    const oilsForState = mapOilsForState(serviceResult.oils || validation.oils);\n    const liveSummary = {\n      waterG: waterData.waterG,\n      lyeAdjusted,\n      totalOils,\n      waterMethod: resolvedWaterMethod,\n      waterPct: resolvedWaterPct,\n      lyeConcentrationInput: resolvedLyeConcentrationInput,\n      waterRatioInput: resolvedWaterRatioInput,\n      lyeConcentration: waterData.lyeConcentration,\n      waterRatio: waterData.waterRatio,\n    };\n    SoapTool.runnerInputs.updateStageWaterSummary(liveSummary);\n    SoapTool.runnerInputs.updateLiveCalculationPreview(liveSummary);\n\n    const additives = serviceResult.additives || DEFAULT_ADDITIVES;\n    if (SoapTool.additives.applyComputedOutputs) {\n      SoapTool.additives.applyComputedOutputs(additives);\n    }\n    const batchYield = toNumber(resultsCard.batch_yield_g) || (\n      totalOils\n      + lyeAdjusted\n      + waterData.waterG\n      + additives.fragranceG\n      + additives.lactateG\n      + additives.sugarG\n      + additives.saltG\n      + additives.citricG\n    );\n    if (SoapTool.mold?.updateWetBatterWarning) {\n      SoapTool.mold.updateWetBatterWarning(batchYield);\n    }\n\n    renderResultsCard({\n      resultsCard,\n      lyeAdjusted,\n      waterData,\n      batchYield,\n      totalOils,\n      superfat: superfatValue,\n    });\n    SoapTool.ui.updateResultsWarnings(waterData);\n    SoapTool.ui.updateResultsMeta();\n\n    SoapTool.quality.updateQualitiesDisplay({\n      qualities: qualityReport.qualities || {},\n      fattyPercent: qualityReport.fatty_acids_pct || {},\n      coveragePct: toNumber(qualityReport.coverage_pct),\n      iodine: toNumber(qualityReport.iodine),\n      ins: toNumber(qualityReport.ins),\n      sapAvg: lyeTotals.sapAvg,\n      superfat: superfatValue,\n      waterData,\n      additives,\n      oils: oilsForState,\n      totalOils,\n      warnings: qualityReport.warnings || [],\n    });\n    SoapTool.additives.updateVisualGuidance({\n      tips: qualityReport.visual_guidance || [],\n    });\n    SoapTool.stages.updateStageStatuses();\n    maybeShowGuidanceAlerts({\n      showAlerts,\n      lyeTotals,\n      purity: resolvedPurity,\n      waterData,\n    });\n\n    state.lastCalc = {\n      totalOils,\n      oils: oilsForState,\n      lyeType,\n      superfat: superfatValue,\n      purity: resolvedPurity,\n      lyePure,\n      lyeAdjusted,\n      water: waterData.waterG,\n      waterMethod: resolvedWaterMethod,\n      waterPct: resolvedWaterPct,\n      lyeConcentration: waterData.lyeConcentration,\n      waterRatio: waterData.waterRatio,\n      sapAvg: lyeTotals.sapAvg,\n      usedSapFallback: lyeTotals.usedFallback,\n      additives,\n      batchYield,\n      qualityReport,\n      export: serviceResult.export || null,\n    };\n    return state.lastCalc;\n  }\n\n  SoapTool.runnerRender = {\n    applyServiceResult,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const state = SoapTool.state;\n  const runnerInputs = SoapTool.runnerInputs;\n  const runnerQuota = SoapTool.runnerQuota;\n  const runnerService = SoapTool.runnerService;\n  const runnerRender = SoapTool.runnerRender;\n\n  async function calculateAll(options = {}){\n    const settings = {\n      consumeQuota: false,\n      showAlerts: true,\n      ...options\n    };\n    try {\n      if (settings.showAlerts) {\n        SoapTool.ui.clearSoapAlerts();\n      }\n\n      const validation = runnerInputs.validateCalculation();\n      if (!validation.ok) {\n        runnerInputs.updateStageWaterSummary(null);\n        runnerInputs.updateLiveCalculationPreview(null);\n        if (SoapTool.mold?.updateWetBatterWarning) {\n          SoapTool.mold.updateWetBatterWarning(0);\n        }\n        if (settings.showAlerts) {\n          SoapTool.ui.showSoapAlert(\n            'warning',\n            `<strong>Missing info:</strong><ul class=\"mb-0\">${validation.errors.map(err => `<li>${err}</li>`).join('')}</ul>`,\n            { dismissible: true, persist: true }\n          );\n        }\n        return null;\n      }\n      if (settings.consumeQuota && !runnerQuota.canConsumeCalcQuota()) {\n        return null;\n      }\n\n      const superfat = runnerInputs.readSuperfatInput();\n      const selection = runnerInputs.getLyeSelection();\n      const sanitized = runnerInputs.sanitizeLyeInputs();\n\n      const requestSeq = (state.calcRequestSeq || 0) + 1;\n      state.calcRequestSeq = requestSeq;\n      const servicePayload = runnerService.buildServicePayload({\n        oils: validation.oils,\n        selection,\n        superfat,\n        purity: sanitized.purity,\n        waterMethod: sanitized.waterMethod,\n        waterPct: sanitized.waterPct,\n        lyeConcentration: sanitized.lyeConcentration,\n        waterRatio: sanitized.waterRatio,\n        totalOils: validation.totals.totalWeight,\n      });\n      const serviceResult = await runnerService.calculateWithSoapService(servicePayload);\n      if (requestSeq !== state.calcRequestSeq) {\n        return state.lastCalc;\n      }\n      if (!serviceResult) {\n        if (settings.showAlerts) {\n          SoapTool.ui.showSoapAlert(\n            'danger',\n            'Soap calculator service is unavailable. Please try again.',\n            { dismissible: true, timeoutMs: 6000 }\n          );\n        }\n        return null;\n      }\n\n      const calc = runnerRender.applyServiceResult({\n        serviceResult,\n        validation,\n        selection,\n        superfat,\n        purity: sanitized.purity,\n        waterMethod: sanitized.waterMethod,\n        waterPct: sanitized.waterPct,\n        lyeConcentrationInput: sanitized.lyeConcentration,\n        waterRatioInput: sanitized.waterRatio,\n        showAlerts: settings.showAlerts,\n      });\n      if (settings.consumeQuota) {\n        runnerQuota.consumeCalcQuota();\n      }\n      return calc;\n    } catch (_) {\n      if (settings.showAlerts) {\n        SoapTool.ui.showSoapAlert('danger', 'Unable to run the soap calculation right now. Please try again.', { dismissible: true, timeoutMs: 6000 });\n      }\n      return null;\n    }\n  }\n\n  SoapTool.runner = {\n    getLyeSelection: (...args) => runnerInputs.getLyeSelection(...args),\n    applyLyeSelection: (...args) => runnerInputs.applyLyeSelection(...args),\n    setWaterMethod: (...args) => runnerInputs.setWaterMethod(...args),\n    updateLiveCalculationPreview: (...args) => runnerInputs.updateLiveCalculationPreview(...args),\n    calculateAll,\n    buildSoapRecipePayload: (...args) => SoapTool.recipePayload.buildSoapRecipePayload(...args),\n    buildLineRow: (...args) => SoapTool.recipePayload.buildLineRow(...args),\n    addStubLine: (...args) => SoapTool.recipePayload.addStubLine(...args),\n    maybeShowSignupModal: (...args) => runnerQuota.maybeShowSignupModal(...args),\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { formatTime, getStorage } = SoapTool.helpers;\n  const STATE_STORAGE_KEY = 'soap_tool_state_v2';\n\n  function serializeLines(wrapperId, kind){\n    const out = [];\n    const rows = document.querySelectorAll(`#${wrapperId} .row`);\n    rows.forEach(row => {\n      const name = row.querySelector('.tool-typeahead')?.value?.trim();\n      const gi = row.querySelector('.tool-gi-id')?.value || '';\n      const qtyEl = row.querySelector('.tool-qty');\n      const unitEl = row.querySelector('.tool-unit');\n      const qty = qtyEl && qtyEl.value !== '' ? SoapTool.helpers.toNumber(qtyEl.value) : null;\n      if (!name && !gi) return;\n      if (kind === 'container') {\n        out.push({\n          name: name || '',\n          global_item_id: gi ? parseInt(gi) : null,\n          quantity: qty && qty > 0 ? qty : 1,\n        });\n      } else {\n        out.push({\n          name: name || '',\n          global_item_id: gi ? parseInt(gi) : null,\n          quantity: qty && qty >= 0 ? qty : 0,\n          unit: unitEl?.value || 'gram',\n        });\n      }\n    });\n    return out;\n  }\n\n  function serializeOils(){\n    const oils = [];\n    document.querySelectorAll('#oilRows .oil-row').forEach(row => {\n      const name = row.querySelector('.oil-typeahead')?.value?.trim() || '';\n      const grams = row.querySelector('.oil-grams')?.value || '';\n      const percent = row.querySelector('.oil-percent')?.value || '';\n      const sap = row.querySelector('.oil-sap-koh')?.value || '';\n      const iodine = row.querySelector('.oil-iodine')?.value || '';\n      const fattyRaw = row.querySelector('.oil-fatty')?.value || '';\n      const gi = row.querySelector('.oil-gi-id')?.value || '';\n      const defaultUnit = row.querySelector('.oil-default-unit')?.value || '';\n      const categoryName = row.querySelector('.oil-category')?.value || '';\n      if (!name && !grams && !percent && !gi) return;\n      oils.push({\n        name,\n        grams,\n        percent,\n        sap,\n        iodine,\n        fattyRaw,\n        gi,\n        defaultUnit,\n        categoryName,\n      });\n    });\n    return oils;\n  }\n\n  function serializeFragrances(){\n    if (SoapTool.fragrances?.collectFragranceData) {\n      return SoapTool.fragrances.collectFragranceData();\n    }\n    const rows = [];\n    document.querySelectorAll('#fragranceRows .fragrance-row').forEach(row => {\n      const name = row.querySelector('.fragrance-typeahead')?.value?.trim() || '';\n      const grams = row.querySelector('.fragrance-grams')?.value || '';\n      const percent = row.querySelector('.fragrance-percent')?.value || '';\n      const gi = row.querySelector('.fragrance-gi-id')?.value || '';\n      const defaultUnit = row.querySelector('.fragrance-default-unit')?.value || '';\n      const categoryName = row.querySelector('.fragrance-category')?.value || '';\n      if (!name && !grams && !percent && !gi) return;\n      rows.push({ name, grams, percent, gi, defaultUnit, categoryName });\n    });\n    return rows;\n  }\n\n  function restoreOilRow(data, index){\n    const oilRows = document.getElementById('oilRows');\n    if (!oilRows || !data) return;\n    const row = SoapTool.oils.buildOilRow();\n    row.querySelector('.oil-typeahead').value = data.name || '';\n    row.querySelector('.oil-grams').value = data.grams || '';\n    row.querySelector('.oil-percent').value = data.percent || '';\n    row.querySelector('.oil-sap-koh').value = data.sap || '';\n    row.querySelector('.oil-iodine').value = data.iodine || '';\n    row.querySelector('.oil-fatty').value = data.fattyRaw || '';\n    row.querySelector('.oil-gi-id').value = data.gi || '';\n    const unitEl = row.querySelector('.oil-default-unit');\n    if (unitEl) unitEl.value = data.defaultUnit || '';\n    const categoryEl = row.querySelector('.oil-category');\n    if (categoryEl) categoryEl.value = data.categoryName || '';\n    const children = Array.from(oilRows.children);\n    if (index >= children.length) {\n      oilRows.appendChild(row);\n    } else {\n      oilRows.insertBefore(row, children[index]);\n    }\n    return row;\n  }\n\n  function saveState(){\n    const storage = getStorage();\n    if (!storage) return;\n    const payload = {\n      version: 2,\n      unit: SoapTool.state.currentUnit,\n      oil_total_target: document.getElementById('oilTotalTarget').value || '',\n      oils: serializeOils(),\n      lye_form: {\n        superfat: document.getElementById('lyeSuperfat')?.value || '5',\n        lye_type: document.querySelector('input[name=\"lye_type\"]:checked')?.value || 'NaOH',\n        lye_purity: document.getElementById('lyePurity')?.value || '100',\n        water_method: document.getElementById('waterMethod')?.value || 'percent',\n        water_pct: document.getElementById('waterPct')?.value || '',\n        lye_concentration: document.getElementById('lyeConcentration')?.value || '',\n        water_ratio: document.getElementById('waterRatio')?.value || '',\n      },\n      additives: {\n        fragrances: serializeFragrances(),\n        lactate_pct: document.getElementById('additiveLactatePct').value || '1',\n        lactate_name: document.getElementById('additiveLactateName')?.value || '',\n        lactate_gi: document.getElementById('additiveLactateGi')?.value || '',\n        lactate_unit: document.getElementById('additiveLactateUnit')?.value || '',\n        lactate_category: document.getElementById('additiveLactateCategory')?.value || '',\n        sugar_pct: document.getElementById('additiveSugarPct').value || '1',\n        sugar_name: document.getElementById('additiveSugarName')?.value || '',\n        sugar_gi: document.getElementById('additiveSugarGi')?.value || '',\n        sugar_unit: document.getElementById('additiveSugarUnit')?.value || '',\n        sugar_category: document.getElementById('additiveSugarCategory')?.value || '',\n        salt_pct: document.getElementById('additiveSaltPct').value || '0.5',\n        salt_name: document.getElementById('additiveSaltName')?.value || '',\n        salt_gi: document.getElementById('additiveSaltGi')?.value || '',\n        salt_unit: document.getElementById('additiveSaltUnit')?.value || '',\n        salt_category: document.getElementById('additiveSaltCategory')?.value || '',\n        citric_pct: document.getElementById('additiveCitricPct').value || '0',\n        citric_name: document.getElementById('additiveCitricName')?.value || '',\n        citric_gi: document.getElementById('additiveCitricGi')?.value || '',\n        citric_unit: document.getElementById('additiveCitricUnit')?.value || '',\n        citric_category: document.getElementById('additiveCitricCategory')?.value || '',\n      },\n      mold: {\n        water_weight: document.getElementById('moldWaterWeight').value || '',\n        oil_pct: document.getElementById('moldOilPct').value || '65',\n        shape: document.getElementById('moldShape')?.value || 'loaf',\n        cylinder_correction: !!document.getElementById('moldCylinderCorrection')?.checked,\n        cylinder_factor: document.getElementById('moldCylinderFactor')?.value || '0.85',\n      },\n      quality: {\n        preset: document.getElementById('qualityPreset')?.value || 'balanced',\n        focus: Array.from(document.querySelectorAll('.quality-focus:checked')).map(el => el.id),\n      },\n      lines: {\n        ingredients: serializeLines('tool-ingredients', 'ingredient'),\n        consumables: serializeLines('tool-consumables', 'consumable'),\n        containers: serializeLines('tool-containers', 'container'),\n      },\n      bulk_oils: (SoapTool.bulkOilsModal && typeof SoapTool.bulkOilsModal.serializeSelection === 'function')\n        ? SoapTool.bulkOilsModal.serializeSelection()\n        : { mode: 'basics', selections: [] },\n      updated_at: Date.now(),\n    };\n    try {\n      storage.setItem(STATE_STORAGE_KEY, JSON.stringify(payload));\n      const lastSaved = document.getElementById('soapLastSaved');\n      if (lastSaved) lastSaved.textContent = formatTime(payload.updated_at);\n      SoapTool.ui.showAutosaveToast();\n    } catch (_) {}\n  }\n\n  function restoreState(){\n    const storage = getStorage();\n    if (!storage) return;\n    const raw = storage.getItem(STATE_STORAGE_KEY);\n    if (!raw) return;\n    let data = null;\n    try {\n      data = JSON.parse(raw);\n    } catch (_) {\n      return;\n    }\n    if (!data || typeof data !== 'object') return;\n\n    if (data.unit) {\n      const unitInput = document.querySelector(`input[name=\"weight_unit\"][value=\"${data.unit}\"]`);\n      if (unitInput) unitInput.checked = true;\n      SoapTool.units.setUnit(data.unit, { skipConvert: true, skipAutoCalc: true });\n    }\n\n    if (data.oil_total_target !== undefined) {\n      document.getElementById('oilTotalTarget').value = data.oil_total_target;\n    }\n\n    const oilRows = document.getElementById('oilRows');\n    if (oilRows) {\n      oilRows.innerHTML = '';\n      const oils = Array.isArray(data.oils) && data.oils.length ? data.oils : [{}];\n      oils.forEach(oil => {\n        const row = SoapTool.oils.buildOilRow();\n        row.querySelector('.oil-typeahead').value = oil.name || '';\n        row.querySelector('.oil-grams').value = oil.grams || '';\n        row.querySelector('.oil-percent').value = oil.percent || '';\n        row.querySelector('.oil-sap-koh').value = oil.sap || '';\n        row.querySelector('.oil-iodine').value = oil.iodine || '';\n        row.querySelector('.oil-fatty').value = oil.fattyRaw || '';\n        row.querySelector('.oil-gi-id').value = oil.gi || '';\n        const unitEl = row.querySelector('.oil-default-unit');\n        if (unitEl) unitEl.value = oil.defaultUnit || '';\n        const categoryEl = row.querySelector('.oil-category');\n        if (categoryEl) categoryEl.value = oil.categoryName || '';\n        oilRows.appendChild(row);\n      });\n    }\n\n    if (data.lye_form) {\n      const superfat = document.getElementById('lyeSuperfat');\n      if (superfat) superfat.value = data.lye_form.superfat || '5';\n      const lyeType = document.querySelector(`input[name=\"lye_type\"][value=\"${data.lye_form.lye_type || 'NaOH'}\"]`);\n      if (lyeType) lyeType.checked = true;\n      const purity = document.getElementById('lyePurity');\n      if (purity) purity.value = data.lye_form.lye_purity || '100';\n      const waterMethod = document.getElementById('waterMethod');\n      if (waterMethod) waterMethod.value = data.lye_form.water_method || 'percent';\n      const waterPct = document.getElementById('waterPct');\n      if (waterPct) waterPct.value = data.lye_form.water_pct || '';\n      const lyeConcentration = document.getElementById('lyeConcentration');\n      if (lyeConcentration) lyeConcentration.value = data.lye_form.lye_concentration || '';\n      const waterRatio = document.getElementById('waterRatio');\n      if (waterRatio) waterRatio.value = data.lye_form.water_ratio || '';\n      SoapTool.runner.applyLyeSelection();\n    }\n\n    if (data.additives) {\n      const fragranceRows = document.getElementById('fragranceRows');\n      if (fragranceRows && SoapTool.fragrances?.buildFragranceRow) {\n        fragranceRows.innerHTML = '';\n        const fragrances = Array.isArray(data.additives.fragrances) && data.additives.fragrances.length\n          ? data.additives.fragrances\n          : null;\n        if (fragrances) {\n          fragrances.forEach(item => {\n            const row = SoapTool.fragrances.buildFragranceRow();\n            row.querySelector('.fragrance-typeahead').value = item.name || '';\n            row.querySelector('.fragrance-grams').value = item.grams || '';\n            row.querySelector('.fragrance-percent').value = item.percent || '';\n            row.querySelector('.fragrance-gi-id').value = item.gi || '';\n            const unitEl = row.querySelector('.fragrance-default-unit');\n            if (unitEl) unitEl.value = item.defaultUnit || '';\n            const categoryEl = row.querySelector('.fragrance-category');\n            if (categoryEl) categoryEl.value = item.categoryName || '';\n            fragranceRows.appendChild(row);\n          });\n        } else if (data.additives.fragrance_pct || data.additives.fragrance_name || data.additives.fragrance_gi) {\n          const row = SoapTool.fragrances.buildFragranceRow();\n          row.querySelector('.fragrance-typeahead').value = data.additives.fragrance_name || '';\n          row.querySelector('.fragrance-percent').value = data.additives.fragrance_pct || '3';\n          row.querySelector('.fragrance-gi-id').value = data.additives.fragrance_gi || '';\n          fragranceRows.appendChild(row);\n        }\n      }\n      document.getElementById('additiveLactatePct').value = data.additives.lactate_pct || '1';\n      const lactateName = document.getElementById('additiveLactateName');\n      if (lactateName) lactateName.value = data.additives.lactate_name || '';\n      const lactateGi = document.getElementById('additiveLactateGi');\n      if (lactateGi) lactateGi.value = data.additives.lactate_gi || '';\n      const lactateUnit = document.getElementById('additiveLactateUnit');\n      if (lactateUnit) lactateUnit.value = data.additives.lactate_unit || '';\n      const lactateCategory = document.getElementById('additiveLactateCategory');\n      if (lactateCategory) lactateCategory.value = data.additives.lactate_category || '';\n      document.getElementById('additiveSugarPct').value = data.additives.sugar_pct || '1';\n      const sugarName = document.getElementById('additiveSugarName');\n      if (sugarName) sugarName.value = data.additives.sugar_name || '';\n      const sugarGi = document.getElementById('additiveSugarGi');\n      if (sugarGi) sugarGi.value = data.additives.sugar_gi || '';\n      const sugarUnit = document.getElementById('additiveSugarUnit');\n      if (sugarUnit) sugarUnit.value = data.additives.sugar_unit || '';\n      const sugarCategory = document.getElementById('additiveSugarCategory');\n      if (sugarCategory) sugarCategory.value = data.additives.sugar_category || '';\n      document.getElementById('additiveSaltPct').value = data.additives.salt_pct || '0.5';\n      const saltName = document.getElementById('additiveSaltName');\n      if (saltName) saltName.value = data.additives.salt_name || '';\n      const saltGi = document.getElementById('additiveSaltGi');\n      if (saltGi) saltGi.value = data.additives.salt_gi || '';\n      const saltUnit = document.getElementById('additiveSaltUnit');\n      if (saltUnit) saltUnit.value = data.additives.salt_unit || '';\n      const saltCategory = document.getElementById('additiveSaltCategory');\n      if (saltCategory) saltCategory.value = data.additives.salt_category || '';\n      document.getElementById('additiveCitricPct').value = data.additives.citric_pct || '0';\n      const citricName = document.getElementById('additiveCitricName');\n      if (citricName) citricName.value = data.additives.citric_name || '';\n      const citricGi = document.getElementById('additiveCitricGi');\n      if (citricGi) citricGi.value = data.additives.citric_gi || '';\n      const citricUnit = document.getElementById('additiveCitricUnit');\n      if (citricUnit) citricUnit.value = data.additives.citric_unit || '';\n      const citricCategory = document.getElementById('additiveCitricCategory');\n      if (citricCategory) citricCategory.value = data.additives.citric_category || '';\n    }\n\n    if (data.mold) {\n      document.getElementById('moldWaterWeight').value = data.mold.water_weight || '';\n      document.getElementById('moldOilPct').value = data.mold.oil_pct || '65';\n      const moldShape = document.getElementById('moldShape');\n      if (moldShape) moldShape.value = data.mold.shape || 'loaf';\n      const cylCorrection = document.getElementById('moldCylinderCorrection');\n      if (cylCorrection) cylCorrection.checked = !!data.mold.cylinder_correction;\n      const cylFactor = document.getElementById('moldCylinderFactor');\n      if (cylFactor) cylFactor.value = data.mold.cylinder_factor || '0.85';\n      const targetInput = document.getElementById('oilTotalTarget');\n      if (SoapTool.mold?.syncMoldPctFromTarget && SoapTool.mold?.syncTargetFromMold) {\n        const restoredTarget = SoapTool.units.toGrams(targetInput?.value);\n        if (restoredTarget > 0) {\n          SoapTool.mold.syncMoldPctFromTarget();\n        } else {\n          SoapTool.mold.syncTargetFromMold();\n        }\n      }\n    }\n    if (data.quality) {\n      const preset = document.getElementById('qualityPreset');\n      if (preset) {\n        const desired = data.quality.preset || 'balanced';\n        const option = Array.from(preset.options).find(opt => opt.value === desired);\n        preset.value = option ? desired : 'balanced';\n      }\n      document.querySelectorAll('.quality-focus').forEach(el => {\n        el.checked = Array.isArray(data.quality.focus) && data.quality.focus.includes(el.id);\n      });\n    }\n\n    function restoreLines(wrapperId, items, kind){\n      const wrapper = document.getElementById(wrapperId);\n      if (!wrapper) return;\n      wrapper.innerHTML = '';\n      (items || []).forEach(item => {\n        const row = SoapTool.runner.buildLineRow(kind);\n        const input = row.querySelector('.tool-typeahead');\n        const giHidden = row.querySelector('.tool-gi-id');\n        const qtyEl = row.querySelector('.tool-qty');\n        const unitEl = row.querySelector('.tool-unit');\n        if (input) input.value = item.name || '';\n        if (giHidden) giHidden.value = item.global_item_id || '';\n        if (qtyEl && item.quantity !== undefined && item.quantity !== null) qtyEl.value = item.quantity;\n        if (unitEl && item.unit) {\n          const option = Array.from(unitEl.options).find(opt => opt.value === item.unit);\n          if (option) unitEl.value = item.unit;\n        }\n        wrapper.appendChild(row);\n      });\n    }\n\n    if (data.lines) {\n      restoreLines('tool-ingredients', data.lines.ingredients, 'ingredient');\n      restoreLines('tool-consumables', data.lines.consumables, 'consumable');\n      restoreLines('tool-containers', data.lines.containers, 'container');\n    }\n    if (SoapTool.bulkOilsModal && typeof SoapTool.bulkOilsModal.restoreState === 'function') {\n      SoapTool.bulkOilsModal.restoreState(data.bulk_oils || null);\n    }\n\n    SoapTool.runner.setWaterMethod();\n    SoapTool.mold.updateMoldShapeUI();\n    SoapTool.quality.updateQualityTargets();\n    SoapTool.oils.updateOilTotals();\n    SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n    SoapTool.mold.updateMoldSuggested();\n    SoapTool.runner.calculateAll({ consumeQuota: false, showAlerts: false });\n    if (data.updated_at) {\n      const lastSaved = document.getElementById('soapLastSaved');\n      if (lastSaved) lastSaved.textContent = formatTime(data.updated_at);\n    }\n    SoapTool.stages.updateStageStatuses();\n    SoapTool.ui.showSoapAlert('info', 'Restored your last soap tool session from this device.', { dismissible: true, timeoutMs: 5000 });\n  }\n\n  let saveStateTimer = null;\n  function queueStateSave(){\n    if (saveStateTimer) clearTimeout(saveStateTimer);\n    saveStateTimer = setTimeout(saveState, 350);\n  }\n\n  let autoCalcTimer = null;\n  function queueAutoCalc(){\n    if (autoCalcTimer) clearTimeout(autoCalcTimer);\n    autoCalcTimer = setTimeout(() => {\n      SoapTool.runner.calculateAll({ consumeQuota: false, showAlerts: false });\n    }, 350);\n  }\n\n  SoapTool.storage = {\n    saveState,\n    restoreState,\n    serializeLines,\n    serializeOils,\n    restoreOilRow,\n    queueStateSave,\n    queueAutoCalc,\n  };\n})(window);\n", "(function(window){\n  'use strict';\n\n  const SoapTool = window.SoapTool = window.SoapTool || {};\n  const { LACTATE_CATEGORY_SET, SUGAR_CATEGORY_SET, SALT_CATEGORY_SET, CITRIC_CATEGORY_SET } = SoapTool.constants;\n  const { round, toNumber, clamp } = SoapTool.helpers;\n  const { formatWeight, formatPercent, toGrams } = SoapTool.units;\n  const state = SoapTool.state;\n\n  async function getCalcForExport(){\n    const calc = state.lastCalc || await SoapTool.runner.calculateAll({ consumeQuota: false, showAlerts: true });\n    if (!calc) {\n      if (SoapTool.ui?.showSoapAlert) {\n        SoapTool.ui.showSoapAlert('warning', 'Run a calculation before exporting or printing.', { dismissible: true, timeoutMs: 6000 });\n      }\n      return null;\n    }\n    return calc;\n  }\n\n  function collectFragranceExportRows(totalOils){\n    const rows = [];\n    document.querySelectorAll('#fragranceRows .fragrance-row').forEach(row => {\n      const name = row.querySelector('.fragrance-typeahead')?.value?.trim();\n      const gramsInput = row.querySelector('.fragrance-grams')?.value;\n      const pctInput = row.querySelector('.fragrance-percent')?.value;\n      let grams = toGrams(gramsInput);\n      let pct = clamp(toNumber(pctInput), 0);\n      if (grams <= 0 && pct > 0 && totalOils > 0) {\n        grams = totalOils * (pct / 100);\n      }\n      if (grams <= 0 && pct <= 0 && !name) return;\n      if (!pct && grams > 0 && totalOils > 0) {\n        pct = (grams / totalOils) * 100;\n      }\n      rows.push({\n        name: name || 'Fragrance/Essential Oils',\n        grams,\n        pct,\n      });\n    });\n    return rows;\n  }\n\n  function collectAdditiveExportRows(additives){\n    const rows = [];\n    if (!additives) return rows;\n    const lactateName = document.getElementById('additiveLactateName')?.value?.trim() || 'Sodium Lactate';\n    const sugarName = document.getElementById('additiveSugarName')?.value?.trim() || 'Sugar';\n    const saltName = document.getElementById('additiveSaltName')?.value?.trim() || 'Salt';\n    const citricName = document.getElementById('additiveCitricName')?.value?.trim() || 'Citric Acid';\n    if (additives.lactateG > 0) {\n      rows.push({ name: lactateName, grams: additives.lactateG, pct: additives.lactatePct });\n    }\n    if (additives.sugarG > 0) {\n      rows.push({ name: sugarName, grams: additives.sugarG, pct: additives.sugarPct });\n    }\n    if (additives.saltG > 0) {\n      rows.push({ name: saltName, grams: additives.saltG, pct: additives.saltPct });\n    }\n    if (additives.citricG > 0) {\n      rows.push({ name: citricName, grams: additives.citricG, pct: additives.citricPct });\n    }\n    return rows;\n  }\n\n  function buildFormulaCsv(calc){\n    if (Array.isArray(calc?.export?.csv_rows) && calc.export.csv_rows.length) {\n      return calc.export.csv_rows;\n    }\n    const totalOils = calc.totalOils || 0;\n    const rows = [['section', 'name', 'quantity', 'unit', 'percent']];\n    rows.push(['Summary', 'Lye Type', calc.lyeType || '', '', '']);\n    rows.push(['Summary', 'Superfat', round(calc.superfat || 0, 2), '%', '']);\n    rows.push(['Summary', 'Lye Purity', round(calc.purity || 0, 1), '%', '']);\n    rows.push(['Summary', 'Water Method', calc.waterMethod || '', '', '']);\n    rows.push(['Summary', 'Water %', round(calc.waterPct || 0, 1), '%', '']);\n    rows.push(['Summary', 'Lye Concentration', round(calc.lyeConcentration || 0, 1), '%', '']);\n    rows.push(['Summary', 'Water Ratio', round(calc.waterRatio || 0, 2), '', '']);\n    rows.push(['Summary', 'Total Oils', round(totalOils, 2), 'gram', '']);\n    rows.push(['Summary', 'Batch Yield', round(calc.batchYield || 0, 2), 'gram', '']);\n\n    (calc.oils || []).forEach(oil => {\n      const pct = totalOils > 0 ? round((oil.grams / totalOils) * 100, 2) : '';\n      rows.push(['Oils', oil.name || 'Oil', round(oil.grams || 0, 2), 'gram', pct]);\n    });\n    if (calc.lyeAdjusted > 0) {\n      rows.push(['Lye', calc.lyeType === 'KOH' ? 'Potassium Hydroxide (KOH)' : 'Sodium Hydroxide (NaOH)', round(calc.lyeAdjusted, 2), 'gram', '']);\n    }\n    if (calc.water > 0) {\n      rows.push(['Water', 'Distilled Water', round(calc.water, 2), 'gram', '']);\n    }\n    const fragrances = collectFragranceExportRows(totalOils);\n    fragrances.forEach(row => {\n      rows.push(['Fragrance', row.name, round(row.grams || 0, 2), 'gram', round(row.pct || 0, 2)]);\n    });\n    const additiveRows = collectAdditiveExportRows(calc.additives);\n    additiveRows.forEach(row => {\n      rows.push(['Additives', row.name, round(row.grams || 0, 2), 'gram', round(row.pct || 0, 2)]);\n    });\n    if (calc.additives?.citricLyeG > 0) {\n      rows.push(['Additives', 'Extra Lye for Citric Acid', round(calc.additives.citricLyeG, 2), 'gram', '']);\n    }\n    return rows;\n  }\n\n  function csvEscape(value){\n    if (value === null || value === undefined) return '';\n    const str = String(value);\n    if (/[\",\\n]/.test(str)) {\n      return `\"${str.replace(/\"/g, '\"\"')}\"`;\n    }\n    return str;\n  }\n\n  function buildCsvString(rows){\n    return rows.map(row => row.map(csvEscape).join(',')).join('\\n');\n  }\n\n  function triggerCsvDownload(csvText, filename){\n    const blob = new Blob([csvText], { type: 'text/csv;charset=utf-8;' });\n    const url = URL.createObjectURL(blob);\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = filename;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n  }\n\n  function buildPrintSheet(calc){\n    if (typeof calc?.export?.sheet_html === 'string' && calc.export.sheet_html.trim()) {\n      return calc.export.sheet_html;\n    }\n    const totalOils = calc.totalOils || 0;\n    const oils = (calc.oils || []).map(oil => ({\n      name: oil.name || 'Oil',\n      grams: oil.grams || 0,\n      pct: totalOils > 0 ? (oil.grams / totalOils) * 100 : 0,\n    }));\n    const fragrances = collectFragranceExportRows(totalOils);\n    const additives = collectAdditiveExportRows(calc.additives);\n    const now = new Date().toLocaleString();\n    const oilRows = oils.length\n      ? oils.map(oil => `\n          <tr>\n            <td>${oil.name}</td>\n            <td class=\"text-end\">${formatWeight(oil.grams)}</td>\n            <td class=\"text-end\">${formatPercent(oil.pct)}</td>\n          </tr>`).join('')\n      : '<tr><td colspan=\"3\" class=\"text-muted\">No oils added.</td></tr>';\n    const fragranceRows = fragrances.length\n      ? fragrances.map(item => `\n          <tr>\n            <td>${item.name}</td>\n            <td class=\"text-end\">${formatWeight(item.grams)}</td>\n            <td class=\"text-end\">${formatPercent(item.pct)}</td>\n          </tr>`).join('')\n      : '<tr><td colspan=\"3\" class=\"text-muted\">No fragrances added.</td></tr>';\n    const additiveRows = additives.length\n      ? additives.map(item => `\n          <tr>\n            <td>${item.name}</td>\n            <td class=\"text-end\">${formatWeight(item.grams)}</td>\n            <td class=\"text-end\">${formatPercent(item.pct)}</td>\n          </tr>`).join('')\n      : '<tr><td colspan=\"3\" class=\"text-muted\">No additives added.</td></tr>';\n    const lyeLabel = calc.lyeType === 'KOH' ? 'Potassium Hydroxide (KOH)' : 'Sodium Hydroxide (NaOH)';\n    const extraLyeRow = calc.additives?.citricLyeG > 0\n      ? `<tr><td>Extra Lye for Citric Acid</td><td class=\"text-end\">${formatWeight(calc.additives.citricLyeG)}</td></tr>`\n      : '';\n\n    return `<!doctype html>\n<html>\n  <head>\n    <meta charset=\"utf-8\">\n    <title>Soap Formula Sheet</title>\n    <style>\n      body { font-family: Arial, sans-serif; color: #111; margin: 24px; }\n      h1 { font-size: 20px; margin-bottom: 4px; }\n      h2 { font-size: 16px; margin-top: 20px; }\n      .meta { font-size: 12px; color: #555; margin-bottom: 12px; }\n      table { width: 100%; border-collapse: collapse; margin-top: 8px; }\n      th, td { border: 1px solid #ddd; padding: 6px 8px; font-size: 12px; }\n      th { background: #f3f4f6; text-align: left; }\n      .text-end { text-align: right; }\n      .summary-grid { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: 6px 16px; font-size: 12px; }\n      .summary-item { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 4px 0; }\n      .text-muted { color: #666; }\n    </style>\n  </head>\n  <body>\n    <h1>Soap Formula Sheet</h1>\n    <div class=\"meta\">Generated ${now}</div>\n    <div class=\"summary-grid\">\n      <div class=\"summary-item\"><span>Lye type</span><span>${calc.lyeType || '--'}</span></div>\n      <div class=\"summary-item\"><span>Superfat</span><span>${formatPercent(calc.superfat || 0)}</span></div>\n      <div class=\"summary-item\"><span>Lye purity</span><span>${formatPercent(calc.purity || 0)}</span></div>\n      <div class=\"summary-item\"><span>Total oils</span><span>${formatWeight(totalOils)}</span></div>\n      <div class=\"summary-item\"><span>Water</span><span>${formatWeight(calc.water || 0)}</span></div>\n      <div class=\"summary-item\"><span>Batch yield</span><span>${formatWeight(calc.batchYield || 0)}</span></div>\n      <div class=\"summary-item\"><span>Water method</span><span>${calc.waterMethod || '--'}</span></div>\n      <div class=\"summary-item\"><span>Lye concentration</span><span>${formatPercent(calc.lyeConcentration || 0)}</span></div>\n    </div>\n\n    <h2>Oils</h2>\n    <table>\n      <thead>\n        <tr><th>Oil</th><th class=\"text-end\">Weight</th><th class=\"text-end\">Percent</th></tr>\n      </thead>\n      <tbody>${oilRows}</tbody>\n    </table>\n\n    <h2>Lye & Water</h2>\n    <table>\n      <thead>\n        <tr><th>Item</th><th class=\"text-end\">Weight</th></tr>\n      </thead>\n      <tbody>\n        <tr><td>${lyeLabel}</td><td class=\"text-end\">${formatWeight(calc.lyeAdjusted || 0)}</td></tr>\n        <tr><td>Distilled Water</td><td class=\"text-end\">${formatWeight(calc.water || 0)}</td></tr>\n        ${extraLyeRow}\n      </tbody>\n    </table>\n\n    <h2>Fragrance & Essential Oils</h2>\n    <table>\n      <thead>\n        <tr><th>Fragrance</th><th class=\"text-end\">Weight</th><th class=\"text-end\">Percent</th></tr>\n      </thead>\n      <tbody>${fragranceRows}</tbody>\n    </table>\n\n    <h2>Additives</h2>\n    <table>\n      <thead>\n        <tr><th>Additive</th><th class=\"text-end\">Weight</th><th class=\"text-end\">Percent</th></tr>\n      </thead>\n      <tbody>${additiveRows}</tbody>\n    </table>\n  </body>\n</html>`;\n  }\n\n  const oilRows = document.getElementById('oilRows');\n  const addOilBtn = document.getElementById('addOil');\n  const normalizeOilsBtn = document.getElementById('normalizeOils');\n  if (addOilBtn && oilRows) {\n    addOilBtn.dataset.bound = 'direct';\n    addOilBtn.addEventListener('click', function(){\n      oilRows.appendChild(SoapTool.oils.buildOilRow());\n      SoapTool.stages.updateStageStatuses();\n      SoapTool.storage.queueStateSave();\n    });\n  }\n  if (normalizeOilsBtn) {\n    normalizeOilsBtn.dataset.bound = 'direct';\n    normalizeOilsBtn.addEventListener('click', function(){\n      SoapTool.oils.normalizeOils();\n      SoapTool.stages.updateStageStatuses();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n\n  if (oilRows) oilRows.addEventListener('input', function(e){\n    if (e.target.classList.contains('oil-grams')) {\n      state.lastOilEdit = { row: e.target.closest('.oil-row'), field: 'grams' };\n    }\n    if (e.target.classList.contains('oil-percent')) {\n      state.lastOilEdit = { row: e.target.closest('.oil-row'), field: 'percent' };\n    }\n    if (e.target.classList.contains('oil-grams')\n      || e.target.classList.contains('oil-percent')\n      || e.target.classList.contains('oil-typeahead')) {\n      if (e.target.classList.contains('oil-typeahead')) {\n        SoapTool.oils.setSelectedOilProfileFromRow(e.target.closest('.oil-row'));\n      }\n      SoapTool.oils.updateOilTotals();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    }\n  });\n\n  if (oilRows) oilRows.addEventListener('focusin', function(e){\n    if (e.target.classList.contains('oil-typeahead')) {\n      SoapTool.oils.setSelectedOilProfileFromRow(e.target.closest('.oil-row'));\n    }\n  });\n\n  if (oilRows) oilRows.addEventListener('focusout', function(e){\n    if (e.target.classList.contains('oil-typeahead')) {\n      SoapTool.oils.clearSelectedOilProfile();\n    }\n    if (e.target.classList.contains('oil-grams')) {\n      SoapTool.oils.validateOilEntry(e.target.closest('.oil-row'), 'grams');\n    }\n    if (e.target.classList.contains('oil-percent')) {\n      SoapTool.oils.validateOilEntry(e.target.closest('.oil-row'), 'percent');\n    }\n  });\n\n  if (oilRows) oilRows.addEventListener('keydown', function(e){\n    if (e.key !== 'Enter') return;\n    if (e.target.classList.contains('oil-grams')) {\n      e.preventDefault();\n      SoapTool.oils.validateOilEntry(e.target.closest('.oil-row'), 'grams');\n    }\n    if (e.target.classList.contains('oil-percent')) {\n      e.preventDefault();\n      SoapTool.oils.validateOilEntry(e.target.closest('.oil-row'), 'percent');\n    }\n  });\n\n  if (oilRows) oilRows.addEventListener('mouseover', function(e){\n    if (!e.target.classList.contains('oil-typeahead')) return;\n    const row = e.target.closest('.oil-row');\n    if (!row || row === state.lastPreviewRow) return;\n    state.lastPreviewRow = row;\n    SoapTool.oils.setSelectedOilProfileFromRow(row);\n  });\n\n  if (oilRows) oilRows.addEventListener('mouseout', function(e){\n    if (e.target.classList.contains('oil-typeahead')) {\n      SoapTool.oils.clearSelectedOilProfile();\n    }\n  });\n\n  if (oilRows) oilRows.addEventListener('click', function(e){\n    const profileButton = e.target.closest('.oil-profile-open');\n    if (profileButton) {\n      const row = profileButton.closest('.oil-row');\n      if (row) {\n        SoapTool.oils.setSelectedOilProfileFromRow(row);\n        const modalEl = document.getElementById('oilProfileModal');\n        if (modalEl && window.bootstrap) {\n          const modal = bootstrap.Modal.getOrCreateInstance(modalEl);\n          modal.show();\n        }\n      }\n      return;\n    }\n    const removeButton = e.target.closest('.remove-oil');\n    if (removeButton) {\n      const row = removeButton.closest('.oil-row');\n      if (row) {\n        state.lastRemovedOil = SoapTool.oils.serializeOilRow(row);\n        state.lastRemovedOilIndex = Array.from(row.parentElement.children).indexOf(row);\n        SoapTool.ui.showUndoToast('Oil removed.');\n      }\n      if (row && state.lastOilEdit && state.lastOilEdit.row === row) {\n        state.lastOilEdit = null;\n        SoapTool.oils.clearSelectedOilProfile();\n      }\n      if (row) row.remove();\n      SoapTool.oils.updateOilTotals();\n      SoapTool.stages.updateStageStatuses();\n      SoapTool.storage.queueStateSave();\n    }\n  });\n\n  const fragranceRows = document.getElementById('fragranceRows');\n  const addFragranceBtn = document.getElementById('addFragrance');\n  if (addFragranceBtn && fragranceRows) {\n    addFragranceBtn.dataset.bound = 'direct';\n    addFragranceBtn.addEventListener('click', function(){\n      fragranceRows.appendChild(SoapTool.fragrances.buildFragranceRow());\n      SoapTool.fragrances.updateFragranceTotals(SoapTool.oils.getTotalOilsGrams());\n      SoapTool.stages.updateStageStatuses();\n      SoapTool.storage.queueStateSave();\n    });\n  }\n  if (fragranceRows) {\n    fragranceRows.addEventListener('input', function(e){\n      if (e.target.classList.contains('fragrance-grams')) {\n        SoapTool.state.lastFragranceEdit = { row: e.target.closest('.fragrance-row'), field: 'grams' };\n      }\n      if (e.target.classList.contains('fragrance-percent')) {\n        SoapTool.state.lastFragranceEdit = { row: e.target.closest('.fragrance-row'), field: 'percent' };\n      }\n      if (e.target.classList.contains('fragrance-grams')\n        || e.target.classList.contains('fragrance-percent')\n        || e.target.classList.contains('fragrance-typeahead')) {\n        SoapTool.fragrances.updateFragranceTotals(SoapTool.oils.getTotalOilsGrams());\n        SoapTool.stages.updateStageStatuses();\n        SoapTool.storage.queueStateSave();\n        SoapTool.storage.queueAutoCalc();\n      }\n    });\n    fragranceRows.addEventListener('click', function(e){\n      const removeButton = e.target.closest('.remove-fragrance');\n      if (!removeButton) return;\n      const row = removeButton.closest('.fragrance-row');\n      if (row) row.remove();\n      SoapTool.fragrances.updateFragranceTotals(SoapTool.oils.getTotalOilsGrams());\n      SoapTool.stages.updateStageStatuses();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n\n  const stageTabContent = document.getElementById('soapStageTabContent');\n  const getActiveStageScrollContainer = () => {\n    if (!stageTabContent) return null;\n    const activePane = stageTabContent.querySelector('.tab-pane.active') || stageTabContent.querySelector('.tab-pane.show.active');\n    if (!activePane) return null;\n    return activePane.querySelector('.soap-stage-body') || activePane;\n  };\n  const bindStageWheelGuard = () => {\n    if (!stageTabContent) return;\n    stageTabContent.addEventListener('wheel', event => {\n      const target = event.target;\n      if (!(target instanceof HTMLElement)) return;\n      const numberInput = target.closest('input[type=\"number\"]');\n      if (!(numberInput instanceof HTMLInputElement)) return;\n      const scrollContainer = getActiveStageScrollContainer();\n      if (!(scrollContainer instanceof HTMLElement)) return;\n      if (scrollContainer.scrollHeight <= scrollContainer.clientHeight + 1) return;\n      if (document.activeElement === numberInput && typeof numberInput.blur === 'function') {\n        numberInput.blur();\n      }\n      const atTop = scrollContainer.scrollTop <= 0;\n      const atBottom = (\n        scrollContainer.scrollTop + scrollContainer.clientHeight\n      ) >= (scrollContainer.scrollHeight - 1);\n      if ((event.deltaY < 0 && atTop) || (event.deltaY > 0 && atBottom)) {\n        return;\n      }\n      scrollContainer.scrollTop += event.deltaY;\n      event.preventDefault();\n    }, { passive: false });\n  };\n  if (stageTabContent) {\n    stageTabContent.addEventListener('click', event => {\n      const actionBtn = event.target.closest('[data-stage-action]');\n      const soapActionBtn = event.target.closest('[data-soap-action]');\n      if (!actionBtn && !soapActionBtn) return;\n      event.preventDefault();\n      event.stopPropagation();\n      if (document.activeElement && typeof document.activeElement.blur === 'function') {\n        document.activeElement.blur();\n      }\n      if (soapActionBtn) {\n        if (soapActionBtn.dataset.bound === 'direct') return;\n        const action = soapActionBtn.dataset.soapAction;\n        if (action === 'add-oil' && oilRows) {\n          oilRows.appendChild(SoapTool.oils.buildOilRow());\n          SoapTool.stages.updateStageStatuses();\n          SoapTool.storage.queueStateSave();\n        }\n        if (action === 'normalize-oils') {\n          SoapTool.oils.normalizeOils();\n          SoapTool.stages.updateStageStatuses();\n          SoapTool.storage.queueStateSave();\n          SoapTool.storage.queueAutoCalc();\n        }\n        if (action === 'add-fragrance' && fragranceRows) {\n          fragranceRows.appendChild(SoapTool.fragrances.buildFragranceRow());\n          SoapTool.fragrances.updateFragranceTotals(SoapTool.oils.getTotalOilsGrams());\n          SoapTool.stages.updateStageStatuses();\n          SoapTool.storage.queueStateSave();\n        }\n        return;\n      }\n      const action = actionBtn.dataset.stageAction;\n      const index = Number(actionBtn.dataset.stageIndex);\n      if (Number.isNaN(index)) return;\n      if (action === 'prev') SoapTool.stages.openStageByIndex(Math.max(0, index - 1));\n      if (action === 'next') SoapTool.stages.openStageByIndex(Math.min(SoapTool.constants.STAGE_CONFIGS.length - 1, index + 1));\n      if (action === 'reset') SoapTool.stages.resetStage(index + 1);\n    });\n    bindStageWheelGuard();\n  }\n  const stageTabList = document.getElementById('soapStageTabList');\n  const updateStageTabSizing = () => {\n    if (!stageTabList) return;\n    stageTabList.querySelectorAll('.nav-item').forEach(item => item.classList.remove('is-expanded'));\n    const active = stageTabList.querySelector('.nav-link.active');\n    if (active && active.closest('.nav-item')) {\n      active.closest('.nav-item').classList.add('is-expanded');\n    }\n  };\n  if (stageTabList) {\n    stageTabList.addEventListener('shown.bs.tab', () => {\n      updateStageTabSizing();\n      SoapTool.layout.scheduleStageHeightSync();\n    });\n    updateStageTabSizing();\n  }\n\n  const resultsToggle = document.getElementById('resultsCardToggle');\n  const resultsCard = document.getElementById('resultsCard');\n  if (resultsToggle && resultsCard) {\n    resultsToggle.addEventListener('click', () => {\n      resultsCard.classList.toggle('is-collapsed');\n      const isCollapsed = resultsCard.classList.contains('is-collapsed');\n      resultsToggle.setAttribute('aria-expanded', (!isCollapsed).toString());\n      const label = isCollapsed ? 'Expand formula details' : 'Collapse formula details';\n      resultsToggle.setAttribute('aria-label', label);\n      resultsToggle.setAttribute('title', label);\n      const icon = resultsToggle.querySelector('i');\n      if (icon) {\n        icon.classList.toggle('fa-chevron-down', isCollapsed);\n        icon.classList.toggle('fa-chevron-up', !isCollapsed);\n      }\n    });\n  }\n\n  document.querySelectorAll('input[name=\"weight_unit\"]').forEach(el => {\n    el.addEventListener('change', function(){\n      SoapTool.units.setUnit(this.value);\n      SoapTool.storage.queueStateSave();\n    });\n  });\n\n  const rescaleOilsFromStageOne = () => {\n    SoapTool.oils.scaleOilsToTarget(undefined, { force: true });\n    SoapTool.oils.updateOilTotals();\n    if (SoapTool.mold?.updateWetBatterWarning) {\n      SoapTool.mold.updateWetBatterWarning(null);\n    }\n  };\n\n  const oilTotalTarget = document.getElementById('oilTotalTarget');\n  if (oilTotalTarget) {\n    oilTotalTarget.addEventListener('input', function(){\n      SoapTool.mold.syncMoldPctFromTarget();\n      rescaleOilsFromStageOne();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n\n  const waterMethod = document.getElementById('waterMethod');\n  if (waterMethod) {\n    waterMethod.addEventListener('change', function(){\n      SoapTool.runner.setWaterMethod();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n\n  document.querySelectorAll('input[name=\"lye_type\"]').forEach(el => {\n    el.addEventListener('change', function(){\n      SoapTool.runner.applyLyeSelection();\n      SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  });\n\n  ['lyeSuperfat', 'lyePurity', 'waterPct', 'lyeConcentration', 'waterRatio'].forEach(id => {\n    const el = document.getElementById(id);\n    if (!el) return;\n    ['input', 'change'].forEach(eventName => {\n      el.addEventListener(eventName, () => {\n        SoapTool.storage.queueStateSave();\n        SoapTool.storage.queueAutoCalc();\n      });\n    });\n  });\n\n  ['additiveLactatePct', 'additiveSugarPct', 'additiveSaltPct', 'additiveCitricPct']\n    .forEach(id => {\n      const el = document.getElementById(id);\n      if (el) el.addEventListener('input', () => {\n        SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n        SoapTool.stages.updateStageStatuses();\n        SoapTool.storage.queueStateSave();\n        SoapTool.storage.queueAutoCalc();\n      });\n    });\n  const additiveWeights = [\n    { weightId: 'additiveLactateWeight' },\n    { weightId: 'additiveSugarWeight' },\n    { weightId: 'additiveSaltWeight' },\n    { weightId: 'additiveCitricWeight' },\n  ];\n  additiveWeights.forEach(({ weightId }) => {\n    const weightInput = document.getElementById(weightId);\n    if (!weightInput) return;\n    weightInput.addEventListener('input', () => {\n      const totalOils = SoapTool.oils.getTotalOilsGrams();\n      if (!totalOils) return;\n      SoapTool.additives.updateAdditivesOutput(totalOils);\n      SoapTool.stages.updateStageStatuses();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  });\n\n  document.querySelectorAll('.additive-typeahead').forEach(input => {\n    input.addEventListener('input', () => {\n      SoapTool.storage.queueStateSave();\n    });\n  });\n\n  const qualityPreset = document.getElementById('qualityPreset');\n  if (qualityPreset) {\n    qualityPreset.addEventListener('change', function(){\n      SoapTool.quality.updateQualityTargets();\n      SoapTool.storage.queueStateSave();\n    });\n  }\n  document.querySelectorAll('.quality-focus').forEach(el => {\n    el.addEventListener('change', function(){\n      SoapTool.quality.updateQualityTargets();\n      SoapTool.storage.queueStateSave();\n    });\n  });\n  const applyQualityBtn = document.getElementById('applyQualityTargets');\n  if (applyQualityBtn) {\n    applyQualityBtn.addEventListener('click', function(){\n      SoapTool.quality.applyQualityTargets();\n    });\n  }\n  document.querySelectorAll('.quality-target-marker').forEach(marker => {\n    marker.addEventListener('click', () => SoapTool.quality.applyQualityTargets());\n    marker.addEventListener('keydown', event => {\n      if (event.key === 'Enter' || event.key === ' ') {\n        event.preventDefault();\n        SoapTool.quality.applyQualityTargets();\n      }\n    });\n  });\n\n  const moldWaterWeight = document.getElementById('moldWaterWeight');\n  if (moldWaterWeight) {\n    moldWaterWeight.addEventListener('input', function(){\n      SoapTool.mold.syncTargetFromMold();\n      rescaleOilsFromStageOne();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n  const moldOilPct = document.getElementById('moldOilPct');\n  if (moldOilPct) {\n    moldOilPct.addEventListener('input', function(){\n      SoapTool.mold.syncTargetFromMold();\n      rescaleOilsFromStageOne();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n  const moldShape = document.getElementById('moldShape');\n  if (moldShape) {\n    moldShape.addEventListener('change', function(){\n      SoapTool.mold.updateMoldShapeUI();\n      SoapTool.mold.syncTargetFromMold();\n      rescaleOilsFromStageOne();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n  const moldCylinderCorrection = document.getElementById('moldCylinderCorrection');\n  if (moldCylinderCorrection) {\n    moldCylinderCorrection.addEventListener('change', function(){\n      SoapTool.mold.syncTargetFromMold();\n      rescaleOilsFromStageOne();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n  const moldCylinderFactor = document.getElementById('moldCylinderFactor');\n  if (moldCylinderFactor) {\n    moldCylinderFactor.addEventListener('input', function(){\n      SoapTool.mold.syncTargetFromMold();\n      rescaleOilsFromStageOne();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n\n  document.querySelectorAll('.stub-btn').forEach(btn => {\n    btn.addEventListener('click', function(){\n      const kind = this.dataset.stubKind;\n      const name = this.dataset.stubName;\n      SoapTool.runner.addStubLine(kind, name);\n      SoapTool.storage.queueStateSave();\n    });\n  });\n\n  const soapRoot = document.getElementById('soapToolPage');\n  if (soapRoot) {\n    soapRoot.addEventListener('click', function(e){\n      if (e.target.classList.contains('tool-remove')) {\n        SoapTool.storage.queueStateSave();\n      }\n    });\n    soapRoot.addEventListener('input', function(e){\n      if (e.target.matches('input, select, textarea')) {\n        SoapTool.storage.queueStateSave();\n        SoapTool.ui.validateNumericField(e.target);\n        SoapTool.stages.updateStageStatuses();\n        SoapTool.ui.flashStage(e.target.closest('.soap-stage-card'));\n      }\n    });\n    soapRoot.addEventListener('change', function(e){\n      if (e.target.matches('input, select, textarea')) {\n        SoapTool.storage.queueStateSave();\n        SoapTool.ui.validateNumericField(e.target);\n        SoapTool.stages.updateStageStatuses();\n      }\n    });\n  }\n\n  const addToolIngredient = document.getElementById('addToolIngredient');\n  if (addToolIngredient) {\n    addToolIngredient.addEventListener('click', function(){\n      const wrapper = document.getElementById('tool-ingredients');\n      if (wrapper) wrapper.appendChild(SoapTool.runner.buildLineRow('ingredient'));\n      SoapTool.storage.queueStateSave();\n    });\n  }\n  const addToolConsumable = document.getElementById('addToolConsumable');\n  if (addToolConsumable) {\n    addToolConsumable.addEventListener('click', function(){\n      const wrapper = document.getElementById('tool-consumables');\n      if (wrapper) wrapper.appendChild(SoapTool.runner.buildLineRow('consumable'));\n      SoapTool.storage.queueStateSave();\n    });\n  }\n  const addToolContainer = document.getElementById('addToolContainer');\n  if (addToolContainer) {\n    addToolContainer.addEventListener('click', function(){\n      const wrapper = document.getElementById('tool-containers');\n      if (wrapper) wrapper.appendChild(SoapTool.runner.buildLineRow('container'));\n      SoapTool.storage.queueStateSave();\n    });\n  }\n\n  const calcLyeBtn = document.getElementById('calcLyeBtn');\n  if (calcLyeBtn) {\n    calcLyeBtn.addEventListener('click', async function(){\n      await SoapTool.runner.calculateAll({ consumeQuota: true, showAlerts: true });\n      SoapTool.storage.queueStateSave();\n    });\n  }\n\n  const saveSoapToolBtn = document.getElementById('saveSoapTool');\n  if (saveSoapToolBtn) {\n    saveSoapToolBtn.addEventListener('click', async function(){\n      try {\n        const calc = state.lastCalc || await SoapTool.runner.calculateAll({ consumeQuota: false, showAlerts: true });\n        if (!calc) return;\n        const payload = SoapTool.runner.buildSoapRecipePayload(calc);\n        state.lastRecipePayload = payload;\n        try {\n          const storage = SoapTool.helpers.getStorage();\n          if (storage) {\n            storage.setItem('soap_recipe_payload', JSON.stringify(payload));\n          }\n        } catch (_) {}\n        window.SOAP_RECIPE_DTO = payload;\n        SoapTool.ui.showSoapAlert('info', 'Recipe payload is ready. Push is stubbed for now; no data has been sent.', { dismissible: true, timeoutMs: 7000 });\n      } catch(_) {\n        SoapTool.ui.showSoapAlert('danger', 'Unable to prepare the recipe payload. Please try again.', { dismissible: true, persist: true });\n      }\n    });\n  }\n\n  const exportSoapCsvBtn = document.getElementById('exportSoapCsv');\n  if (exportSoapCsvBtn) {\n    exportSoapCsvBtn.addEventListener('click', async function(){\n      const calc = await getCalcForExport();\n      if (!calc) return;\n      const rows = buildFormulaCsv(calc);\n      const csvText = (typeof calc?.export?.csv_text === 'string' && calc.export.csv_text)\n        ? calc.export.csv_text\n        : buildCsvString(rows);\n      triggerCsvDownload(csvText, 'soap_formula.csv');\n    });\n  }\n\n  const printSoapSheetBtn = document.getElementById('printSoapSheet');\n  if (printSoapSheetBtn) {\n    printSoapSheetBtn.addEventListener('click', async function(){\n      const calc = await getCalcForExport();\n      if (!calc) return;\n      const html = buildPrintSheet(calc);\n      const win = window.open('', '_blank', 'width=960,height=720');\n      if (!win) {\n        if (SoapTool.ui?.showSoapAlert) {\n          SoapTool.ui.showSoapAlert('warning', 'Pop-up blocked. Allow pop-ups to print the sheet.', { dismissible: true, timeoutMs: 6000 });\n        }\n        return;\n      }\n      win.document.open();\n      win.document.write(html);\n      win.document.close();\n      win.focus();\n      win.onload = () => {\n        win.print();\n      };\n    });\n  }\n\n  const undoRemoveBtn = document.getElementById('soapUndoRemove');\n  if (undoRemoveBtn) {\n    undoRemoveBtn.addEventListener('click', () => {\n      if (!state.lastRemovedOil) return;\n      SoapTool.storage.restoreOilRow(state.lastRemovedOil, state.lastRemovedOilIndex || 0);\n      state.lastRemovedOil = null;\n      state.lastRemovedOilIndex = null;\n      SoapTool.oils.updateOilTotals();\n      SoapTool.storage.queueStateSave();\n      SoapTool.storage.queueAutoCalc();\n    });\n  }\n\n  const setupMobileDrawer = () => {\n    const drawer = document.getElementById('soapMobileDrawer');\n    const drawerContent = document.getElementById('soapMobileDrawerContent');\n    const drawerTitle = document.getElementById('soapMobileDrawerTitle');\n    const drawerEmpty = document.getElementById('soapDrawerEmpty');\n    const closeBtn = document.getElementById('soapDrawerClose');\n    const qualityCard = document.getElementById('soapQualityCard');\n    const resultsCard = document.getElementById('resultsCard');\n    if (!drawer || !drawerContent || !drawerTitle || !qualityCard || !resultsCard) return;\n\n    const qualityHome = qualityCard.parentElement;\n    const resultsHome = resultsCard.parentElement;\n    const placeholders = new Map();\n    let currentTarget = null;\n\n    const isSmallScreen = () => window.matchMedia('(max-width: 767px)').matches;\n    const cardForTarget = (target) => (target === 'quality' ? qualityCard : resultsCard);\n    const homeForTarget = (target) => (target === 'quality' ? qualityHome : resultsHome);\n    const titleForTarget = (target) => (target === 'quality' ? 'Display' : 'Results');\n\n    const ensurePlaceholder = (card) => {\n      let placeholder = placeholders.get(card);\n      if (!placeholder) {\n        placeholder = document.createElement('div');\n        placeholder.className = 'soap-card-placeholder';\n        placeholders.set(card, placeholder);\n      }\n      placeholder.style.height = `${card.offsetHeight}px`;\n      if (card.parentElement && card.parentElement !== drawerContent && !placeholder.parentElement) {\n        card.parentElement.insertBefore(placeholder, card);\n      }\n    };\n\n    const moveCardToDrawer = (card) => {\n      if (!card) return;\n      ensurePlaceholder(card);\n      drawerContent.appendChild(card);\n    };\n\n    const restoreCard = (card, home) => {\n      const placeholder = placeholders.get(card);\n      if (placeholder && placeholder.parentElement) {\n        placeholder.replaceWith(card);\n      } else if (home && card.parentElement !== home) {\n        home.appendChild(card);\n      }\n    };\n\n    const updateDrawerEmpty = () => {\n      if (!drawerEmpty) return;\n      const isResults = currentTarget === 'results';\n      const resultsVisible = getComputedStyle(resultsCard).display !== 'none';\n      drawerEmpty.classList.toggle('d-none', !isResults || resultsVisible);\n    };\n\n    const openDrawer = (target) => {\n      if (!isSmallScreen()) return;\n      if (currentTarget && currentTarget !== target) {\n        restoreCard(cardForTarget(currentTarget), homeForTarget(currentTarget));\n      }\n      moveCardToDrawer(cardForTarget(target));\n      drawerTitle.textContent = titleForTarget(target);\n      currentTarget = target;\n      drawer.classList.add('is-open');\n      updateDrawerEmpty();\n    };\n\n    const closeDrawer = () => {\n      if (!currentTarget) return;\n      restoreCard(cardForTarget(currentTarget), homeForTarget(currentTarget));\n      currentTarget = null;\n      drawer.classList.remove('is-open');\n      updateDrawerEmpty();\n    };\n\n    drawer.querySelectorAll('[data-drawer-target]').forEach(btn => {\n      btn.addEventListener('click', () => {\n        const target = btn.dataset.drawerTarget;\n        if (!target) return;\n        if (drawer.classList.contains('is-open') && currentTarget === target) {\n          closeDrawer();\n        } else {\n          openDrawer(target);\n        }\n      });\n    });\n\n    if (closeBtn) {\n      closeBtn.addEventListener('click', closeDrawer);\n    }\n\n    window.addEventListener('resize', () => {\n      if (!isSmallScreen() && currentTarget) {\n        closeDrawer();\n      }\n    });\n\n    const resultsObserver = new MutationObserver(() => updateDrawerEmpty());\n    resultsObserver.observe(resultsCard, { attributes: true, attributeFilter: ['style', 'class'] });\n  };\n\n  setupMobileDrawer();\n  window.addEventListener('resize', SoapTool.layout.scheduleStageHeightSync);\n  window.addEventListener('load', SoapTool.layout.scheduleStageHeightSync);\n\n  SoapTool.additives.attachAdditiveTypeahead('additiveLactateName', 'additiveLactateGi', LACTATE_CATEGORY_SET, 'additiveLactateUnit', 'additiveLactateCategory');\n  SoapTool.additives.attachAdditiveTypeahead('additiveSugarName', 'additiveSugarGi', SUGAR_CATEGORY_SET, 'additiveSugarUnit', 'additiveSugarCategory');\n  SoapTool.additives.attachAdditiveTypeahead('additiveSaltName', 'additiveSaltGi', SALT_CATEGORY_SET, 'additiveSaltUnit', 'additiveSaltCategory');\n  SoapTool.additives.attachAdditiveTypeahead('additiveCitricName', 'additiveCitricGi', CITRIC_CATEGORY_SET, 'additiveCitricUnit', 'additiveCitricCategory');\n  SoapTool.ui.applyHelperVisibility();\n  SoapTool.quality.initQualityTooltips();\n  SoapTool.runner.applyLyeSelection();\n  SoapTool.runner.setWaterMethod();\n  SoapTool.mold.updateMoldShapeUI();\n  SoapTool.quality.setQualityRangeBars();\n  SoapTool.units.updateUnitLabels();\n  SoapTool.quality.updateQualityTargets();\n  SoapTool.additives.updateAdditivesOutput(SoapTool.oils.getTotalOilsGrams());\n  SoapTool.stages.updateStageStatuses();\n  SoapTool.storage.restoreState();\n  if (oilRows && !oilRows.querySelector('.oil-row')) {\n    oilRows.appendChild(SoapTool.oils.buildOilRow());\n  }\n  if (fragranceRows && !fragranceRows.querySelector('.fragrance-row')) {\n    if (SoapTool.fragrances?.buildFragranceRow) {\n      fragranceRows.appendChild(SoapTool.fragrances.buildFragranceRow());\n    }\n  }\n  if (SoapTool.fragrances?.updateFragranceTotals) {\n    SoapTool.fragrances.updateFragranceTotals(SoapTool.oils.getTotalOilsGrams());\n  }\n  SoapTool.layout.scheduleStageHeightSync();\n})(window);\n"],
  "mappings": "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",
  "names": ["window", "window", "buildToolLineRow", "window", "window", "window", "window", "window", "window", "window", "settings", "window", "window", "_a", "window", "window", "window", "window", "window", "pane", "_a", "window", "window", "window", "window", "window", "window", "window", "window", "_a", "window", "_a", "_b", "oilRows", "fragranceRows", "action", "resultsCard"]
}
