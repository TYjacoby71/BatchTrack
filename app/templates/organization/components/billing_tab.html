
<div class="row">
    <div class="col-12">
        <div class="mb-3">
            <h5><i class="fas fa-credit-card"></i> Subscription Management</h5>
            <p class="text-muted">Manage your subscription plan and billing settings</p>
        </div>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0"><i class="fas fa-info-circle"></i> Current Plan</h6>
            </div>
            <div class="card-body">
                <h5 class="text-primary">{{ current_user.organization.effective_subscription_tier.title() }}</h5>
                <p class="text-muted">{{ current_user.organization.active_users_count }}/{{ current_user.organization.get_max_users() }} users</p>
                
                {% if subscription_details and subscription_details.status != 'inactive' %}
                <div class="subscription-info mt-3">
                    <p><strong>Status:</strong> {{ subscription_details.status.title() }}</p>
                    {% if subscription_details.next_billing_date %}
                    <p><strong>Next Billing:</strong> {{ subscription_details.next_billing_date|timestamp_to_date }}</p>
                    {% endif %}
                    {% if subscription_details.amount %}
                    <p><strong>Amount:</strong> ${{ subscription_details.amount }}/{{ subscription_details.interval }}</p>
                    {% endif %}
                    {% if subscription_details.trial_end %}
                    <p><strong>Trial Ends:</strong> {{ subscription_details.trial_end|timestamp_to_date }}</p>
                    {% endif %}
                    {% if subscription_details.cancel_at_period_end %}
                    <p class="text-warning"><strong>Scheduled for cancellation at period end</strong></p>
                    {% endif %}
                </div>
                {% endif %}

                <h6 class="mt-3">Available Features:</h6>
                <ul class="list-unstyled">
                    {% for feature in current_user.organization.get_subscription_features() %}
                    <li><i class="fas fa-check text-success me-2"></i>{{ feature|replace('_', ' ')|title }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card border-primary">
            <div class="card-header bg-primary text-white">
                <h6 class="mb-0"><i class="fas fa-arrow-up"></i> Upgrade Available</h6>
            </div>
            <div class="card-body">
                <p>Unlock more features and users with our premium plans.</p>
                <a href="{{ url_for('billing.upgrade') }}" class="btn btn-light">View All Plans</a>
            </div>
        </div>
    </div>
</div>
