<div class="tab-pane fade show active" id="soapStage1Pane" role="tabpanel" aria-labelledby="soapStage1Tab">
  <div class="soap-stage-body p-3" data-stage-index="0">
    <div class="row g-3 align-items-start soap-stage-form-row soap-config-row soap-stage-grid">
      <div class="col-12 soap-field-stack">
        <label class="form-label">Units</label>
        <div class="btn-group w-100" role="group" aria-label="Weight units">
          <input type="radio" class="btn-check" name="weight_unit" id="unitGrams" value="g" checked>
          <label class="btn btn-outline-secondary" for="unitGrams">g</label>
          <input type="radio" class="btn-check" name="weight_unit" id="unitOunces" value="oz">
          <label class="btn btn-outline-secondary" for="unitOunces">oz</label>
          <input type="radio" class="btn-check" name="weight_unit" id="unitPounds" value="lb">
          <label class="btn btn-outline-secondary" for="unitPounds">lb</label>
        </div>
      </div>
    </div>
    <div class="row g-2 soap-stage-grid mt-2">
      <div class="col-lg-4 col-md-6 soap-field-stack">
        <label class="form-label">Mold water weight</label>
        <div class="soap-input-suffix unit-suffix" data-suffix="g">
          <input type="number" class="form-control" id="moldWaterWeight" step="0.1" placeholder="e.g., 1200">
        </div>
        <div class="form-text">Fill the mold with water and weigh it.</div>
      </div>
      <div class="col-lg-4 col-md-6 soap-field-stack">
        <label class="form-label">Oils of mold</label>
        <div class="soap-input-suffix" data-suffix="%">
          <input type="number" class="form-control" id="moldOilPct" step="0.1" value="65" title="Normal range is 50-80%.">
        </div>
        <div class="form-text soap-stage-note">Normal range is 50-80%.</div>
      </div>
      <div class="col-lg-4 col-md-6 soap-field-stack">
        <label class="form-label">Total oils target</label>
        <div class="soap-input-suffix unit-suffix" data-suffix="g">
          <input type="number" class="form-control" id="oilTotalTarget" step="0.1" placeholder="Auto from mold or enter manually">
        </div>
        <div class="form-text soap-stage-note" id="oilTargetHint">Auto-fills when mold sizing is set.</div>
      </div>
    </div>
    <div class="row g-2 soap-stage-grid mt-1">
      <div class="col-12 soap-field-stack">
        <label class="form-label">Mold shape</label>
        <select class="form-select" id="moldShape">
          <option value="loaf">Loaf / rectangular</option>
          <option value="cylinder">Cylinder / pipe</option>
        </select>
      </div>
      <div class="col-md-8">
        <div class="mt-1 d-none" id="moldCylinderOptions">
          <div class="alert alert-warning small mb-1" id="moldCylinderAlert">
            Cylinder mold selected. Use a correction if you want headspace for pouring or overflow control.
          </div>
          <div class="row g-2 soap-stage-grid">
            <div class="col-md-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="moldCylinderCorrection">
                <label class="form-check-label" for="moldCylinderCorrection">Apply cylinder correction</label>
              </div>
              <div class="form-text soap-stage-note">Use this when you want to leave headspace or avoid spill risk.</div>
            </div>
            <div class="col-lg-6 col-md-12 soap-field-stack">
              <label class="form-label">Cylinder fill factor</label>
              <input type="number" class="form-control" id="moldCylinderFactor" step="0.05" value="0.85">
              <div class="form-text soap-stage-note">0.85 means fill to 85% of measured capacity.</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="small text-muted mt-1" id="moldSuggestionNote">Target oils are capped to the mold size above.</div>
    {% set stage_index = 0 %}
    {% include 'tools/soaps/stages/_stage_actions.html' %}
  </div>
</div>
