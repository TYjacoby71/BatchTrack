<div class="tab-pane fade" id="soapStage3Pane" role="tabpanel" aria-labelledby="soapStage3Tab">
  <div class="soap-stage-body p-3" data-stage-index="2">
    <div class="row g-3 align-items-start soap-stage-form-row soap-config-row soap-stage-grid">
      <div class="col-12 soap-field-stack">
        <label class="form-label">Lye type</label>
        <div class="btn-group w-100" role="group" aria-label="Lye type">
          <input type="radio" class="btn-check" name="lye_type" id="lyeTypeNaoh" value="NaOH" checked>
          <label class="btn btn-outline-secondary" for="lyeTypeNaoh">NaOH</label>
          <input type="radio" class="btn-check" name="lye_type" id="lyeTypeKoh" value="KOH">
          <label class="btn btn-outline-secondary" for="lyeTypeKoh">KOH</label>
          <input type="radio" class="btn-check" name="lye_type" id="lyeTypeKoh90" value="KOH90">
          <label class="btn btn-outline-secondary" for="lyeTypeKoh90">90% KOH</label>
        </div>
      </div>
    </div>
    <div class="row g-2 align-items-start soap-stage-form-row soap-config-row soap-stage-grid mt-2">
      <div class="col-lg-6 col-md-12 soap-field-stack">
        <label class="form-label">Water method</label>
        <select class="form-select" id="waterMethod" name="water_method">
          <option value="percent">Water as % of oils</option>
          <option value="concentration">Lye concentration %</option>
          <option value="ratio">Water : Lye ratio</option>
        </select>
      </div>
      <div class="col-lg-6 col-md-12">
        <div class="soap-field-stack water-input" data-method="percent">
          <label class="form-label">Water of oils</label>
          <div class="soap-input-suffix" data-suffix="%">
            <input type="number" class="form-control" id="waterPct" min="0" step="0.1" value="33">
          </div>
        </div>
        <div class="soap-field-stack water-input d-none" data-method="concentration">
          <label class="form-label">Lye concentration</label>
          <div class="soap-input-suffix" data-suffix="%">
            <input type="number" class="form-control" id="lyeConcentration" min="20" max="50" step="0.1" value="33">
          </div>
        </div>
        <div class="soap-field-stack water-input d-none" data-method="ratio">
          <label class="form-label">Water : Lye ratio</label>
          <input type="number" class="form-control" id="waterRatio" min="1" max="4" step="0.05" value="2">
        </div>
      </div>
    </div>
    <div class="row g-2 align-items-start soap-stage-form-row soap-config-row soap-stage-grid mt-2">
      <div class="col-lg-6 col-md-12 soap-field-stack">
        <label class="form-label">Lye purity</label>
        <div class="soap-input-suffix" data-suffix="%">
          <input type="number" class="form-control" id="lyePurity" min="90" max="100" step="0.1" value="100">
        </div>
        <div class="form-text soap-stage-note" id="lyePurityHint">Most calculators assume 100%.</div>
      </div>
      <div class="col-lg-6 col-md-12 soap-field-stack">
        <label class="form-label">Superfat</label>
        <div class="soap-input-suffix" data-suffix="%">
          <input type="number" class="form-control" id="lyeSuperfat" name="superfat" min="0" max="20" step="0.1" value="5">
        </div>
        <div class="form-text soap-stage-note">5% is a balanced default.</div>
      </div>
    </div>
    {% set stage_index = 2 %}
    {% include 'tools/soaps/stages/_stage_actions.html' %}
  </div>
</div>
