{% set show_dev_link = show_dev_link | default(false) %}
{% set show_store_link = show_store_link | default(false) %}
<div class="offcanvas offcanvas-end" tabindex="-1" id="globalItemDetail" aria-labelledby="globalItemDetailLabel">
  <div class="offcanvas-header">
    <h5 id="globalItemDetailLabel">Global Item</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <div id="giDetailLoading" class="text-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2 mb-0">Loading item details...</p>
    </div>
    <div id="giDetailContent" style="display:none;">
        <div class="mb-2"><strong>Name:</strong> <span id="giName"></span></div>
        <div class="mb-2"><strong>Type:</strong> <span id="giType"></span></div>
        <div class="mb-2"><strong>Ingredient:</strong> <span id="giIngredientName"></span></div>
        <div class="mb-2"><strong>INCI Name:</strong> <span id="giInciName"></span></div>
        <div class="mb-2"><strong>CAS Number:</strong> <span id="giCasNumber"></span></div>
        <div class="mb-2"><strong>Category:</strong> <span id="giCategory"></span></div>
        <div class="mb-2"><strong>Default Unit:</strong> <span id="giUnit"></span></div>
        <div class="mb-2"><strong>Density:</strong> <span id="giDensity"></span></div>
        <div class="mb-2"><strong>Physical Form:</strong> <span id="giPhysicalForm"></span></div>
        <div class="mb-2"><strong>Functions:</strong> <span id="giFunctions"></span></div>
        <div class="mb-2"><strong>Applications:</strong> <span id="giApplications"></span></div>

      <div id="giContainerMeta" style="display:none;">
        <hr>
        <h6>Container Properties</h6>
        <div class="mb-2"><strong>Material:</strong> <span id="giMaterial"></span></div>
        <div class="mb-2"><strong>Type/Style:</strong> <span id="giTypeStyle"></span></div>
        <div class="mb-2"><strong>Color:</strong> <span id="giColor"></span></div>
      </div>

      <div id="giIngredientStats" style="display:none;">
        <hr>
        <h6>Ingredient Properties</h6>
        <div class="row row-cols-2 g-2" id="giPropsGrid"></div>
      </div>

      <hr>
      <h6>Community Cost Snapshot</h6>
      <div id="giCostStats" class="mb-3">No cost data yet.</div>
      <small class="text-muted">Based on user restock unit costs (outliers excluded). High/Low show extremes.</small>

      <div class="mt-3" id="giMeta"></div>
    </div>
  </div>
  <div class="offcanvas-footer p-3 border-top">
    <div class="d-flex justify-content-end gap-2">
      <a id="giDevLink" class="btn btn-sm btn-outline-secondary" href="#" target="_blank" rel="noopener" style="display: {{ 'inline-flex' if show_dev_link else 'none' }};">
        <i class="fas fa-cog me-1"></i> Developer View
      </a>
      <a id="giStoreLink" class="btn btn-sm btn-primary disabled" href="#" tabindex="-1" aria-disabled="true" style="display: {{ 'inline-flex' if show_store_link else 'none' }};">
        Store (coming soon)
      </a>
    </div>
  </div>
</div>
