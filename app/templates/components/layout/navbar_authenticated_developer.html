{#
Synopsis:
Authenticated developer navigation and developer/customer switcher menus.
#}
<!-- Developer Navigation -->
<div class="navbar-nav me-auto">
    <span class="navbar-text text-danger">
        <i class="fas fa-shield-alt"></i> Developer Mode
        {% if session.get('dev_selected_org_id') %}
        {% set selected_org = get_organization_by_id(session.get('dev_selected_org_id')) %}
        <small class="text-primary">| Viewing as Org Owner ({{ selected_org.get_tier_display_name() if selected_org else 'No Org' }})</small>
        <a href="{{ url_for('developer.clear_organization_filter') }}" class="btn btn-sm btn-outline-secondary ms-2">
            <i class="fas fa-times"></i> Clear Filter
        </a>
        {% endif %}
    </span>
</div>
<!-- Show both menus when developer is viewing an organization -->
{% if session.get('dev_selected_org_id') %}
{% if not has_nav_center %}
<ul class="navbar-nav mx-auto d-none d-md-flex">
    <li class="nav-item">
        <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#unitConverterModal">
            üßÆ Converter
        </a>
    </li>
</ul>
{% endif %}
<div class="dropdown me-2">
    <button class="btn btn-light dropdown-toggle" type="button" id="customerDropdown" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-user"></i> Customer Menu
    </button>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="customerDropdown">
        <!-- User Dashboard -->
        <li><a class="dropdown-item" href="{{ url_for('app_routes.dashboard') }}">User Dashboard</a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Core Features -->
        <li><h6 class="dropdown-header">Core Features</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('inventory.list_inventory') }}">Inventory</a></li>
        <li><a class="dropdown-item" href="{{ url_for('recipes.list_recipes') }}">Recipes</a></li>
        <li><a class="dropdown-item" href="{{ url_for('batches.list_batches') }}">Batches</a></li>
        <li><a class="dropdown-item" href="{{ url_for('products.list_products') }}">Products</a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Production Tools -->
        <li><h6 class="dropdown-header">Production Tools</h6></li>
        <li>
            <a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#unitConverterModal">
                üßÆ Converter
            </a>
        </li>
        <li>
            <a class="dropdown-item d-flex justify-content-between align-items-center" href="{{ url_for('expiration.alerts') }}">
                Expiration
                <span id="expiration-badge" class="badge bg-danger" style="display: none;">0</span>
            </a>
        </li>
        <li><a class="dropdown-item" href="{{ url_for('timers.list_timers') }}">Timers</a></li>
        <li><a class="dropdown-item" href="{{ url_for('reservation.list_reservations') }}">Reservations</a></li>
        {% if bulk_stock_check_enabled %}
        <li><a class="dropdown-item" href="{{ url_for('bulk_stock.bulk_stock_check') }}">Bulk Stock Check</a></li>
        {% endif %}
        {% if bulk_inventory_updates_enabled %}
        <li><a class="dropdown-item" href="{{ url_for('inventory.bulk_inventory_updates') }}">Bulk Inventory Updates</a></li>
        {% endif %}
        <li><hr class="dropdown-divider"></li>
        <!-- Resources -->
        <li><h6 class="dropdown-header">Resources</h6></li>
        {% if global_library_enabled %}
        <li><a class="dropdown-item" href="{{ url_for('global_library_bp.global_library') }}">Global Inventory Library</a></li>
        {% endif %}
        {% if show_recipe_library_link %}
        <li><a class="dropdown-item" href="{{ url_for('recipe_library_bp.recipe_library') }}">Recipe Library</a></li>
        {% endif %}
        <li><a class="dropdown-item" href="/tools">üîß Tools</a></li>
        <li><a class="dropdown-item" href="{{ url_for('help_routes.help_overview') }}">‚ùì Help</a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Admin -->
        <li><h6 class="dropdown-header">Admin</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('organization.dashboard') }}">Organization Dashboard</a></li>
        <li><a class="dropdown-item" href="{{ url_for('settings.index') }}">Settings</a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">Logout</a></li>
    </ul>
</div>
{% endif %}
<!-- Developer Menu (always available) -->
<div class="dropdown ms-auto">
    <button class="btn btn-danger dropdown-toggle" type="button" id="devDropdown" data-bs-toggle="dropdown" aria-expanded="false">
        <i class="fas fa-code"></i> Developer Menu
    </button>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="devDropdown">
        <!-- Developer Dashboard -->
        <li><a class="dropdown-item" href="{{ url_for('developer.dashboard') }}">
            <i class="fas fa-tachometer-alt"></i> Developer Dashboard
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Organization Management -->
        <li><h6 class="dropdown-header">Organization Management</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.create_organization') }}">
            <i class="fas fa-plus"></i> Create Organization
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.organizations') }}">
            <i class="fas fa-building"></i> All Organizations
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.users') }}">
            <i class="fas fa-users"></i> User Management
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.system_roles.manage_system_roles') }}">
            <i class="fas fa-user-shield"></i> Role Management
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('auth.manage_permissions') }}">
            <i class="fas fa-key"></i> Permissions
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Global Library -->
        <li><h6 class="dropdown-header">Global Library</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.global_items_admin') }}">
            <i class="fas fa-boxes"></i> Global Items
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('recipe_library_bp.recipe_library') }}">
            <i class="fas fa-book-open"></i> Recipe Library
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.product_categories') }}">
            <i class="fas fa-tags"></i> Product Categories
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.reference_categories') }}">
            <i class="fas fa-leaf"></i> Ingredient Categories
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.container_management') }}">
            <i class="fas fa-box-open"></i> Container Management
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.manage_ingredient_attributes') }}">
            <i class="fas fa-layer-group"></i> Physical Forms
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Analytics -->
        <li><h6 class="dropdown-header">Analytics</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.analytics_catalog') }}">
            <i class="fas fa-database"></i> Analytics Catalog
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.inventory_analytics_stub') }}">
            <i class="fas fa-chart-line"></i> Inventory Analytics
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.system_statistics') }}">
            <i class="fas fa-chart-bar"></i> System Statistics
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- AI & Automation -->
        <li><h6 class="dropdown-header">AI & Automation</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.batchley_overview') }}">
            <i class="fas fa-robot"></i> Batchley
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Billing -->
        <li><h6 class="dropdown-header">Billing</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.subscription_tiers.manage_tiers') }}">
            <i class="fas fa-layer-group text-primary"></i> Tier Management
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.addons.list_addons') }}">
            <i class="fas fa-puzzle-piece"></i> Add-ons
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.billing_integration') }}">
            <i class="fas fa-credit-card"></i> Billing Integration
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Marketing -->
        <li><h6 class="dropdown-header">Marketing</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.marketing_admin') }}">
            <i class="fas fa-bullhorn"></i> Marketing Admin
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.waitlist_statistics') }}">
            <i class="fas fa-envelope"></i> Waitlist
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <!-- Customer Support -->
        <li><h6 class="dropdown-header">Customer Support</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.organizations') }}">
            <i class="fas fa-headset"></i> Customer Support
            {% if session.get('dev_selected_org_id') %}
            <span class="badge bg-primary ms-1">Active</span>
            {% endif %}
        </a></li>
        {% if session.get('dev_selected_org_id') %}
        <li><a class="dropdown-item" href="{{ url_for('developer.clear_organization_filter') }}">
            <i class="fas fa-times"></i> Clear Customer Filter
        </a></li>
        {% endif %}
        <li><hr class="dropdown-divider"></li>
        <!-- System -->
        <li><h6 class="dropdown-header">System</h6></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.system_settings') }}">
            <i class="fas fa-cogs"></i> System Settings
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.integrations_checklist') }}">
            <i class="fas fa-plug"></i> Integrations & Launch
        </a></li>
        <li><a class="dropdown-item" href="{{ url_for('developer.feature_flags') }}">
            <i class="fas fa-toggle-on"></i> Feature Flags
        </a></li>
        <li><hr class="dropdown-divider"></li>
        <li><a class="dropdown-item" href="{{ url_for('auth.logout') }}">
            <i class="fas fa-sign-out-alt"></i> Logout
        </a></li>
    </ul>
</div>
