{% extends 'layout.html' %}
{% block content %}
<h2>Edit Product Category</h2>
<form method="post">
  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  <div class="mb-3">
    <label class="form-label">Name</label>
    <input type="text" name="name" class="form-control" value="{{ category.name }}" required>
  </div>
  <div class="form-check mb-3">
    <input class="form-check-input" type="checkbox" id="is_typically_portioned" name="is_typically_portioned" {% if category.is_typically_portioned %}checked{% endif %}>
    <label class="form-check-label" for="is_typically_portioned">Typically Portioned</label>
  </div>
  <div class="mb-3">
    <label class="form-label">SKU Name Template</label>
    <input type="text" class="form-control" name="sku_name_template" value="{{ category.sku_name_template or '' }}" placeholder="{variant} {product} ({size_label})">
    <small class="text-muted">Tokens: {product}, {variant}, {container}, {size_label}</small>
    <div class="mt-2">
      <label class="form-label">Live Preview</label>
      <div class="form-text" id="skuPreview"></div>
    </div>
  </div>
  <div class="d-flex gap-2">
    <a href="{{ url_for('developer.product_categories') }}" class="btn btn-secondary">Cancel</a>
    <button type="submit" class="btn btn-success">Save</button>
  </div>
</form>
<script>
(function(){
  const input = document.querySelector('input[name="sku_name_template"]');
  const preview = document.getElementById('skuPreview');
  const sample = { product: 'Salt Soap', variant: 'Lavender', container: '4 oz Jar', size_label: '4.5 oz Bar' };
  function render(tpl){
    if (!tpl) return '';
    return tpl.replace('{product}', sample.product)
              .replace('{variant}', sample.variant)
              .replace('{container}', sample.container)
              .replace('{size_label}', sample.size_label);
  }
  function update(){ preview.textContent = render(input.value || ''); }
  if (input && preview){ input.addEventListener('input', update); update(); }
})();
</script>
{% endblock %}

