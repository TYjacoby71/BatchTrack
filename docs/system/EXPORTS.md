# Exports

## Synopsis
This guide documents the current export surface for recipe-scoped and public-tool flows. Exports are served from `/exports/*` routes and generated by `ExportService`.

## Glossary
- **Recipe export**: Authenticated export built from a saved recipe record.
- **Tool export**: Public export built from `session['tool_draft']`.
- **Sheet type**: Soap INCI, candle label, baker sheet, or lotion INCI.

## Route Matrix (Current)

### Recipe exports (auth + permission gated)
All recipe routes require login plus `reports.export` permission.

- HTML:
  - `/exports/recipe/<id>/soap-inci`
  - `/exports/recipe/<id>/candle-label`
  - `/exports/recipe/<id>/baker-sheet`
  - `/exports/recipe/<id>/lotion-inci`
- CSV:
  - `/exports/recipe/<id>/soap-inci.csv`
  - `/exports/recipe/<id>/candle-label.csv`
  - `/exports/recipe/<id>/baker-sheet.csv`
  - `/exports/recipe/<id>/lotion-inci.csv`
- PDF:
  - `/exports/recipe/<id>/soap-inci.pdf`
  - `/exports/recipe/<id>/candle-label.pdf`
  - `/exports/recipe/<id>/baker-sheet.pdf`
  - `/exports/recipe/<id>/lotion-inci.pdf`

### Tool exports (public/session-based)
- HTML:
  - `/exports/tool/soaps/inci`
  - `/exports/tool/candles/label`
  - `/exports/tool/baker/sheet`
  - `/exports/tool/lotions/inci`
- CSV:
  - `/exports/tool/soaps/inci.csv`
  - `/exports/tool/candles/label.csv`
  - `/exports/tool/baker/sheet.csv`
  - `/exports/tool/lotions/inci.csv`
- PDF:
  - `/exports/tool/soaps/inci.pdf`
  - `/exports/tool/candles/label.pdf`
  - `/exports/tool/baker/sheet.pdf`
  - `/exports/tool/lotions/inci.pdf`

## Data Sources
- Recipe flow: `Recipe` model + related line items.
- Tool flow: `session['tool_draft']`.
- Category-specific values: pulled from recipe/tool `category_data` where applicable.

## Format Behavior
- CSV: lightweight UTF-8 CSV rows from export service helpers.
- PDF: generated via WeasyPrint when available; falls back to HTML bytes if rendering engine is unavailable.

## Relevance Check (2026-02-17)
Validated against:
- `app/routes/exports_routes.py`
- `app/services/exports.py`
- `app/route_access.py` (public `/exports/tool` access)
