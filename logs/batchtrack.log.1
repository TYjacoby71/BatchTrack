2025-08-18 22:50:05,541 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=-75.0, change_type=batch, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:50:05,573 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'FIFO test deduction'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'quantity_change': 'FIFO test deduction', 'timestamp': datetime.datetime(2025, 8, 18, 22, 50, 5, 572792), 'unit': 'g', 'fifo_code': 'BCH-SSQVEK', 'or ... (517 characters truncated) ... ': None, 'container_id': None, 'location_name': None, 'fifo_source': None, 'marketplace_source': None, 'lot_number': None, 'quality_checked_by': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:106]
2025-08-18 22:50:06,348 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:50:06,350 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:50:07,233 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=250.0, change_type=finished_batch, caller=tests/test_inventory_fifo.py:test_inventory_adjustment_delegates_properly [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:50:07,244 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-18 22:50:07,246 INFO: FIFO: Updating inventory item 1 quantity: 0.0 â†’ 250.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:50:07,264 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:101]
2025-08-18 22:50:07,917 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:50:07,920 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:50:08,103 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:50:08,106 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
