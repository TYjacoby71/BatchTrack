2025-08-14 01:09:08,421 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Second batch'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'fifo_code': 'TXN-10KFBVD', 'inventory_item_id': 1, 'timestamp': datetime.datetime(2025, 8, 14, 1, 9, 8, 419452), 'organization_id': 2, 'unit': 'g',  ... (511 characters truncated) ... one, 'unit_cost': None, 'sale_location': None, 'quality_checked_by': None, 'marketplace_order_id': None, 'fifo_source': None, 'shelf_life_days': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-14 01:09:08,434 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=-75.0, change_type=batch, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-14 01:09:08,461 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'FIFO test deduction'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'fifo_code': 'BCH-1QZIW4W', 'inventory_item_id': 1, 'timestamp': datetime.datetime(2025, 8, 14, 1, 9, 8, 460048), 'organization_id': 2, 'unit': 'g',  ... (516 characters truncated) ... one, 'unit_cost': None, 'sale_location': None, 'quality_checked_by': None, 'marketplace_order_id': None, 'fifo_source': None, 'shelf_life_days': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-14 01:09:08,574 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:09:08,574 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:09:09,384 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=250.0, change_type=finished_batch, caller=tests/test_inventory_fifo.py:test_inventory_adjustment_delegates_properly [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-14 01:09:09,384 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=250.0, change_type=finished_batch, caller=tests/test_inventory_fifo.py:test_inventory_adjustment_delegates_properly [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-14 01:09:09,386 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 250.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-14 01:09:09,386 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 250.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-14 01:09:09,408 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Batch completion'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'fifo_code': 'TXN-1GCUXVB', 'inventory_item_id': 1, 'timestamp': datetime.datetime(2025, 8, 14, 1, 9, 9, 407061), 'organization_id': 2, 'unit': 'ml', ... (523 characters truncated) ... one, 'unit_cost': None, 'sale_location': None, 'quality_checked_by': None, 'marketplace_order_id': None, 'fifo_source': None, 'shelf_life_days': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-14 01:09:09,408 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Batch completion'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'fifo_code': 'TXN-1GCUXVB', 'inventory_item_id': 1, 'timestamp': datetime.datetime(2025, 8, 14, 1, 9, 9, 407061), 'organization_id': 2, 'unit': 'ml', ... (523 characters truncated) ... one, 'unit_cost': None, 'sale_location': None, 'quality_checked_by': None, 'marketplace_order_id': None, 'fifo_source': None, 'shelf_life_days': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-14 01:09:16,612 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:09:18,280 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:09:18,591 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:14:55,354 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:14:57,423 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:14:59,332 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-14 01:14:59,576 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:15,980 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,044 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,046 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,047 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,048 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,049 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,050 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,051 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:16,062 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-14 01:15:33,724 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=12, quantity=10.0, change_type=restock, caller=app/services/inventory_adjustment/_creation_logic.py:create_inventory_item [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-14 01:15:33,726 INFO: FIFO: Updating inventory item 12 quantity: 0 → 10.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-14 01:15:33,901 ERROR: Failed to record audit entry for item 12: (builtins.ValueError) could not convert string to float: 'Initial stock creation'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'unit': 'count', 'organization_id': 1, 'fifo_code': 'TXN-1CYNSMM', 'timestamp': datetime.datetime(2025, 8, 14, 1, 15, 33, 900338), 'inventory_item_id ... (528 characters truncated) ... e, 'quality_checked_by': None, 'compliance_status': None, 'batch_id': None, 'customer': None, 'fifo_reference_id': None, 'marketplace_order_id': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
