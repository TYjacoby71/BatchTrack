2025-08-13 21:55:02,603 ERROR: Failed to record audit entry for item 2: (builtins.ValueError) could not convert string to float: 'Deducted 10.0 count'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'organization_id': 1, 'quantity_change': 'Deducted 10.0 count', 'timestamp': datetime.datetime(2025, 8, 13, 21, 55, 2, 602317), 'remaining_quantity': ... (522 characters truncated) ... , 'shelf_life_days': None, 'temperature_at_time': None, 'batch_number': None, 'reservation_id': None, 'container_id': None, 'fifo_reference_id': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-13 21:55:02,671 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:02,689 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:02,693 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:11,175 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=2, quantity=20.0, change_type=recount, caller=app/services/inventory_adjustment/_edit_logic.py:update_inventory_item [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:32]
2025-08-13 21:55:11,176 INFO: RECOUNT: Processing recount from 10.0 to 20.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:43]
2025-08-13 21:55:11,352 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:11,372 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:11,375 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:23,554 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=2, quantity=30.0, change_type=recount, caller=app/services/inventory_adjustment/_edit_logic.py:update_inventory_item [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:32]
2025-08-13 21:55:23,554 INFO: RECOUNT: Processing recount from 20.0 to 30.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:43]
2025-08-13 21:55:23,920 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:23,944 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:55:23,947 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:56:55,375 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-13 21:57:11,369 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-13 21:57:13,173 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-13 21:57:13,694 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,261 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,330 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,331 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,332 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,334 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,335 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,336 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,338 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:21,348 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:28,232 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:28,271 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:28,346 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:35,422 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=2, quantity=10.0, change_type=restock, caller=app/blueprints/inventory/routes.py:adjust_inventory [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-13 21:57:35,430 INFO: FIFO: Updating inventory item 2 quantity: 30.0 → 40.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-13 21:57:35,532 ERROR: Failed to record audit entry for item 2: (builtins.ValueError) could not convert string to float: 'Added 10.0 count'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'unit': 'count', 'remaining_quantity': 0.0, 'organization_id': 1, 'timestamp': datetime.datetime(2025, 8, 13, 21, 57, 35, 530433), 'quantity_change': ... (522 characters truncated) ... None, 'order_id': None, 'reservation_id': None, 'fifo_reference_id': None, 'expiration_date': None, 'marketplace_source': None, 'location_name': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-13 21:57:35,606 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:35,627 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:35,630 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:40,444 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:40,463 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:40,465 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:42,963 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:42,996 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:43,002 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:56,801 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=2, quantity=10.0, change_type=recount, caller=app/services/inventory_adjustment/_edit_logic.py:update_inventory_item [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-13 21:57:56,801 INFO: RECOUNT: Processing recount from 40.0 to 10.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:44]
2025-08-13 21:57:56,806 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=2, quantity=30.0, change_type=recount_deduction, caller=app/services/inventory_adjustment/_recount_logic.py:handle_recount_adjustment [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-13 21:57:56,886 ERROR: Failed to record audit entry for item 2: (builtins.ValueError) could not convert string to float: 'Quantity updated via edit: 40.0 → 10.0 - Deducted 30.0'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'unit': 'count', 'remaining_quantity': 0.0, 'organization_id': 1, 'timestamp': datetime.datetime(2025, 8, 13, 21, 57, 56, 885835), 'quantity_change': ... (570 characters truncated) ... None, 'order_id': None, 'reservation_id': None, 'fifo_reference_id': None, 'expiration_date': None, 'marketplace_source': None, 'location_name': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-13 21:57:56,962 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:56,980 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 21:57:56,983 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-13 22:00:55,481 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-13 22:01:08,241 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-13 22:01:11,065 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
