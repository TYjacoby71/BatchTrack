2025-08-21 09:58:22,388 INFO: RECOUNT: Removing 60.0 to reconcile inventory [in /home/runner/workspace/app/services/inventory_adjustment/_recount_logic.py:73]
2025-08-21 09:58:22,392 INFO: FIFO: Deducted 3.0 count from lot LOT10U4NH2CJ (ID: 8) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:161]
2025-08-21 09:58:22,393 INFO: FIFO: Deducted 10.0 count from lot LOT17FVC02KD (ID: 11) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:161]
2025-08-21 09:58:22,393 INFO: FIFO: Deducted 10.0 count from lot LOT1DLIH72DC (ID: 12) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:161]
2025-08-21 09:58:22,393 WARNING: FIFO: Could not deduct full amount. 37.0 units remaining [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:164]
2025-08-21 09:58:22,394 ERROR: FAILED: recount operation failed for item 2: Failed to remove recount adjustment: Insufficient inventory. 37.0 units could not be deducted [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:66]
2025-08-21 09:58:22,470 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:22,489 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:22,492 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:30,798 INFO: EDIT INVENTORY - Item: Admin Apples (ID: 2) [in /home/runner/workspace/app/blueprints/inventory/routes.py:373]
2025-08-21 09:58:30,799 INFO: Form data received: {'csrf_token': 'IjNmY2I2MDg5Mzc0Y2YyYWMwMzcyYjRjNGY1ODU1NWU5ODA2OTRlNGYi.aKbtvg.LLvoPWfwG5BTVxhDkE0lMm4BsJI', 'name': 'Admin Apples', 'quantity': '37', 'type': 'ingredient', 'is_perishable': 'on', 'shelf_life_days': '1', 'category_id': '', 'unit': 'count', 'density': '0.0', 'cost_per_unit': '3.0', 'confirm_unit_change': 'false', 'convert_inventory': 'false', 'change_type': 'recount'} [in /home/runner/workspace/app/blueprints/inventory/routes.py:374]
2025-08-21 09:58:30,799 INFO: QUANTITY RECOUNT: Target quantity 37.0 for item Admin Apples [in /home/runner/workspace/app/blueprints/inventory/routes.py:383]
2025-08-21 09:58:30,799 INFO: CANONICAL: item_id=2, qty=37.0, type=recount [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:14]
2025-08-21 09:58:30,800 INFO: RECOUNT: Item 2 current=60.0, target=37.0, difference=-23.0 [in /home/runner/workspace/app/services/inventory_adjustment/_recount_logic.py:31]
2025-08-21 09:58:30,800 INFO: RECOUNT: Removing 23.0 to reconcile inventory [in /home/runner/workspace/app/services/inventory_adjustment/_recount_logic.py:73]
2025-08-21 09:58:30,802 INFO: FIFO: Deducted 3.0 count from lot LOT10U4NH2CJ (ID: 8) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:161]
2025-08-21 09:58:30,802 INFO: FIFO: Deducted 10.0 count from lot LOT17FVC02KD (ID: 11) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:161]
2025-08-21 09:58:30,802 INFO: FIFO: Deducted 10.0 count from lot LOT1DLIH72DC (ID: 12) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:161]
2025-08-21 09:58:30,803 INFO: RECOUNT SUCCESS: Item 2 will be set to 37.0 [in /home/runner/workspace/app/services/inventory_adjustment/_recount_logic.py:87]
2025-08-21 09:58:30,864 INFO: SUCCESS: recount completed for item 2 (FIFO validated) [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:96]
2025-08-21 09:58:30,864 INFO: RECOUNT SUCCESS: Inventory recounted to 37.0 [in /home/runner/workspace/app/blueprints/inventory/routes.py:398]
2025-08-21 09:58:30,937 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:30,960 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:30,964 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:42,305 INFO: ADJUST INVENTORY - Item: Admin Apples (ID: 2) [in /home/runner/workspace/app/blueprints/inventory/routes.py:280]
2025-08-21 09:58:42,305 INFO: Form data received: {'csrf_token': 'IjNmY2I2MDg5Mzc0Y2YyYWMwMzcyYjRjNGY1ODU1NWU5ODA2OTRlNGYi.aKbtxg.e2XgqiIYbrL9grVhpfqPr6fzSYA', 'change_type': 'spoil', 'quantity': '37', 'input_unit': 'count', 'cost_entry_type': 'no_change', 'notes': ''} [in /home/runner/workspace/app/blueprints/inventory/routes.py:281]
2025-08-21 09:58:42,305 INFO: Attempting to adjust inventory for item Admin Apples with quantity 37.0, change type spoil, unit count [in /home/runner/workspace/app/blueprints/inventory/routes.py:317]
2025-08-21 09:58:42,305 INFO: CANONICAL: item_id=2, qty=37.0, type=spoil [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:14]
2025-08-21 09:58:42,306 INFO: SPOIL: Deducting 37.0 from item 2 [in /home/runner/workspace/app/services/inventory_adjustment/_deductive_ops.py:34]
2025-08-21 09:58:42,307 WARNING: FIFO: No available lots for deduction from item 2 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:117]
2025-08-21 09:58:42,307 INFO: SPOIL SUCCESS: Will decrease item 2 by 37.0 [in /home/runner/workspace/app/services/inventory_adjustment/_deductive_ops.py:67]
2025-08-21 09:58:42,307 INFO: QUANTITY UPDATE: Item 2 quantity 60.0 + -37.0 = 23.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:72]
2025-08-21 09:58:42,309 ERROR: FIFO SYNC MISMATCH for item 2 (Admin Apples): [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:31]
2025-08-21 09:58:42,309 ERROR:   Item quantity: 23.0 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:32]
2025-08-21 09:58:42,309 ERROR:   FIFO total: 60.0 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:33]
2025-08-21 09:58:42,310 ERROR:   Difference: 37.0 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:34]
2025-08-21 09:58:42,310 ERROR:   Active FIFO entries: 6 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:35]
2025-08-21 09:58:42,310 ERROR:     Entry 1: 10.0 (restock, 2025-08-21 07:11:22.663787) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-21 09:58:42,310 ERROR:     Entry 2: 10.0 (restock, 2025-08-21 07:41:28.022827) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-21 09:58:42,310 ERROR:     Entry 3: 10.0 (restock, 2025-08-21 07:46:54.082924) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-21 09:58:42,310 ERROR:     Entry 4: 10.0 (restock, 2025-08-21 08:01:01.877730) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-21 09:58:42,310 ERROR:     Entry 5: 10.0 (restock, 2025-08-21 08:17:52.969595) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-21 09:58:42,311 ERROR:     Entry 6: 10.0 (restock, 2025-08-21 09:58:03.312339) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-21 09:58:42,311 ERROR: FIFO VALIDATION FAILED before commit for item 2: FIFO sync error: inventory=23.0, fifo_total=60.0, diff=37.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:84]
2025-08-21 09:58:42,311 ERROR: Adjustment failed: FIFO validation failed: FIFO sync error: inventory=23.0, fifo_total=60.0, diff=37.0 [in /home/runner/workspace/app/blueprints/inventory/routes.py:338]
2025-08-21 09:58:42,387 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:42,410 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:58:42,413 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:59:17,094 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 09:59:29,034 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 09:59:30,920 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 09:59:31,298 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 09:59:51,659 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-21 10:00:21,092 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:00:43,039 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:01:00,417 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:02:10,018 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:02:13,364 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:02:40,224 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:02:46,069 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:02:55,816 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:03:14,720 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:03:49,552 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:03:55,392 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:03:59,422 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:04:53,246 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:04:54,320 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:05:10,329 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:05:12,088 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-21 10:05:12,484 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
