2025-07-07 19:52:32,603 INFO:   - item_id (inventory_item_id): 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:124]
2025-07-07 19:52:32,605 INFO:   - quantity: 1.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:125]
2025-07-07 19:52:32,605 INFO:   - change_type: recount [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:126]
2025-07-07 19:52:32,605 INFO:   - unit: floz [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:127]
2025-07-07 19:52:32,605 INFO:   - notes:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:128]
2025-07-07 19:52:32,605 INFO:   - created_by: 2 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:129]
2025-07-07 19:52:32,606 INFO:   - item_type: product [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:130]
2025-07-07 19:52:32,606 INFO:   - customer: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:131]
2025-07-07 19:52:32,606 INFO:   - sale_price: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:132]
2025-07-07 19:52:32,606 INFO:   - order_id:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:133]
2025-07-07 19:52:32,606 INFO:   - cost_override: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:134]
2025-07-07 19:52:32,606 INFO:   - custom_expiration_date: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:135]
2025-07-07 19:52:32,607 INFO:   - custom_shelf_life_days: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:136]
2025-07-07 19:52:32,610 ERROR: Exception in SKU inventory adjustment: Error adjusting inventory: type object 'ProductSKUHistory' has no attribute 'sku_id' [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:187]
2025-07-07 19:52:32,610 ERROR: Full traceback: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:188]
Traceback (most recent call last):
  File "/home/runner/workspace/app/blueprints/products/product_inventory_routes.py", line 138, in adjust_sku_inventory
    success = process_inventory_adjustment(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/app/services/inventory_adjustment.py", line 276, in process_inventory_adjustment
    raise e
  File "/home/runner/workspace/app/services/inventory_adjustment.py", line 266, in process_inventory_adjustment
    is_valid, error_msg, inv_qty, fifo_total = validate_inventory_fifo_sync(item_id, item_type)
                                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/app/services/inventory_adjustment.py", line 31, in validate_inventory_fifo_sync
    ProductSKUHistory.sku_id == sku.id,
    ^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'ProductSKUHistory' has no attribute 'sku_id'
2025-07-07 19:52:32,611 INFO: === PRODUCT INVENTORY ADJUSTMENT END === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:194]
2025-07-07 19:52:32,612 INFO: Redirecting to SKU view: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:196]
2025-07-07 19:52:50,593 INFO: === PRODUCT INVENTORY ADJUSTMENT START === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:18]
2025-07-07 19:52:50,593 INFO: SKU ID: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:19]
2025-07-07 19:52:50,594 INFO: User: 2 (admin) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:20]
2025-07-07 19:52:50,594 INFO: Organization: 1 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:21]
2025-07-07 19:52:50,594 INFO: Request method: POST [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:22]
2025-07-07 19:52:50,594 INFO: Request is JSON: False [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:23]
2025-07-07 19:52:50,596 INFO: SKU lookup result: <ProductSKU Admin Apple Sauce - Base - Bulk> [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:30]
2025-07-07 19:52:50,596 INFO: SKU details - ID: 4, Product: Admin Apple Sauce, Variant: Base [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:32]
2025-07-07 19:52:50,597 INFO: SKU inventory item: <InventoryItem 4> [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:33]
2025-07-07 19:52:50,597 INFO: Current inventory quantity: 1.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:35]
2025-07-07 19:52:50,597 INFO: Form request data: {'csrf_token': 'ImJmMDMzMGUyZTY5OTkzY2EzMTY5YTcyNWI5ZGIzOWI1MzY2NGFlYTMi.aGwlgA.JfAzRFSMZY2_SJKkms_BpNqcPF4', 'action': 'adjust_fifo', 'inventory_id': '', 'change_type': 'sale', 'quantity': '1', 'notes': '', 'order_id': '', 'sale_price': '10.99', 'restock_cost': '', 'expiration_minutes': '30'} [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:50]
2025-07-07 19:52:50,597 INFO: Extracted quantity: 1 (type: <class 'str'>) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:56]
2025-07-07 19:52:50,597 INFO: Extracted change_type: sale [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:57]
2025-07-07 19:52:50,598 INFO: Converting quantity '1' to float [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:83]
2025-07-07 19:52:50,598 INFO: Converted quantity: 1.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:85]
2025-07-07 19:52:50,598 INFO: Optional fields extracted: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:99]
2025-07-07 19:52:50,598 INFO:   - notes:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:100]
2025-07-07 19:52:50,598 INFO:   - unit: floz [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:101]
2025-07-07 19:52:50,598 INFO:   - customer: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:102]
2025-07-07 19:52:50,599 INFO:   - sale_price: 10.99 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:103]
2025-07-07 19:52:50,599 INFO:   - order_id:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:104]
2025-07-07 19:52:50,599 INFO:   - cost_override: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:105]
2025-07-07 19:52:50,599 INFO: === CALLING CENTRALIZED INVENTORY ADJUSTMENT === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:122]
2025-07-07 19:52:50,599 INFO: Parameters: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:123]
2025-07-07 19:52:50,599 INFO:   - item_id (inventory_item_id): 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:124]
2025-07-07 19:52:50,599 INFO:   - quantity: 1.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:125]
2025-07-07 19:52:50,600 INFO:   - change_type: sale [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:126]
2025-07-07 19:52:50,600 INFO:   - unit: floz [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:127]
2025-07-07 19:52:50,600 INFO:   - notes:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:128]
2025-07-07 19:52:50,600 INFO:   - created_by: 2 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:129]
2025-07-07 19:52:50,600 INFO:   - item_type: product [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:130]
2025-07-07 19:52:50,600 INFO:   - customer: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:131]
2025-07-07 19:52:50,600 INFO:   - sale_price: 10.99 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:132]
2025-07-07 19:52:50,600 INFO:   - order_id:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:133]
2025-07-07 19:52:50,601 INFO:   - cost_override: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:134]
2025-07-07 19:52:50,601 INFO:   - custom_expiration_date: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:135]
2025-07-07 19:52:50,601 INFO:   - custom_shelf_life_days: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:136]
2025-07-07 19:52:50,602 ERROR: Exception in SKU inventory adjustment: Error adjusting inventory: 'ProductSKU' object has no attribute 'id' [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:187]
2025-07-07 19:52:50,602 ERROR: Full traceback: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:188]
Traceback (most recent call last):
  File "/home/runner/workspace/app/blueprints/products/product_inventory_routes.py", line 138, in adjust_sku_inventory
    success = process_inventory_adjustment(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/app/services/inventory_adjustment.py", line 276, in process_inventory_adjustment
    raise e
  File "/home/runner/workspace/app/services/inventory_adjustment.py", line 226, in process_inventory_adjustment
    sku_id=sku.id,
           ^^^^^^
AttributeError: 'ProductSKU' object has no attribute 'id'
2025-07-07 19:52:50,603 INFO: === PRODUCT INVENTORY ADJUSTMENT END === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:194]
2025-07-07 19:52:50,603 INFO: Redirecting to SKU view: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:196]
2025-07-07 19:52:56,297 INFO: === PRODUCT INVENTORY ADJUSTMENT START === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:18]
