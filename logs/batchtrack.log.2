2025-08-18 22:42:39,403 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'FIFO test deduction'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'remaining_quantity': 0.0, 'organization_id': 3, 'quantity_change': 'FIFO test deduction', 'timestamp': datetime.datetime(2025, 8, 18, 22, 42, 39, 40 ... (518 characters truncated) ... _price': None, 'fifo_reference_id': None, 'quality_checked_by': None, 'created_by': None, 'batch_id': None, 'customer': None, 'shelf_life_days': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-18 22:42:40,252 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:42:40,257 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:40,257 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:41,132 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=250.0, change_type=finished_batch, caller=tests/test_inventory_fifo.py:test_inventory_adjustment_delegates_properly [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:42:41,132 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=250.0, change_type=finished_batch, caller=tests/test_inventory_fifo.py:test_inventory_adjustment_delegates_properly [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:42:41,140 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-18 22:42:41,140 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-18 22:42:41,142 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 250.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:42:41,142 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 250.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:42:41,165 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:102]
2025-08-18 22:42:41,165 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:102]
2025-08-18 22:42:41,822 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:42:41,822 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:42:41,825 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:41,825 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:41,825 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:42,167 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:42:42,167 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:42:42,167 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:42:42,171 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:42,171 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:42,171 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:42:42,171 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:49:59,524 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:50:02,054 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:50:03,670 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-18 22:50:03,673 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:50:03,673 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-18 22:50:05,451 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=100.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:50:05,451 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=100.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:50:05,462 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-18 22:50:05,462 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-18 22:50:05,466 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 100.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:50:05,466 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 100.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:50:05,486 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:101]
2025-08-18 22:50:05,486 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:101]
2025-08-18 22:50:05,504 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=50.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:50:05,504 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=50.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-18 22:50:05,506 INFO: FIFO: Updating inventory item 1 quantity: 100.0 → 150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:50:05,506 INFO: FIFO: Updating inventory item 1 quantity: 100.0 → 150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-18 22:50:05,525 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Second batch'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'quantity_change': 'Second batch', 'timestamp': datetime.datetime(2025, 8, 18, 22, 50, 5, 524581), 'unit': 'g', 'fifo_code': 'TXN-PH77YS', 'organizat ... (512 characters truncated) ... ': None, 'container_id': None, 'location_name': None, 'fifo_source': None, 'marketplace_source': None, 'lot_number': None, 'quality_checked_by': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:106]
2025-08-18 22:50:05,525 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Second batch'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'quantity_change': 'Second batch', 'timestamp': datetime.datetime(2025, 8, 18, 22, 50, 5, 524581), 'unit': 'g', 'fifo_code': 'TXN-PH77YS', 'organizat ... (512 characters truncated) ... ': None, 'container_id': None, 'location_name': None, 'fifo_source': None, 'marketplace_source': None, 'lot_number': None, 'quality_checked_by': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:106]
2025-08-18 22:50:05,541 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=-75.0, change_type=batch, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
