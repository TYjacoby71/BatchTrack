2025-08-19 23:23:07,629 WARNING: Failed to register app_routes_bp from app.routes.app_routes: No module named 'app.services.models' [in /home/runner/workspace/app/blueprints_registry.py:55]
2025-08-19 23:23:07,650 WARNING: Failed to register api_bp from app.blueprints.api.routes: No module named 'app.services.models' [in /home/runner/workspace/app/blueprints_registry.py:55]
2025-08-19 23:23:07,670 WARNING: Product blueprints failed: No module named 'app.services.models' [in /home/runner/workspace/app/blueprints_registry.py:91]
2025-08-19 23:23:07,681 WARNING: API blueprints failed: No module named 'app.services.models' [in /home/runner/workspace/app/blueprints_registry.py:117]
2025-08-19 23:23:07,689 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-19 23:23:07,694 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:23:07,694 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:23:08,670 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-19 23:23:08,670 INFO: Getting global unit list [in /home/runner/workspace/app/utils/unit_utils.py:32]
2025-08-19 23:23:08,677 WARNING: No units found, creating fallback units [in /home/runner/workspace/app/utils/unit_utils.py:70]
2025-08-19 23:23:08,677 WARNING: No units found, creating fallback units [in /home/runner/workspace/app/utils/unit_utils.py:70]
2025-08-19 23:23:14,969 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:23:16,818 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:24:57,238 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:25:01,233 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:25:01,896 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:25:03,438 WARNING: Public API registration failed: No module named 'app.services.services' [in /home/runner/workspace/app/blueprints_registry.py:12]
2025-08-19 23:25:03,448 WARNING: Failed to register recipes_bp from app.blueprints.recipes.routes: cannot import name 'check_organization_access' from 'app.utils.authorization' (/home/runner/workspace/app/utils/authorization.py) [in /home/runner/workspace/app/blueprints_registry.py:36]
2025-08-19 23:25:03,496 WARNING: Failed to register app_routes_bp from app.routes.app_routes: No module named 'app.services.services' [in /home/runner/workspace/app/blueprints_registry.py:55]
2025-08-19 23:25:03,503 WARNING: Failed to register api_bp from app.blueprints.api.routes: No module named 'app.services.services' [in /home/runner/workspace/app/blueprints_registry.py:55]
2025-08-19 23:25:03,515 WARNING: Product blueprints failed: No module named 'app.services.services' [in /home/runner/workspace/app/blueprints_registry.py:91]
2025-08-19 23:25:03,521 WARNING: API blueprints failed: No module named 'app.services.services' [in /home/runner/workspace/app/blueprints_registry.py:117]
2025-08-19 23:25:03,526 INFO: Blueprint 'billing' registered successfully. [in /home/runner/workspace/app/blueprints_registry.py:123]
2025-08-19 23:25:03,528 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:25:03,528 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:25:03,535 INFO: BatchTrack startup [in /home/runner/workspace/app/utils/unit_utils.py:28]
2025-08-19 23:25:04,342 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=100.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-19 23:25:04,342 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=100.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-19 23:25:04,356 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-19 23:25:04,356 INFO: INITIAL STOCK: Detected item 1 has no FIFO history, delegating to creation logic [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:46]
2025-08-19 23:25:04,357 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 100.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-19 23:25:04,357 INFO: FIFO: Updating inventory item 1 quantity: 0.0 → 100.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-19 23:25:04,376 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:102]
2025-08-19 23:25:04,376 INFO: Recorded audit entry for item 1: initial_stock [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:102]
2025-08-19 23:25:04,392 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=50.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-19 23:25:04,392 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=50.0, change_type=restock, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-19 23:25:04,395 INFO: FIFO: Updating inventory item 1 quantity: 100.0 → 150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-19 23:25:04,395 INFO: FIFO: Updating inventory item 1 quantity: 100.0 → 150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:237]
2025-08-19 23:25:04,412 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Second batch'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'remaining_quantity': 0.0, 'inventory_item_id': 1, 'organization_id': 3, 'timestamp': datetime.datetime(2025, 8, 19, 23, 25, 4, 412265), 'change_type ... (513 characters truncated) ...  None, 'shelf_life_days': None, 'order_id': None, 'created_by': None, 'fifo_source': None, 'notes': None, 'lot_number': None, 'expiration_date': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-19 23:25:04,412 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'Second batch'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'remaining_quantity': 0.0, 'inventory_item_id': 1, 'organization_id': 3, 'timestamp': datetime.datetime(2025, 8, 19, 23, 25, 4, 412265), 'change_type ... (513 characters truncated) ...  None, 'shelf_life_days': None, 'order_id': None, 'created_by': None, 'fifo_source': None, 'notes': None, 'lot_number': None, 'expiration_date': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
2025-08-19 23:25:04,427 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=-75.0, change_type=batch, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-19 23:25:04,427 INFO: CANONICAL INVENTORY ADJUSTMENT: item_id=1, quantity=-75.0, change_type=batch, caller=tests/test_inventory_fifo.py:test_fifo_deduction_order [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:33]
2025-08-19 23:25:04,454 ERROR: Failed to record audit entry for item 1: (builtins.ValueError) could not convert string to float: 'FIFO test deduction'
[SQL: INSERT INTO unified_inventory_history (inventory_item_id, timestamp, change_type, quantity_change, unit, unit_cost, remaining_quantity, fifo_reference_id, fifo_code, batch_id, created_by, notes, quantity_used, used_for_batch_id, is_perishable, shelf_life_days, expiration_date, location_id, location_name, temperature_at_time, quality_status, compliance_status, quality_checked_by, customer, sale_price, order_id, reservation_id, is_reserved, sale_location, marketplace_order_id, marketplace_source, batch_number, lot_number, container_id, fifo_source, organization_id) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: [{'remaining_quantity': 0.0, 'inventory_item_id': 1, 'organization_id': 3, 'timestamp': datetime.datetime(2025, 8, 19, 23, 25, 4, 453783), 'change_type ... (518 characters truncated) ...  None, 'shelf_life_days': None, 'order_id': None, 'created_by': None, 'fifo_source': None, 'notes': None, 'lot_number': None, 'expiration_date': None}]] [in /home/runner/workspace/app/services/inventory_adjustment/_audit.py:107]
