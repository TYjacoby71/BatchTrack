2025-08-26 21:05:56,698 INFO: ROUTING: initial_stock -> INITIAL_STOCK (additive special case) [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:207]
2025-08-26 21:05:56,730 INFO: RESTOCK: Processing 100.0 for item 1 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:43]
2025-08-26 21:05:56,739 INFO: RESTOCK: Classified as lot_creation operation [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:50]
2025-08-26 21:05:56,746 INFO: LOT_CREATION: Adding 100.0 to item 1 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:114]
2025-08-26 21:05:56,755 INFO: FIFO: Created lot LOT-7N9R147 with 100.0 g for item 1 (perishable: False) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:159]
2025-08-26 21:05:56,760 INFO: LOT_CREATION SUCCESS: Will add 100.0 to item 1 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:137]
2025-08-26 21:05:56,766 INFO: RESTOCK SUCCESS: Will increase item 1 by 100.0 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:99]
2025-08-26 21:05:56,772 INFO: QUANTITY UPDATE: Item 1 quantity 0.0 + 100.0 = 100.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:96]
2025-08-26 21:05:56,799 INFO: SUCCESS: restock completed for item 1 (FIFO validated) [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:120]
2025-08-26 21:05:56,806 INFO: CENTRAL DELEGATOR: item_id=1, qty=50.0, type=restock [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:26]
2025-08-26 21:05:56,814 INFO: DELEGATING: restock -> routing to operation module [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:138]
2025-08-26 21:05:56,820 INFO: ROUTING: restock -> ADDITIVE (lot_creation) [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:143]
2025-08-26 21:05:56,826 INFO: RESTOCK: Processing 50.0 for item 1 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:43]
2025-08-26 21:05:56,833 INFO: RESTOCK: Classified as lot_creation operation [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:50]
2025-08-26 21:05:56,839 INFO: LOT_CREATION: Adding 50.0 to item 1 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:114]
2025-08-26 21:05:56,849 INFO: FIFO: Created lot LOT-7NCE1KS with 50.0 g for item 1 (perishable: False) [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:159]
2025-08-26 21:05:56,855 INFO: LOT_CREATION SUCCESS: Will add 50.0 to item 1 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:137]
2025-08-26 21:05:56,861 INFO: RESTOCK SUCCESS: Will increase item 1 by 50.0 [in /home/runner/workspace/app/services/inventory_adjustment/_additive_ops.py:99]
2025-08-26 21:05:56,868 INFO: QUANTITY UPDATE: Item 1 quantity 100.0 + 50.0 = 150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:96]
2025-08-26 21:05:56,886 INFO: SUCCESS: restock completed for item 1 (FIFO validated) [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:120]
2025-08-26 21:05:56,893 INFO: CENTRAL DELEGATOR: item_id=1, qty=-75.0, type=batch [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:26]
2025-08-26 21:05:56,900 INFO: DELEGATING: batch -> routing to operation module [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:138]
2025-08-26 21:05:56,909 INFO: ROUTING: batch -> DEDUCTIVE (consumption) [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:159]
2025-08-26 21:05:56,920 INFO: DEDUCTIVE: Processing batch for item 1, quantity=-75.0 [in /home/runner/workspace/app/services/inventory_adjustment/_deductive_ops.py:64]
2025-08-26 21:05:56,928 INFO: DEDUCTIVE: batch -> consumption group [in /home/runner/workspace/app/services/inventory_adjustment/_deductive_ops.py:72]
2025-08-26 21:05:56,936 INFO: FIFO DEDUCT: Need 75.0, have 150.0 from 2 active lots [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:195]
2025-08-26 21:05:56,943 INFO: FIFO DEDUCT: Consumed 75.0 from lot 1 (LOT-7N9R147), remaining: 25.0 [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:239]
2025-08-26 21:05:56,949 INFO: FIFO DEDUCT SUCCESS: Affected 1 lots [in /home/runner/workspace/app/services/inventory_adjustment/_fifo_ops.py:241]
2025-08-26 21:05:56,955 INFO: DEDUCTIVE SUCCESS: batch will decrease item 1 by 75.0 [in /home/runner/workspace/app/services/inventory_adjustment/_deductive_ops.py:106]
2025-08-26 21:05:56,960 INFO: QUANTITY UPDATE: Item 1 quantity 150.0 + 75.0 = 225.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:96]
2025-08-26 21:05:56,972 ERROR: FIFO SYNC MISMATCH for item 1 (Test Ingredient): [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:38]
2025-08-26 21:05:56,978 ERROR:   Item quantity: 225.0 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:39]
2025-08-26 21:05:56,985 ERROR:   FIFO total: 75.0 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:40]
2025-08-26 21:05:56,991 ERROR:   Difference: 150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:41]
2025-08-26 21:05:56,997 ERROR:   Active FIFO lots: 2 [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:42]
2025-08-26 21:05:57,003 ERROR:     Lot 1: 25.0 (restock, 2025-08-26 21:05:56.751774) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:46]
2025-08-26 21:05:57,008 ERROR:     Lot 2: 50.0 (restock, 2025-08-26 21:05:56.846924) [in /home/runner/workspace/app/services/inventory_adjustment/_validation.py:46]
2025-08-26 21:05:57,012 ERROR: FIFO VALIDATION FAILED before commit for item 1: FIFO sync error: inventory=225.0, fifo_total=75.0, diff=150.0 [in /home/runner/workspace/app/services/inventory_adjustment/_core.py:108]
