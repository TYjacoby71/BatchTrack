2025-07-07 23:45:40,798 ERROR: ValueError in SKU inventory adjustment: Inventory adjustment failed validation: SYNC ERROR: Admin Apple Sauce - Base - Bulk inventory (-15.0) != FIFO total (16.0) [includes frozen expired] [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:215]
2025-07-07 23:45:40,800 INFO: === PRODUCT INVENTORY ADJUSTMENT END === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:227]
2025-07-07 23:45:40,800 INFO: Redirecting to SKU view: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:229]
2025-07-07 23:45:50,207 INFO: === PRODUCT INVENTORY ADJUSTMENT START === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:19]
2025-07-07 23:45:50,207 INFO: Inventory Item ID: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:20]
2025-07-07 23:45:50,207 INFO: User: 2 (admin) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:21]
2025-07-07 23:45:50,207 INFO: Organization: 1 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:22]
2025-07-07 23:45:50,208 INFO: Request method: POST [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:23]
2025-07-07 23:45:50,208 INFO: Request is JSON: False [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:24]
2025-07-07 23:45:50,210 INFO: SKU lookup result: <ProductSKU Admin Apple Sauce - Base - Bulk> [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:32]
2025-07-07 23:45:50,210 INFO: SKU details - inventory_item_id: 4, Product: Admin Apple Sauce, Variant: Base [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:34]
2025-07-07 23:45:50,210 INFO: SKU inventory item: <InventoryItem 4> [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:35]
2025-07-07 23:45:50,211 INFO: Current inventory quantity: -15.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:37]
2025-07-07 23:45:50,211 INFO: Form request data: {'csrf_token': 'IjgxZjU0NjFhZGZhNTJjMzA1YTc3OGI5ZmMyZGI2ZTVlYTViYmEyMWEi.aGxcJA.MYRvJFz848CL1ZNUG1PkNXS9nI4', 'action': 'adjust_fifo', 'inventory_id': '', 'change_type': 'sale', 'quantity': '50', 'notes': '', 'order_id': '', 'sale_price': '10.99', 'restock_cost': '', 'expiration_minutes': '30'} [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:54]
2025-07-07 23:45:50,211 INFO: Extracted quantity: 50 (type: <class 'str'>) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:60]
2025-07-07 23:45:50,211 INFO: Extracted change_type: sale [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:61]
2025-07-07 23:45:50,211 INFO: Converting quantity '50' to float [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:87]
2025-07-07 23:45:50,211 INFO: Converted quantity: 50.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:89]
2025-07-07 23:45:50,212 INFO: Optional fields extracted: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:108]
2025-07-07 23:45:50,212 INFO:   - notes:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:109]
2025-07-07 23:45:50,212 INFO:   - unit: floz [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:110]
2025-07-07 23:45:50,212 INFO:   - customer: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:111]
2025-07-07 23:45:50,212 INFO:   - sale_price: 10.99 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:112]
2025-07-07 23:45:50,212 INFO:   - order_id:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:113]
2025-07-07 23:45:50,213 INFO:   - cost_override: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:114]
2025-07-07 23:45:50,213 INFO: === CALLING CENTRALIZED INVENTORY ADJUSTMENT === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:177]
2025-07-07 23:45:50,213 INFO: Parameters: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:178]
2025-07-07 23:45:50,213 INFO:   - item_id (inventory_item_id): 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:179]
2025-07-07 23:45:50,213 INFO:   - quantity: 50.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:180]
2025-07-07 23:45:50,213 INFO:   - change_type: sale [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:181]
2025-07-07 23:45:50,214 INFO:   - unit: floz [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:182]
2025-07-07 23:45:50,214 INFO:   - notes:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:183]
2025-07-07 23:45:50,214 INFO:   - created_by: 2 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:184]
2025-07-07 23:45:50,214 INFO:   - item_type: product [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:185]
2025-07-07 23:45:50,214 INFO:   - customer: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:186]
2025-07-07 23:45:50,214 INFO:   - sale_price: 10.99 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:187]
2025-07-07 23:45:50,215 INFO:   - order_id:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:188]
2025-07-07 23:45:50,215 INFO:   - cost_override: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:189]
2025-07-07 23:45:50,215 INFO:   - custom_expiration_date: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:190]
2025-07-07 23:45:50,215 INFO:   - custom_shelf_life_days: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:191]
2025-07-07 23:45:50,217 ERROR: ValueError in SKU inventory adjustment: Insufficient fresh FIFO stock (expired lots frozen) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:215]
2025-07-07 23:45:50,217 INFO: === PRODUCT INVENTORY ADJUSTMENT END === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:227]
2025-07-07 23:45:50,217 INFO: Redirecting to SKU view: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:229]
2025-07-07 23:46:00,271 INFO: === PRODUCT INVENTORY ADJUSTMENT START === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:19]
2025-07-07 23:46:00,272 INFO: Inventory Item ID: 4 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:20]
2025-07-07 23:46:00,272 INFO: User: 2 (admin) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:21]
2025-07-07 23:46:00,272 INFO: Organization: 1 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:22]
2025-07-07 23:46:00,272 INFO: Request method: POST [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:23]
2025-07-07 23:46:00,272 INFO: Request is JSON: False [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:24]
2025-07-07 23:46:00,274 INFO: SKU lookup result: <ProductSKU Admin Apple Sauce - Base - Bulk> [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:32]
2025-07-07 23:46:00,274 INFO: SKU details - inventory_item_id: 4, Product: Admin Apple Sauce, Variant: Base [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:34]
2025-07-07 23:46:00,275 INFO: SKU inventory item: <InventoryItem 4> [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:35]
2025-07-07 23:46:00,275 INFO: Current inventory quantity: -15.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:37]
2025-07-07 23:46:00,276 INFO: Form request data: {'csrf_token': 'IjgxZjU0NjFhZGZhNTJjMzA1YTc3OGI5ZmMyZGI2ZTVlYTViYmEyMWEi.aGxcLg.nWUbzxjB89RcH-3vc36oAsTc3mA', 'action': 'adjust_fifo', 'inventory_id': '', 'change_type': 'sale', 'quantity': '10', 'notes': '', 'order_id': '', 'sale_price': '10.99', 'restock_cost': '', 'expiration_minutes': '30'} [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:54]
2025-07-07 23:46:00,276 INFO: Extracted quantity: 10 (type: <class 'str'>) [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:60]
2025-07-07 23:46:00,276 INFO: Extracted change_type: sale [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:61]
2025-07-07 23:46:00,276 INFO: Converting quantity '10' to float [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:87]
2025-07-07 23:46:00,276 INFO: Converted quantity: 10.0 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:89]
2025-07-07 23:46:00,277 INFO: Optional fields extracted: [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:108]
2025-07-07 23:46:00,277 INFO:   - notes:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:109]
2025-07-07 23:46:00,277 INFO:   - unit: floz [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:110]
2025-07-07 23:46:00,277 INFO:   - customer: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:111]
2025-07-07 23:46:00,277 INFO:   - sale_price: 10.99 [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:112]
2025-07-07 23:46:00,278 INFO:   - order_id:  [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:113]
2025-07-07 23:46:00,278 INFO:   - cost_override: None [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:114]
2025-07-07 23:46:00,278 INFO: === CALLING CENTRALIZED INVENTORY ADJUSTMENT === [in /home/runner/workspace/app/blueprints/products/product_inventory_routes.py:177]
