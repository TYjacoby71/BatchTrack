
{% extends 'layout.html' %}
{% block content %}
<form method="post" action="{{ url_for('batches.finish_batch', batch_id=batch.id) }}">
  {{ csrf_token() }}

  <h3>Finish This Batch</h3>

  <div class="mb-3">
    <label for="product_id" class="form-label">Link to Product</label>
    <select name="product_id" class="form-select" required>
      {% for product in products %}
        <option value="{{ product.id }}">{{ product.name }} {% if product.variant %}({{ product.variant }}){% endif %}</option>
      {% endfor %}
    </select>
    <a href="/products/new" class="btn btn-link">+ Add New Product</a>
  </div>

  <div class="mb-3">
    <label for="variant_label" class="form-label">Variant</label>
    <input type="text" class="form-control" name="variant_label" placeholder="e.g., 4 oz, Large">
  </div>

  <div class="mb-3">
    <label for="output_unit" class="form-label">Output Unit</label>
    <select name="output_unit" class="form-select" required>
      {% for unit in units if unit.type == 'count' %}
        <option value="{{ unit.name }}">{{ unit.name }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-3">
    <label for="final_quantity" class="form-label">Final Quantity</label>
    <input type="number" step="1" class="form-control" name="final_quantity" required>
  </div>

  <div class="mb-3">
    <label for="notes" class="form-label">Notes</label>
    <textarea class="form-control" name="notes" rows="3"></textarea>
  </div>

  <button type="submit" class="btn btn-success">Finish Batch</button>
</form>
{% endblock %}
