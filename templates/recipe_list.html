{% extends 'layout.html' %}
{% block content %}
<h2>Recipes</h2>
<a href="{{ url_for('recipes.new_recipe') }}" class="button">New Recipe</a>

<div class="recipe-list">
    {% for recipe in recipes %}
    {% if not recipe.parent_id %}
    <div class="recipe-card">
        <h3>{{ recipe.name }}</h3>
        {% if recipe.variations %}
        <div class="variations mt-2">
            <strong>Variations:</strong>
            <ul class="list-unstyled ms-3">
                {% for var in recipe.variations %}
                <li>â†³ {{ var.name }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <p>Label Prefix: {{ recipe.label_prefix }}</p>
        {% if recipe.instructions %}
        <div class="recipe-instructions">
            <strong>Instructions:</strong>
            <p>{{ recipe.instructions[:100] }}{% if recipe.instructions|length > 100 %}...{% endif %}</p>
        </div>
        {% endif %}
        <div class="recipe-actions">
            <a href="{{ url_for('recipes.edit_recipe', recipe_id=recipe.id) }}" class="button">Edit</a>
            <a href="{{ url_for('recipes.plan_production', recipe_id=recipe.id) }}" class="button">Plan Production</a>
            {% if recipe.qr_image %}
            <a href="{{ url_for('static', filename=recipe.qr_image) }}" class="button" target="_blank">View QR</a>
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}