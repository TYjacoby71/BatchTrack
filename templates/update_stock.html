
{% extends "layout.html" %}
{% block content %}
<h2>ðŸ“¥ Stock Update</h2>
<form method="POST" id="updateForm">
  <div style="margin-bottom: 20px;">
    <h3>Update Ingredients</h3>
    <div id="ingredient-rows">
      <div class="ingredient-row">
        <select name="ingredient_name[]" required>
          <option value="">Select Ingredient</option>
          {% for ing in ingredients %}
          <option value="{{ ing.name }}">{{ ing.name }} (Current: {{ ing.quantity }} {{ ing.unit }})</option>
          {% endfor %}
        </select>
        <input type="number" step="any" name="delta[]" placeholder="Change Amount" required>
        <select name="reason[]" required>
          <option value="Purchase">Purchase (Add)</option>
          <option value="Loss">Loss (Remove)</option>
          <option value="Spoiled">Spoiled (Remove)</option>
          <option value="Donation">Donation (Remove)</option>
        </select>
      </div>
    </div>
    <button type="button" onclick="addIngredientRow()" class="btn">+ Add Another Ingredient</button>
  </div>
  <button type="submit" class="btn btn-primary">Save Changes</button>
</form>

<script>
function addIngredientRow() {
  const container = document.getElementById('ingredient-rows');
  const template = container.querySelector('.ingredient-row').cloneNode(true);
  // Reset the values
  template.querySelectorAll('select, input').forEach(el => el.value = '');
  container.appendChild(template);
}
</script>
{% endblock %}
