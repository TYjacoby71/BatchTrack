
{% extends "layout.html" %}
{% block content %}
<h2>ðŸ“¦ Finished Product Batches</h2>
<a href='/products/export'>Export CSV</a><br><br>

{% if products %}
  <table>
    <tr>
      <th>Product</th>
      <th>Yield</th>
      <th>Unit</th>
      <th>Label Info</th>
      <th>Notes</th>
      <th>Timestamp</th>
    </tr>
    {% for p in products %}
    <tr>
      <td>{{ p.product }}</td>
      <td>{{ p.yield }}</td>
      <td>{{ p.unit }}</td>
      <td>{{ p.label_info or '' }}</td>
      <td>{{ p.notes }}</td>
      <td>
        {% for ts in p.timestamps %}
          {{ ts }}<br>
        {% endfor %}
      </td>
    </tr>
    <tr>
      <td colspan="6">
        <form method="POST" action="/products/event/{{ loop.index0 }}">
          <label>Log Event: </label>
          <select name="event_type">
            <option value="sold">Sold</option>
            <option value="spoiled">Spoiled</option>
            <option value="sampled">Sampled</option>
          </select>
          Qty: <input type="number" name="quantity" required style="width: 60px;">
          <input type="text" name="method" placeholder="POS / Shopify / Farmer's Market" style="width: 160px;">
          <input type="text" name="note" placeholder="optional note" style="width: 200px;">
          <button type="submit">Submit</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </table>
{% else %}
  <p>No finished product batches recorded yet.</p>
{% endif %}
{% endblock %}
