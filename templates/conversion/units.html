{% extends "layout.html" %}
{% block content %}
<h2>All Units</h2>

{% set types = units | map(attribute="type") | unique | list %}

{% for unit_type in types %}
  <h3>{{ unit_type | title }} Units</h3>
  <ul>
    {% for unit in units if unit.type == unit_type and not unit.custom %}
      <li>{{ unit.name }}</li>
    {% endfor %}
  </ul>

  {% set custom_units = units | selectattr("custom") | selectattr("type", "equalto", unit_type) | list %}
  {% if custom_units %}
    <h5>Custom:</h5>
    <ul>
      {% for unit in custom_units %}
        <li>{{ unit.name }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endfor %}

<div class="card p-3 mb-3">
  <h4>Add New Unit</h4>
  <form method="POST" action="{{ url_for('conversion.manage_units') }}">
    <div class="row">
      <div class="col">
        <label>Name:</label>
        <input type="text" name="name" class="form-control" required>
      </div>
      <div class="col">
        <label>Type:</label>
        <select name="type" class="form-control" required>
          <option value="weight">Weight</option>
          <option value="volume">Volume</option>
          <option value="count">Count</option>
          <option value="length">Length</option>
          <option value="area">Area</option>
          <option value="time">Time</option>
        </select>
      </div>
      <div class="col">
        <label>Base Unit:</label>
        <input type="text" name="base_unit" class="form-control" required>
      </div>
      <div class="col">
        <label>Multiplier:</label>
        <input type="number" step="0.0001" name="multiplier" class="form-control" required>
      </div>
      <div class="col d-flex align-items-end">
        <button type="submit" class="btn btn-primary">Add Unit</button>
      </div>
    </div>
  </form>
</div>
{% endblock %}