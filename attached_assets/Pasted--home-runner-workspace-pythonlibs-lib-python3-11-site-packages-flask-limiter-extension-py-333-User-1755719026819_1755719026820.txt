/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-20 19:42:18,188] INFO in unit_utils: BatchTrack startup
 * Serving Flask app 'app'
 * Debug mode: on
2025-08-20 19:42:18,209 INFO: WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://172.31.108.34:5000
2025-08-20 19:42:18,209 INFO: Press CTRL+C to quit
2025-08-20 19:42:18,210 INFO:  * Restarting with stat
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-20 19:42:19,879] INFO in unit_utils: BatchTrack startup
2025-08-20 19:42:19,891 WARNING:  * Debugger is active!
2025-08-20 19:42:19,896 INFO:  * Debugger PIN: 327-731-695
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: index
2025-08-20 19:42:20,135 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:20] "GET / HTTP/1.1" 302 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /organization/dashboard, endpoint=organization.dashboard
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
[2025-08-20 19:42:20,222] INFO in stripe_service: Stripe initialized successfully
2025-08-20 19:42:20,222 INFO: Stripe initialized successfully
2025-08-20 19:42:20,228 INFO: message='Request to Stripe api' method=get url=https://api.stripe.com/v1/prices?lookup_keys[0]=batchtrack_solo_monthly&active=true&limit=1
2025-08-20 19:42:20,228 DEBUG: api_version=2025-06-30.basil message='Post details' post_data=lookup_keys[0]=batchtrack_solo_monthly&active=true&limit=1
2025-08-20 19:42:20,230 DEBUG: Starting new HTTPS connection (1): api.stripe.com:443
2025-08-20 19:42:20,427 DEBUG: https://api.stripe.com:443 "GET /v1/prices?lookup_keys%5B0%5D=batchtrack_solo_monthly&active=true&limit=1 HTTP/1.1" 200 839
2025-08-20 19:42:20,428 INFO: message='Stripe API response' path=https://api.stripe.com/v1/prices?lookup_keys[0]=batchtrack_solo_monthly&active=true&limit=1 response_code=200
2025-08-20 19:42:20,428 DEBUG: body='{\n  "object": "list",\n  "data": [\n    {\n      "id": "price_1RnRlnF4Y9XQgiJBzKnYadVL",\n      "object": "price",\n      "active": true,\n      "billing_scheme": "per_unit",\n      "created": 1753135275,\n      "currency": "usd",\n      "custom_unit_amount": null,\n      "livemode": true,\n      "lookup_key": "batchtrack_solo_monthly",\n      "metadata": {},\n      "nickname": "Solo Monthly",\n      "product": "prod_SitYi7JOtdlJ7b",\n      "recurring": {\n        "interval": "month",\n        "interval_count": 1,\n        "meter": null,\n        "trial_period_days": null,\n        "usage_type": "licensed"\n      },\n      "tax_behavior": "unspecified",\n      "tiers_mode": null,\n      "transform_quantity": null,\n      "type": "recurring",\n      "unit_amount": 0,\n      "unit_amount_decimal": "0"\n    }\n  ],\n  "has_more": false,\n  "url": "/v1/prices"\n}' message='API response body'
2025-08-20 19:42:20,428 DEBUG: link=https://dashboard.stripe.com/live/logs/req_JF9Y3SStrR2mMs message='Dashboard link for request'
[2025-08-20 19:42:20,430] INFO in stripe_service: Stripe initialized successfully
2025-08-20 19:42:20,430 INFO: Stripe initialized successfully
2025-08-20 19:42:20,431 INFO: message='Request to Stripe api' method=get url=https://api.stripe.com/v1/prices?lookup_keys[0]=batchtrack_team_monthly&active=true&limit=1
2025-08-20 19:42:20,431 DEBUG: api_version=2025-06-30.basil message='Post details' post_data=lookup_keys[0]=batchtrack_team_monthly&active=true&limit=1
2025-08-20 19:42:20,561 DEBUG: https://api.stripe.com:443 "GET /v1/prices?lookup_keys%5B0%5D=batchtrack_team_monthly&active=true&limit=1 HTTP/1.1" 200 835
2025-08-20 19:42:20,562 INFO: message='Stripe API response' path=https://api.stripe.com/v1/prices?lookup_keys[0]=batchtrack_team_monthly&active=true&limit=1 response_code=200
2025-08-20 19:42:20,562 DEBUG: body='{\n  "object": "list",\n  "data": [\n    {\n      "id": "price_1RnRzOF4Y9XQgiJB7cuiGZf4",\n      "object": "price",\n      "active": true,\n      "billing_scheme": "per_unit",\n      "created": 1753136118,\n      "currency": "usd",\n      "custom_unit_amount": null,\n      "livemode": true,\n      "lookup_key": "batchtrack_team_monthly",\n      "metadata": {},\n      "nickname": null,\n      "product": "prod_SitmVnokhyMVZ8",\n      "recurring": {\n        "interval": "month",\n        "interval_count": 1,\n        "meter": null,\n        "trial_period_days": null,\n        "usage_type": "licensed"\n      },\n      "tax_behavior": "unspecified",\n      "tiers_mode": null,\n      "transform_quantity": null,\n      "type": "recurring",\n      "unit_amount": 1499,\n      "unit_amount_decimal": "1499"\n    }\n  ],\n  "has_more": false,\n  "url": "/v1/prices"\n}' message='API response body'
2025-08-20 19:42:20,562 DEBUG: link=https://dashboard.stripe.com/live/logs/req_JRaHns9yX2Fqwe message='Dashboard link for request'
[2025-08-20 19:42:20,562] INFO in stripe_service: Stripe initialized successfully
2025-08-20 19:42:20,562 INFO: Stripe initialized successfully
2025-08-20 19:42:20,563 INFO: message='Request to Stripe api' method=get url=https://api.stripe.com/v1/prices?lookup_keys[0]=batchtrack_enterprise_monthly&active=true&limit=1
2025-08-20 19:42:20,563 DEBUG: api_version=2025-06-30.basil message='Post details' post_data=lookup_keys[0]=batchtrack_enterprise_monthly&active=true&limit=1
2025-08-20 19:42:20,700 DEBUG: https://api.stripe.com:443 "GET /v1/prices?lookup_keys%5B0%5D=batchtrack_enterprise_monthly&active=true&limit=1 HTTP/1.1" 200 841
2025-08-20 19:42:20,701 INFO: message='Stripe API response' path=https://api.stripe.com/v1/prices?lookup_keys[0]=batchtrack_enterprise_monthly&active=true&limit=1 response_code=200
2025-08-20 19:42:20,701 DEBUG: body='{\n  "object": "list",\n  "data": [\n    {\n      "id": "price_1RnS8pF4Y9XQgiJBr3Wq1LIH",\n      "object": "price",\n      "active": true,\n      "billing_scheme": "per_unit",\n      "created": 1753136703,\n      "currency": "usd",\n      "custom_unit_amount": null,\n      "livemode": true,\n      "lookup_key": "batchtrack_enterprise_monthly",\n      "metadata": {},\n      "nickname": null,\n      "product": "prod_SitwN8yYtFrNcM",\n      "recurring": {\n        "interval": "month",\n        "interval_count": 1,\n        "meter": null,\n        "trial_period_days": null,\n        "usage_type": "licensed"\n      },\n      "tax_behavior": "unspecified",\n      "tiers_mode": null,\n      "transform_quantity": null,\n      "type": "recurring",\n      "unit_amount": 1999,\n      "unit_amount_decimal": "1999"\n    }\n  ],\n  "has_more": false,\n  "url": "/v1/prices"\n}' message='API response body'
2025-08-20 19:42:20,701 DEBUG: link=https://dashboard.stripe.com/live/logs/req_IIVgGPCCmlBvjc message='Dashboard link for request'
Permission categories: ['dashboard', 'inventory_management', 'recipe_management', 'batch_production', 'product_management', 'organization_management', 'alerts_notifications', 'reports_analytics', 'integrations', 'ai_features']
Total permissions: 44
Roles count: 1
Users count: 3
[2025-08-20 19:42:20,726] INFO in unit_utils: Getting global unit list
2025-08-20 19:42:20,726 INFO: Getting global unit list
[2025-08-20 19:42:20,765] DEBUG in permissions: Permission tags.manage not allowed by tier exempt
2025-08-20 19:42:20,765 DEBUG: Permission tags.manage not allowed by tier exempt
[2025-08-20 19:42:20,765] DEBUG in permissions: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:42:20,765 DEBUG: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:42:20,797 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:20] "GET /organization/dashboard HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,026 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,055 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/js/main.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,084 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/js/utils/utils.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,120 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/js/inventory/inventory_adjust.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,124 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/js/conversion/unit_converter.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,149 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/js/organization/dashboard.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,184 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/js/expiration_alerts.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:21,187 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /api/server-time, endpoint=public_api.server_time
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
2025-08-20 19:42:21,399 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:21] "GET /api/server-time HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /recipes/, endpoint=recipes.list_recipes
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
[2025-08-20 19:42:48,725] INFO in unit_utils: Getting global unit list
2025-08-20 19:42:48,725 INFO: Getting global unit list
[2025-08-20 19:42:48,766] DEBUG in permissions: Permission tags.manage not allowed by tier exempt
2025-08-20 19:42:48,766 DEBUG: Permission tags.manage not allowed by tier exempt
[2025-08-20 19:42:48,767] DEBUG in permissions: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:42:48,767 DEBUG: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:42:48,774 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:48] "GET /recipes/ HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:48,892 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:48] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:49,051 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /static/js/utils/utils.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:49,057 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /static/js/main.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:49,059 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /static/js/inventory/inventory_adjust.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:49,086 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /static/js/expiration_alerts.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:49,088 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /static/js/conversion/unit_converter.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:42:49,121 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /api/server-time, endpoint=public_api.server_time
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
2025-08-20 19:42:49,578 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:49] "GET /api/server-time HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /recipes/1/plan, endpoint=recipes.plan_production_route
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
2025-08-20 19:42:50,017 INFO: 172.31.108.34 - - [20/Aug/2025 19:42:50] "GET /recipes/1/plan HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /recipes/1/plan, endpoint=recipes.plan_production_route
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
2025-08-20 19:43:15,600 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:15] "GET /recipes/1/plan HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /recipes/, endpoint=recipes.list_recipes
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
[2025-08-20 19:43:20,357] INFO in unit_utils: Getting global unit list
2025-08-20 19:43:20,357 INFO: Getting global unit list
[2025-08-20 19:43:20,376] DEBUG in permissions: Permission tags.manage not allowed by tier exempt
2025-08-20 19:43:20,376 DEBUG: Permission tags.manage not allowed by tier exempt
[2025-08-20 19:43:20,376] DEBUG in permissions: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:43:20,376 DEBUG: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:43:20,378 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /recipes/ HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,493 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,631 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/js/main.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,633 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/js/utils/utils.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,657 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/js/inventory/inventory_adjust.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,664 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/js/conversion/unit_converter.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,689 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/js/expiration_alerts.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:20,706 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /api/server-time, endpoint=public_api.server_time
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
2025-08-20 19:43:20,906 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:20] "GET /api/server-time HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /recipes/new, endpoint=recipes.new_recipe
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
[2025-08-20 19:43:23,602] INFO in unit_utils: Getting global unit list
2025-08-20 19:43:23,602 INFO: Getting global unit list
[2025-08-20 19:43:23,650] DEBUG in permissions: Permission tags.manage not allowed by tier exempt
2025-08-20 19:43:23,650 DEBUG: Permission tags.manage not allowed by tier exempt
[2025-08-20 19:43:23,651] DEBUG in permissions: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:43:23,651 DEBUG: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:43:23,666 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:23] "GET /recipes/new HTTP/1.1" 500 -
Traceback (most recent call last):
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py", line 1536, in __call__
    return self.wsgi_app(environ, start_response)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py", line 1514, in wsgi_app
    response = self.handle_exception(e)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_login/utils.py", line 290, in decorated_view
    return current_app.ensure_sync(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/app/blueprints/recipes/routes.py", line 49, in new_recipe
    return render_template('recipe_form.html', recipe=None, **form_data)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/templating.py", line 150, in render_template
    return _render(app, template, context)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask/templating.py", line 131, in _render
    rv = template.render(context)
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/jinja2/environment.py", line 1295, in render
    self.environment.handle_exception()
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/jinja2/environment.py", line 942, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "/home/runner/workspace/app/templates/recipe_form.html", line 1, in top-level template code
    {% extends 'layout.html' %}
  File "/home/runner/workspace/app/templates/layout.html", line 300, in top-level template code
    {% block content %}{% endblock %}
  File "/home/runner/workspace/app/templates/recipe_form.html", line 286, in block 'content'
    {% include 'components/modals/quick_add_ingredient_modal.html' %}
  File "/home/runner/workspace/app/templates/components/modals/quick_add_ingredient_modal.html", line 25, in top-level template code
    {% for unit in get_global_unit_list() %}
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/jinja2/utils.py", line 92, in from_obj
    if hasattr(obj, "jinja_pass_arg"):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
jinja2.exceptions.UndefinedError: 'get_global_unit_list' is undefined
2025-08-20 19:43:23,756 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:23] "GET /recipes/new?__debugger__=yes&cmd=resource&f=debugger.js HTTP/1.1" 200 -
2025-08-20 19:43:23,764 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:23] "GET /recipes/new?__debugger__=yes&cmd=resource&f=style.css HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /recipes/, endpoint=recipes.list_recipes
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
[2025-08-20 19:43:27,082] INFO in unit_utils: Getting global unit list
2025-08-20 19:43:27,082 INFO: Getting global unit list
[2025-08-20 19:43:27,102] DEBUG in permissions: Permission tags.manage not allowed by tier exempt
2025-08-20 19:43:27,102 DEBUG: Permission tags.manage not allowed by tier exempt
[2025-08-20 19:43:27,102] DEBUG in permissions: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:43:27,102 DEBUG: Permission dev.system_admin not allowed by tier exempt
2025-08-20 19:43:27,104 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /recipes/ HTTP/1.1" 200 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:27,170 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/style.css HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:27,272 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/js/utils/utils.js HTTP/1.1" 304 -
2025-08-20 19:43:27,273 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/js/main.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:27,278 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/style.css HTTP/1.1" 304 -
2025-08-20 19:43:27,278 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/js/inventory/inventory_adjust.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:27,280 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/js/conversion/unit_converter.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Allowing public endpoint: static
2025-08-20 19:43:27,327 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /static/js/expiration_alerts.js HTTP/1.1" 304 -
--- EXECUTING CORRECT MIDDLEWARE ---
MIDDLEWARE DEBUG: Processing GET /api/server-time, endpoint=public_api.server_time
MIDDLEWARE DEBUG: User authenticated=True
DEBUG: User 2, Org billing_status=active
DEBUG: Tier exempt=True
DEBUG: Tier is billing exempt, allowing access
2025-08-20 19:43:27,718 INFO: 172.31.108.34 - - [20/Aug/2025 19:43:27] "GET /api/server-time HTTP/1.1" 200 -