~/workspace$ flask db history
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
flask[2025-08-11 20:29:44,156] INFO in unit_utils: BatchTrack startup
 132971c1d456 -> add_unique_constraint_stripe_event_id (head), add unique constraint on stripe event id
c8f2e5a9b1d4 -> fix_product_sku_name_column (head), fix product_sku name column mismatch
fix_unit_symbol_nullable -> c8f2e5a9b1d4, fix fallback_price column type from Numeric to String
b5c7d8e9f1a2 -> fix_unit_symbol_nullable, make unit symbol nullable for custom units
9a2b8c4d5e6f -> b5c7d8e9f1a2, replace billing provider booleans with enum fields
add_fallback_price_column -> 9a2b8c4d5e6f, fix missing oauth columns postgresql
fix_missing_email_verification -> add_fallback_price_column, add_fallback_price_column
4246268c4e7c -> fix_missing_email_verification, fix missing email verification columns
3f7a8b9c2d5e -> 4246268c4e7c, add_oauth_and_email_verification_fields
add_offline_billing_support -> 3f7a8b9c2d5e, Add offline billing support and missing billing fields
drop_deprecated_billing_columns -> add_offline_billing_support, Add offline billing support
f4e5d6c7b8a9 -> drop_deprecated_billing_columns, drop deprecated billing columns
0e15af770cb3 -> f4e5d6c7b8a9, remove nonexistent billing columns
a1b2c3d4e5f6789012345678901234ab -> 0e15af770cb3, simplify subscription tier model - remove billing fields
whop_integration -> a1b2c3d4e5f6789012345678901234ab, Add Whop integration fields to SubscriptionTier
add_billing_columns_org -> whop_integration, Add Whop integration fields to Organization
1a2b3c4d5e6f -> add_billing_columns_org, add billing columns to organization
9d2a5c7f8b1e -> 1a2b3c4d5e6f, force drop unwanted columns
8b7aa70df87d -> 9d2a5c7f8b1e, fix inventory history constraints
fix_password_hash_length -> 8b7aa70df87d, fix user_role_assignment constraints to allow NULL role_id for developer roles
add_missing_table_schemas -> fix_password_hash_length, fix password_hash column length
add_missing_created_at_columns -> add_missing_table_schemas, add missing table schemas for billing_snapshot, pricing_snapshot, and statistics
add_unit_timestamps -> add_missing_created_at_columns, add missing created_at and updated_at columns to all models
fix_nullable_constraints -> add_unit_timestamps, add missing timestamp columns to unit table
add_missing_timestamps -> fix_nullable_constraints, fix nullable columns and add constraints
f3b0e59fe9c1 -> add_missing_timestamps, add missing timestamp columns
132971c1d456 -> f3b0e59fe9c1, add missing recipe columns
4481595c5f02 -> 132971c1d456 (branchpoint), add all missing columns to match model definitions
<base> -> 4481595c5f02, empty message
d~/workspace$ flask db heads
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:29:53,153] INFO in unit_utils: BatchTrack startup
add_unique_constraint_stripe_event_id (head)
fix_product_sku_name_column (head)
~/workspace$ flask db downgrade fix_product_sku_name_column
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:33:09,116] INFO in unit_utils: BatchTrack startup
INFO  [alembic.env] Imported model module: app.models.batch
INFO  [alembic.env] Imported model module: app.models.billing_snapshot
INFO  [alembic.env] Imported model module: app.models.category
INFO  [alembic.env] Imported model module: app.models.developer_permission
INFO  [alembic.env] Imported model module: app.models.developer_role
INFO  [alembic.env] Imported model module: app.models.inventory
INFO  [alembic.env] Imported model module: app.models.mixins
INFO  [alembic.env] Imported model module: app.models.models
INFO  [alembic.env] Imported model module: app.models.permission
INFO  [alembic.env] Imported model module: app.models.pricing_snapshot
INFO  [alembic.env] Imported model module: app.models.product
INFO  [alembic.env] Imported model module: app.models.recipe
INFO  [alembic.env] Imported model module: app.models.reservation
INFO  [alembic.env] Imported model module: app.models.role
INFO  [alembic.env] Imported model module: app.models.statistics
INFO  [alembic.env] Imported model module: app.models.stripe_event
INFO  [alembic.env] Imported model module: app.models.subscription_tier
INFO  [alembic.env] Imported model module: app.models.unit
INFO  [alembic.env] Imported model module: app.models.user_preferences
INFO  [alembic.env] Imported model module: app.models.user_role_assignment
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
~/workspace$ flask db heads
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:33:16,838] INFO in unit_utils: BatchTrack startup
add_unique_constraint_stripe_event_id (head)
~/workspace$ flask db stamp fix_product_sku_name_column
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:33:43,211] INFO in unit_utils: BatchTrack startup
INFO  [alembic.env] Imported model module: app.models.batch
INFO  [alembic.env] Imported model module: app.models.billing_snapshot
INFO  [alembic.env] Imported model module: app.models.category
INFO  [alembic.env] Imported model module: app.models.developer_permission
INFO  [alembic.env] Imported model module: app.models.developer_role
INFO  [alembic.env] Imported model module: app.models.inventory
INFO  [alembic.env] Imported model module: app.models.mixins
INFO  [alembic.env] Imported model module: app.models.models
INFO  [alembic.env] Imported model module: app.models.permission
INFO  [alembic.env] Imported model module: app.models.pricing_snapshot
INFO  [alembic.env] Imported model module: app.models.product
INFO  [alembic.env] Imported model module: app.models.recipe
INFO  [alembic.env] Imported model module: app.models.reservation
INFO  [alembic.env] Imported model module: app.models.role
INFO  [alembic.env] Imported model module: app.models.statistics
INFO  [alembic.env] Imported model module: app.models.stripe_event
INFO  [alembic.env] Imported model module: app.models.subscription_tier
INFO  [alembic.env] Imported model module: app.models.unit
INFO  [alembic.env] Imported model module: app.models.user_preferences
INFO  [alembic.env] Imported model module: app.models.user_role_assignment
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
~/workspace$ flask db heads
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:34:18,277] INFO in unit_utils: BatchTrack startup
add_unique_constraint_stripe (head)
~/workspace$ flask db history
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:34:31,329] INFO in unit_utils: BatchTrack startup
fix_product_sku_name_column -> add_unique_constraint_stripe (head), add unique constraint on stripe event id
c8f2e5a9b1d4 -> fix_product_sku_name_column, fix product_sku name column mismatch
fix_unit_symbol_nullable -> c8f2e5a9b1d4, fix fallback_price column type from Numeric to String
b5c7d8e9f1a2 -> fix_unit_symbol_nullable, make unit symbol nullable for custom units
9a2b8c4d5e6f -> b5c7d8e9f1a2, replace billing provider booleans with enum fields
add_fallback_price_column -> 9a2b8c4d5e6f, fix missing oauth columns postgresql
fix_missing_email_verification -> add_fallback_price_column, add_fallback_price_column
4246268c4e7c -> fix_missing_email_verification, fix missing email verification columns
3f7a8b9c2d5e -> 4246268c4e7c, add_oauth_and_email_verification_fields
add_offline_billing_support -> 3f7a8b9c2d5e, Add offline billing support and missing billing fields
drop_deprecated_billing_columns -> add_offline_billing_support, Add offline billing support
f4e5d6c7b8a9 -> drop_deprecated_billing_columns, drop deprecated billing columns
0e15af770cb3 -> f4e5d6c7b8a9, remove nonexistent billing columns
a1b2c3d4e5f6789012345678901234ab -> 0e15af770cb3, simplify subscription tier model - remove billing fields
whop_integration -> a1b2c3d4e5f6789012345678901234ab, Add Whop integration fields to SubscriptionTier
add_billing_columns_org -> whop_integration, Add Whop integration fields to Organization
1a2b3c4d5e6f -> add_billing_columns_org, add billing columns to organization
9d2a5c7f8b1e -> 1a2b3c4d5e6f, force drop unwanted columns
8b7aa70df87d -> 9d2a5c7f8b1e, fix inventory history constraints
fix_password_hash_length -> 8b7aa70df87d, fix user_role_assignment constraints to allow NULL role_id for developer roles
add_missing_table_schemas -> fix_password_hash_length, fix password_hash column length
add_missing_created_at_columns -> add_missing_table_schemas, add missing table schemas for billing_snapshot, pricing_snapshot, and statistics
add_unit_timestamps -> add_missing_created_at_columns, add missing created_at and updated_at columns to all models
fix_nullable_constraints -> add_unit_timestamps, add missing timestamp columns to unit table
add_missing_timestamps -> fix_nullable_constraints, fix nullable columns and add constraints
f3b0e59fe9c1 -> add_missing_timestamps, add missing timestamp columns
132971c1d456 -> f3b0e59fe9c1, add missing recipe columns
4481595c5f02 -> 132971c1d456, add all missing columns to match model definitions
<base> -> 4481595c5f02, empty message
~/workspace$ flask db upgrade
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
  warnings.warn(
[2025-08-11 20:34:46,768] INFO in unit_utils: BatchTrack startup
INFO  [alembic.env] Imported model module: app.models.batch
INFO  [alembic.env] Imported model module: app.models.billing_snapshot
INFO  [alembic.env] Imported model module: app.models.category
INFO  [alembic.env] Imported model module: app.models.developer_permission
INFO  [alembic.env] Imported model module: app.models.developer_role
INFO  [alembic.env] Imported model module: app.models.inventory
INFO  [alembic.env] Imported model module: app.models.mixins
INFO  [alembic.env] Imported model module: app.models.models
INFO  [alembic.env] Imported model module: app.models.permission
INFO  [alembic.env] Imported model module: app.models.pricing_snapshot
INFO  [alembic.env] Imported model module: app.models.product
INFO  [alembic.env] Imported model module: app.models.recipe
INFO  [alembic.env] Imported model module: app.models.reservation
INFO  [alembic.env] Imported model module: app.models.role
INFO  [alembic.env] Imported model module: app.models.statistics
INFO  [alembic.env] Imported model module: app.models.stripe_event
INFO  [alembic.env] Imported model module: app.models.subscription_tier
INFO  [alembic.env] Imported model module: app.models.unit
INFO  [alembic.env] Imported model module: app.models.user_preferences
INFO  [alembic.env] Imported model module: app.models.user_role_assignment
INFO  [alembic.runtime.migration] Context impl SQLiteImpl.
INFO  [alembic.runtime.migration] Will assume non-transactional DDL.
INFO  [alembic.runtime.migration] Running upgrade fix_product_sku_name_column -> add_unique_constraint_stripe, add unique constraint on stripe event id
ERROR [flask_migrate] Error: No support for ALTER of constraints in SQLite dialect. Please refer to the batch mode feature which allows for SQLite migrations using a copy-and-move strategy.