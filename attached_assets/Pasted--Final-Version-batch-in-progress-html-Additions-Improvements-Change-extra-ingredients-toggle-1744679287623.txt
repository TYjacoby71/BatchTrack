✅ Final Version – batch_in_progress.html Additions
🎯 Improvements:

Change extra ingredients toggle button text to: "Extra Ingredients Used"

Clicking it adds a row and toggles visibility if first time

Each added row now has a ❌ delete button

Ingredient selector uses a searchable select box (Select2 compatible)

Units pulled from inventory_units

Timers now appear as 🗓️ icon buttons with editable fields and delete buttons

🔧 Replace this block inside your main <form>
Find this section in your current batch_in_progress.html and replace it fully:

html
Copy
Edit
<!-- Toggleable Extra Ingredients -->
<div class="form-group mt-4">
    <button type="button" class="btn btn-outline-primary" onclick="toggleExtraIngredients()">+ Extra Inventory Used</button>
    <div id="extra-ingredients" style="display:none;">
        <div id="ingredientInputs"></div>
        <button type="button" class="btn btn-secondary btn-sm mt-2" onclick="addIngredientRow()">+ Add Ingredient Row</button>
    </div>
</div>
✅ With This New Version:
html
Copy
Edit
<!-- Extra Ingredients Used Section -->
<div class="form-group mt-4">
    <button type="button" class="btn btn-outline-primary" onclick="addIngredientRow()">+ Extra Ingredients Used</button>
    <div id="ingredientInputs" class="mt-3"></div>
</div>

<!-- Timer Section -->
<div class="form-group mt-4">
    <h4>Batch Timers</h4>
    <div id="timer-container"></div>
    <button type="button" class="btn btn-outline-secondary btn-sm mt-2" onclick="addTimer()">🗓️ Add Timer</button>
</div>

<!-- JS -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
function addIngredientRow() {
    const wrapper = document.getElementById('ingredientInputs');
    const row = document.createElement('div');
    row.classList.add('ingredient-row', 'mb-3');
    row.innerHTML = `
        <div class="d-flex gap-2 flex-wrap">
            <select name="extra_ingredients[]" class="form-select ingredient-select" required>
                <option value="">Select Ingredient</option>
                {% for ing in all_ingredients %}
                <option value="{{ ing.name }}">{{ ing.name }}</option>
                {% endfor %}
            </select>
            <input type="number" name="extra_amounts[]" step="0.01" placeholder="Amount" class="form-control" required>
            <select name="extra_units[]" class="form-select" required>
                <option value="">Unit</option>
                {% for unit in inventory_units %}
                <option value="{{ unit.name }}">{{ unit.name }}</option>
                {% endfor %}
            </select>
            <button type="button" class="btn btn-sm btn-danger" onclick="this.closest('.ingredient-row').remove()">❌</button>
        </div>
    `;
    wrapper.appendChild(row);

    // Enable Select2 search box
    setTimeout(() => {
        $(row.querySelector('.ingredient-select')).select2({
            width: '200px',
            placeholder: "Search Ingredient"
        });
    }, 0);
}

function addTimer() {
    const container = document.getElementById('timer-container');
    const div = document.createElement('div');
    div.classList.add('timer-entry', 'd-flex', 'align-items-center', 'gap-2', 'mb-2');
    div.innerHTML = `
        <input type="datetime-local" name="batch_timers[]" class="form-control" style="max-width: 250px;" required>
        <button type="button" class="btn btn-sm btn-outline-danger" onclick="this.parentElement.remove()">❌</button>
    `;
    container.appendChild(div);
}
</script>
✅ This completes the refined front-end logic for your batch in progress ingredient + timer UX.

Let me know once you've pasted this into batch_in_progress.html and tested — then I’ll give you the backend changes (if any) or move to the batch list view upgrade (Step 2).