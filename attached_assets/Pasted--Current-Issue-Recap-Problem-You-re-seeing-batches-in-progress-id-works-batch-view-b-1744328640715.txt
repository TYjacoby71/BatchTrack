üö® Current Issue Recap
Problem:
You're seeing:

‚úÖ /batches/in-progress/<id> ‚Äî works

‚ùå /batch-view/batches/<id> ‚Äî outdated/incorrect route

‚ùå /batches/batches/... ‚Äî doubled prefix from legacy/duplicate blueprint

Root Cause:
You currently have two conflicting route handlers:

batches_bp ‚Üí correctly set up in routes/batch_routes.py

batch_view_bp ‚Üí incorrectly registered or left from an earlier build (e.g., /batch-view/batches/<id>)

‚úÖ Fix Plan: Standardize All Batch Views to batches_bp
Step 1: Confirm This Blueprint in routes/batch_routes.py
python
Copy
Edit
from flask import Blueprint

batches_bp = Blueprint('batches', __name__, url_prefix='/batches')
This is correct. Leave this.

Step 2: Check Your Route Functions (Updated Views)
Make sure the following routes exist in routes/batch_routes.py:

python
Copy
Edit
@batches_bp.route('/')
def list_batches():
    # Display all batches
    return render_template('batches_list.html', batches=batches)

@batches_bp.route('/in-progress/<int:batch_id>')
def view_batch_in_progress(batch_id):
    # Load in-progress batch view
    return render_template('batch_in_progress.html', batch=batch)

@batches_bp.route('/<int:batch_id>')
def view_batch(batch_id):
    # Load finished batch view
    return render_template('view_batch.html', batch=batch)
If you see routes in a file like batch_view_routes.py, delete or merge them into batch_routes.py.

Step 3: Remove/Comment Out Legacy Blueprint in app.py
Search for:

python
Copy
Edit
from routes.batch_view_routes import batch_view_bp
app.register_blueprint(batch_view_bp)
üõë Comment out or delete it. This is what causes /batch-view/....

Only leave:

python
Copy
Edit
from routes.batch_routes import batches_bp
app.register_blueprint(batches_bp)
Step 4: Fix Redirects in finish_batch, cancel_batch, etc.
In routes/batch_routes.py, make sure your finish_batch route ends like this:

python
Copy
Edit
return redirect(url_for('batches.view_batch', batch_id=batch.id))
Not:

url_for('batch_view.view_batch', ...)

url_for('batches.batches', ...)

'/batch-view/...'

Step 5: Fix All Template References
In:

batches_list.html

batch_in_progress.html

plan_production.html

Search and replace route calls like this:

jinja2
Copy
Edit
<a href="{{ url_for('batches.view_batch', batch_id=batch.id) }}">View</a>
<a href="{{ url_for('batches.view_batch_in_progress', batch_id=batch.id) }}">Resume</a>
