============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.3.5, pluggy-1.5.0 -- /home/runner/workspace/.pythonlibs/bin/python
cachedir: .pytest_cache
rootdir: /home/runner/workspace
collected 16 items                                                             

tests/test_signup_tiers.py::TestSignupTierCharacterization::test_signup_endpoint_exists ERROR [  6%]
tests/test_signup_tiers.py::TestSignupTierCharacterization::test_tier_bypass_behavior ERROR [ 12%]
tests/test_signup_tiers.py::TestSignupTierCharacterization::test_organization_tier_assignment ERROR [ 18%]
tests/test_signup_tiers.py::TestSignupTierCharacterization::test_permission_gating_exists ERROR [ 25%]
tests/test_signup_tiers.py::TestSignupTierCharacterization::test_signup_service_delegation ERROR [ 31%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_tier_permission_is_the_hard_ceiling ERROR [ 37%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[active-200] ERROR [ 43%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[past_due-302] ERROR [ 50%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[suspended-302] ERROR [ 56%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[canceled-302] ERROR [ 62%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_developer_can_masquerade_regardless_of_billing ERROR [ 68%]
tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_complete_security_cascade ERROR [ 75%]
tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_stripe_service_exists ERROR [ 81%]
tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_webhook_signature_verification_path_exists ERROR [ 87%]
tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_webhook_idempotency_behavior ERROR [ 93%]
tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_stripe_service_methods_exist ERROR [100%]

==================================== ERRORS ====================================
_ ERROR at setup of TestSignupTierCharacterization.test_signup_endpoint_exists _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app:unit_utils.py:28 BatchTrack startup
__ ERROR at setup of TestSignupTierCharacterization.test_tier_bypass_behavior __
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestSignupTierCharacterization.test_organization_tier_assignment _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestSignupTierCharacterization.test_permission_gating_exists _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestSignupTierCharacterization.test_signup_service_delegation _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_tier_permission_is_the_hard_ceiling _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_billing_status_enforcement[active-200] _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_billing_status_enforcement[past_due-302] _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_billing_status_enforcement[suspended-302] _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_billing_status_enforcement[canceled-302] _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_developer_can_masquerade_regardless_of_billing _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestBillingAndTierEnforcement.test_complete_security_cascade _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestStripeWebhookCharacterization.test_stripe_service_exists _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestStripeWebhookCharacterization.test_webhook_signature_verification_path_exists _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestStripeWebhookCharacterization.test_webhook_idempotency_behavior _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
_ ERROR at setup of TestStripeWebhookCharacterization.test_stripe_service_methods_exist _
tests/conftest.py:31: in app
    _create_test_data()
tests/conftest.py:86: in _create_test_data
    db.session.add(org)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/scoping.py:380: in add
    return self._proxied.add(instance, _warn=_warn)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3481: in add
    self._save_or_update_state(state)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py:3508: in _save_or_update_state
    for o, m, st_, dct_ in mapper.cascade_iterator(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/mapper.py:3979: in cascade_iterator
    queue = deque(
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/relationships.py:1524: in cascade_iterator
    tuples = state.manager[self.key].impl.get_all_pending(state, dict_)
.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/attributes.py:1410: in get_all_pending
    ret = [(instance_state(current), current)]
E   AttributeError: 'int' object has no attribute '_sa_instance_state'
------------------------------ Captured log setup ------------------------------
INFO     app.blueprints_registry:blueprints_registry.py:123 Blueprint 'billing' registered successfully.
INFO     app:unit_utils.py:28 BatchTrack startup
=============================== warnings summary ===============================
tests/test_signup_tiers.py: 5 warnings
tests/test_billing_and_tier_enforcement.py: 7 warnings
tests/test_stripe_webhooks.py: 4 warnings
  /home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/flask_limiter/extension.py:333: UserWarning: Using the in-memory storage for tracking rate limits as no storage was explicitly specified. This is not recommended for production use. See: https://flask-limiter.readthedocs.io#configuring-a-storage-backend for documentation about configuring the storage backend.
    warnings.warn(

tests/test_signup_tiers.py::TestSignupTierCharacterization::test_signup_endpoint_exists
  /home/runner/workspace/tests/conftest.py:71: SAWarning: relationship 'Organization.tier' will copy column subscription_tier.id to column organization.subscription_tier_id, which conflicts with relationship(s): 'Organization.subscription_tier' (copies subscription_tier.id to organization.subscription_tier_id). If this is not the intention, consider if these relationships should be linked with back_populates, or if viewonly=True should be applied to one or more if they are read-only. For the less common case that foreign key constraints are partially overlapping, the orm.foreign() annotation can be used to isolate the columns that should be written towards.   To silence this warning, add the parameter 'overlaps="subscription_tier"' to the 'Organization.tier' relationship. (Background on this warning at: https://sqlalche.me/e/20/qzyx) (This warning originated from the `configure_mappers()` process, which was invoked automatically in response to a user-initiated operation.)
    tier = SubscriptionTier(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
ERROR tests/test_signup_tiers.py::TestSignupTierCharacterization::test_signup_endpoint_exists - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_signup_tiers.py::TestSignupTierCharacterization::test_tier_bypass_behavior - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_signup_tiers.py::TestSignupTierCharacterization::test_organization_tier_assignment - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_signup_tiers.py::TestSignupTierCharacterization::test_permission_gating_exists - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_signup_tiers.py::TestSignupTierCharacterization::test_signup_service_delegation - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_tier_permission_is_the_hard_ceiling - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[active-200] - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[past_due-302] - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[suspended-302] - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_billing_status_enforcement[canceled-302] - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_developer_can_masquerade_regardless_of_billing - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_billing_and_tier_enforcement.py::TestBillingAndTierEnforcement::test_complete_security_cascade - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_stripe_service_exists - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_webhook_signature_verification_path_exists - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_webhook_idempotency_behavior - AttributeError: 'int' object has no attribute '_sa_instance_state'
ERROR tests/test_stripe_webhooks.py::TestStripeWebhookCharacterization::test_stripe_service_methods_exist - AttributeError: 'int' object has no attribute '_sa_instance_state'
======================= 17 warnings, 16 errors in 22.95s =======================
