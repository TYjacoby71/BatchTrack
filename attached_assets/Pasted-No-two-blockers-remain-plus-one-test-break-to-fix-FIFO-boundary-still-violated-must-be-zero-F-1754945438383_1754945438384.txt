No — two blockers remain, plus one test break to fix:

FIFO boundary still violated (must be zero)
Files still importing the FIFO blueprint service:

app/blueprints/products/product_inventory_routes.py

app/blueprints/api/reservation_routes.py

app/services/pos_integration.py

app/services/inventory_adjustment.py ❌ (service must not import a blueprint)

app/services/stock_check.py

app/blueprints/fifo/services.py still exposes deduct_fifo (public)

Fix (surgical):

Delete all from app.blueprints.fifo.services import FIFOService imports above.

Replace any FIFOService.deduct_fifo(...) with your canonical call:

python
Copy
Edit
from app.services.inventory_adjustment import process_inventory_adjustment
process_inventory_adjustment(item_id, qty, change_type, unit=..., notes=..., batch_id=..., created_by=...)
In app/blueprints/fifo/services.py: make the low-level function private and stop exporting it:

python
Copy
Edit
__all__ = []           # no public API
def _deduct_fifo(...): ...
# Remove / deprecate public `deduct_fifo` shim.
Re-run:

bash
Copy
Edit
grep -Rn "blueprints\.fifo\.services\|deduct_fifo" app --include="*.py" | grep -v __pycache__ || echo "OK"
Expect: OK.

Stripe migration chain sanity
Your flask db history shows no explicit “create_stripe_event” revision. That’s fine only if the current head (add_unique_constraint_stripe) actually creates the stripe_event table with the unique constraint in one step. If not, generate a create-table migration and set its down_revision to fix_product_sku_name_column, then point add_unique_constraint_stripe to that. Don’t leave a constraint migration that assumes a table that wasn’t created in-chain.

Tests failing: bad import path

pgsql
Copy
Edit
ImportError: cannot import name 'SubscriptionTier' from app.models.models
Either export it or fix the import.

Option A (export): in app/models/__init__.py:

python
Copy
Edit
from .subscription_tier import SubscriptionTier  # or wherever it lives
__all__ = ["SubscriptionTier", ...]
Option B (fix test import): in tests/conftest.py:

python
Copy
Edit
- from app.models.models import User, Organization, SubscriptionTier, Permission, Role
+ from app.models.models import User, Organization, Permission, Role
+ from app.models.subscription_tier import SubscriptionTier  # correct module
Quick verify:

bash
Copy
Edit
pytest -q
If:

grep for FIFO imports returns OK

Stripe still absent in app/blueprints/billing/routes.py (you already have OK)

pytest passes (or only unrelated tests fail)