Yes! Letâ€™s turbocharge your batch management with some high-utility extras â€” tailored to how your wife is using this for skincare production.

âœ… This Batch Adds:
Feature	Description
ğŸ§¾ Export Filtered Batches to CSV	Great for accounting, cost analysis, inventory reports
ğŸ“Š Batch Chart by Date (Optional)	Visualize production over time
ğŸ”¬ Ingredient Usage Summary	See how much of each ingredient was used across batches
ğŸ–¨ï¸ Printable Batch Summary w/ QR	One-click printable label/summary with link
ğŸ§¾ PART 1 â€” Export Filtered Results to CSV
ğŸ§¾ Ask Replit Assistant to Add This to batches.py:
python
Copy
Edit
@batches_bp.route('/batches/export')
def export_batches():
    data = load_data()
    batches = data.get('batches', [])

    # Apply same filters as /batches
    tag_filter = request.args.get("tag", "").lower()
    recipe_filter = request.args.get("recipe", "").lower()

    if tag_filter:
        batches = [b for b in batches if any(tag_filter in t.lower() for t in b.get("tags", []))]

    if recipe_filter:
        batches = [b for b in batches if recipe_filter in b.get("recipe_name", "").lower()]

    # Generate CSV
    lines = ["id,recipe_name,date,total_cost,tags"]
    for b in batches:
        line = f"{b['id']},{b['recipe_name']},{b['timestamp']},{b['total_cost']},\"{', '.join(b['tags'])}\""
        lines.append(line)

    content = "\n".join(lines)
    return Response(
        content,
        mimetype='text/csv',
        headers={'Content-Disposition': 'attachment;filename=filtered_batches.csv'}
    )
Then add this link above or below your batch filter form:

html
Copy
Edit
<a href="/batches/export?tag={{ request.args.get('tag', '') }}&recipe={{ request.args.get('recipe', '') }}">Download CSV</a>
ğŸ“Š PART 2 â€” Ingredient Usage Summary
Optional but awesome for reordering raw materials.

ğŸ§¾ Add This Route to batches.py:
python
Copy
Edit
@batches_bp.route('/ingredients/usage')
def ingredient_usage():
    data = load_data()
    usage = {}

    def to_float(v):
        try:
            return float(v)
        except:
            return 0

    for batch in data.get("batches", []):
        for ing in batch.get("ingredients", []):
            name = ing["name"]
            qty = to_float(ing["quantity"])
            usage[name] = usage.get(name, 0) + qty

    sorted_usage = sorted(usage.items(), key=lambda x: x[1], reverse=True)
    return render_template("ingredient_usage.html", usage=sorted_usage)
Then ask Replit to create templates/ingredient_usage.html:

html
Copy
Edit
{% extends "layout.html" %}
{% block content %}
<h2>Ingredient Usage Across All Batches</h2>
<table border="1" cellpadding="5">
  <tr><th>Ingredient</th><th>Total Used</th></tr>
  {% for name, total in usage %}
    <tr>
      <td>{{ name }}</td>
      <td>{{ total }}</td>
    </tr>
  {% endfor %}
</table>
{% endblock %}
ğŸ–¨ï¸ PART 3 â€” Printable Batch Summary (with QR)
ğŸ§¾ Add This Route to batches.py:
python
Copy
Edit
@batches_bp.route('/batches/<batch_id>/print')
def print_batch(batch_id):
    data = load_data()
    batch = next((b for b in data.get("batches", []) if b["id"] == batch_id), None)
    if not batch:
        return "Batch not found", 404
    return render_template("batch_print.html", batch=batch)
Then ask Replit to create templates/batch_print.html:

html
Copy
Edit
{% extends "layout.html" %}
{% block content %}
<h2>Batch Summary: {{ batch.recipe_name }}</h2>

<p><strong>Batch ID:</strong> {{ batch.id }}</p>
<p><strong>Date:</strong> {{ batch.timestamp }}</p>
<p><strong>Tags:</strong> {{ batch.tags | join(', ') }}</p>
<p><strong>Total Cost:</strong> ${{ batch.total_cost }}</p>

<h3>Ingredients Used:</h3>
<ul>
  {% for ing in batch.ingredients %}
    <li>{{ ing.quantity }} {{ ing.unit }} {{ ing.name }}</li>
  {% endfor %}
</ul>

{% if batch.qr_code %}
  <h3>QR Code:</h3>
  <img src="/{{ batch.qr_code }}" width="150">
{% endif %}

<br><br>
<button onclick="window.print()">Print</button>
{% endblock %}
Then, link to it from /batches:

html
Copy
Edit
<td><a href="/batches/{{ batch.id }}/print" target="_blank">ğŸ–¨ Print</a></td>
âœ… Done â€” What You Now Have:
Feature	Route
ğŸ“¤ Export filtered batch history	/batches/export
ğŸ“Š Ingredient usage overview	/ingredients/usage
ğŸ–¨ Printable QR + batch label	/batches/<batch_id>/print