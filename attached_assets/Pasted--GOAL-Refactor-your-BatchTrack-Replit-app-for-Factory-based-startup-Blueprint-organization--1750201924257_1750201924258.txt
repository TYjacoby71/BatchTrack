âœ… GOAL:
Refactor your BatchTrack Replit app for:

âœ… Factory-based startup

âœ… Blueprint organization

âœ… Extensions modularized

âœ… Authentication as its own blueprint

âœ… Multi-tenancy readiness

ğŸ§  STRUCTURE STRATEGY
ğŸ¯ Target Folder Layout:
csharp
Copy
Edit
BatchTrack/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py         â† factory: create_app()
â”‚   â”œâ”€â”€ extensions.py       â† db, login_manager, csrf, etc.
â”‚   â”œâ”€â”€ models/             â† split into modular files
â”‚   â”œâ”€â”€ blueprints/         â† feature blueprints
â”‚   â”‚   â”œâ”€â”€ auth/           â† login, register, session logic
â”‚   â”‚   â”œâ”€â”€ batches/        â† batching logic
â”‚   â”‚   â”œâ”€â”€ products/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ services/           â† business logic (unit conversion, stock checks)
â”‚   â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ static/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ instance/
â”‚   â””â”€â”€ config.py           â† runtime secrets
â”œâ”€â”€ migrations/
â”œâ”€â”€ tests/
â”œâ”€â”€ run.py                  â† boot file for flask run
â”œâ”€â”€ requirements.txt
â””â”€â”€ ...
ğŸ“œ PROMPT TO GIVE REPLIT ASSISTANT
Paste this as your prompt in Replit:

âœ… I want to refactor my Flask app to follow the application factory pattern for scalability and clean modular design. Use the current project layout but reorganize it as follows:

Create an app/ package that contains:

__init__.py with a create_app() function

extensions.py that defines and exports: db, login_manager, csrf, migrate, bcrypt

Move models.py into app/models/ and split into files like user.py, recipe.py, etc. Use a models/__init__.py to combine them.

Move all blueprints into app/blueprints/. Each blueprint should be in its own folder with __init__.py, routes.py, forms.py (if needed).

Create a new auth blueprint in app/blueprints/auth/:

Move login, logout, and user registration routes there.

Configure Flask-Login with login_manager.login_view = "auth.login"

Setup run.py at root to run the app using:

python
Copy
Edit
from app import create_app
app = create_app()
Ensure multi-tenancy readiness:

Include support for current_user.organization_id in models that need scoping

Add a placeholder @requires_organization decorator (can be a TODO)

Blueprints to register inside create_app():

auth, batches, products, inventory, recipes, etc.

Preserve working forms, templates, and static assets.

âš ï¸ VERY IMPORTANT:

Keep all imports relative (e.g., from ..models.user import User) inside the app package

Prevent circular imports by moving all db references to app/extensions.py

Do not change any functionality or method signatures â€” only refactor structure

âœ… Please generate the new app/ package structure with updated imports, and list any routes that need manual reconnection.

