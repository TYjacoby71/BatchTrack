=== Mock migration downgrade: No changes to revert ===
‚úÖ Downgrade completed successfully
INFO  [alembic.runtime.migration] Running downgrade restore_timestamps -> fix_nullable_constraints, restore missing timestamp columns
=== Removing restored timestamp columns ===
‚úÖ Downgrade completed: Removed timestamp columns
~/workspace$ flask init-production
DEBUG: Billing blueprint imported successfully: <Blueprint 'billing'>
DEBUG: Billing blueprint name: billing
DEBUG: Billing blueprint url_prefix: /billing
DEBUG: Billing blueprint registered successfully
Registered API routes: ['/api/reservations/create', '/api/reservations/release/<int:reservation_id>', '/api/reservations/convert-to-sale/<int:reservation_id>', '/api/reservations/expire-old', '/api/products/<int:product_id>/variants', '/api/dismiss-alert', '/api/dashboard-alerts', '/api/server-time', '/api/server-time', '/api/dismiss-alert', '/api/dashboard-alerts', '/api/check-stock', '/api/categories', '/api/ingredient/<int:id>/density', '/api/debug-containers', '/api/available-containers/<int:recipe_id>', '/api/containers/available', '/api/batches/<int:batch_id>/containers', '/api/batches/<int:batch_id>/containers/<int:container_id>', '/api/batches/<int:batch_id>/containers/<int:container_id>/adjust', '/api/api/fifo-details/<int:inventory_id>', '/api/api/batch-inventory-summary/<int:batch_id>', '/api/api/reservations/create', '/api/api/reservations/release/<int:reservation_id>', '/api/api/reservations/convert-to-sale/<int:reservation_id>', '/api/api/reservations/expire-old', '/api/dashboard-alerts', '/api/dismiss-alert', '/api/units', '/api/convert-units']
Container routes found: ['/settings/bulk-update-containers', '/api/debug-containers', '/api/available-containers/<int:recipe_id>', '/api/containers/available', '/api/batches/<int:batch_id>/containers', '/api/batches/<int:batch_id>/containers/<int:container_id>', '/api/batches/<int:batch_id>/containers/<int:container_id>/adjust', '/debug-containers', '/available-containers/<int:recipe_id>', '/containers/available', '/batches/<int:batch_id>/containers', '/batches/<int:batch_id>/containers/<int:container_id>', '/batches/<int:batch_id>/containers/<int:container_id>/adjust']
Billing routes found: ['/billing/reconciliation-needed', '/billing/reconcile-to-free', '/billing/upgrade', '/billing/checkout/<tier>/<billing_cycle>', '/billing/checkout/<tier>', '/billing/customer-portal', '/billing/cancel-subscription', '/billing/webhooks/stripe', '/billing/complete-signup-from-stripe', '/billing/debug']
Billing endpoints: [('/billing/reconciliation-needed', 'billing.reconciliation_needed'), ('/billing/reconcile-to-free', 'billing.reconcile_to_free'), ('/billing/upgrade', 'billing.upgrade'), ('/billing/checkout/<tier>/<billing_cycle>', 'billing.checkout'), ('/billing/checkout/<tier>', 'billing.checkout'), ('/billing/customer-portal', 'billing.customer_portal'), ('/billing/cancel-subscription', 'billing.cancel_subscription'), ('/billing/webhooks/stripe', 'billing.stripe_webhook'), ('/billing/complete-signup-from-stripe', 'billing.complete_signup_from_stripe'), ('/billing/debug', 'billing.debug_billing')]
[2025-08-01 21:41:34,073] INFO in unit_utils: BatchTrack startup
üöÄ BatchTrack Production Seeding Starting...
‚ö†Ô∏è  Assumes database schema is already migrated (flask db upgrade)
=== Step 1: System foundations ===
=== Seeding Consolidated Permissions System ===
Seeding organization permissions...
Processing category: Main dashboard and overview features
‚ö†Ô∏è  Permission seeding issue: (sqlite3.OperationalError) no such column: permission.created_at
[SQL: SELECT permission.id AS permission_id, permission.name AS permission_name, permission.description AS permission_description, permission.category AS permission_category, permission.is_active AS permission_is_active, permission.created_at AS permission_created_at 
FROM permission 
WHERE permission.name = ?
 LIMIT ? OFFSET ?]
[parameters: ('dashboard.view', 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
   Continuing with remaining steps...
=== Seeding Subscription Tiers Only ===
=== Seeding Subscription Tiers (Create Only Mode) ===
‚ÑπÔ∏è  Exempt tier already exists
‚ö†Ô∏è  Subscription seeding issue: (sqlite3.OperationalError) no such column: permission.created_at
[SQL: SELECT permission.id AS permission_id, permission.name AS permission_name, permission.description AS permission_description, permission.category AS permission_category, permission.is_active AS permission_is_active, permission.created_at AS permission_created_at 
FROM permission]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
   Continuing with remaining steps...
=== Seeding 45 standard units ===
‚úÖ Added 0 new units
‚ÑπÔ∏è  Total units in database: 45
‚úÖ Units seeded
=== Step 2: Initial admin setup ===
=== Creating Default Organization with Essential Users ===
‚ÑπÔ∏è  Found 1 existing organizations - using first organization
‚ÑπÔ∏è  Using organization: BatchTrack Organization (ID: 1)
   - Subscription tier: exempt (Exempt Plan)
‚ÑπÔ∏è  Developer user 'dev' already exists
‚ÑπÔ∏è  Admin user 'admin' already exists
‚ÑπÔ∏è  Manager user 'manager' already exists
‚ÑπÔ∏è  Operator user 'operator' already exists
‚úÖ Default organization and essential users created successfully
   - Organization: BatchTrack Organization (Exempt tier)
   - 1 System developer (dev/dev123)
   - 3 Organization users (admin, manager, operator)
‚úÖ Users and organization seeded
=== Step 3: Organization setup ===
‚ö†Ô∏è  Category seeding issue: (sqlite3.OperationalError) no such column: inventory_item.created_at
[SQL: SELECT inventory_item.id AS inventory_item_id, inventory_item.name AS inventory_item_name, inventory_item.category_id AS inventory_item_category_id, inventory_item.quantity AS inventory_item_quantity, inventory_item.unit AS inventory_item_unit, inventory_item.cost_per_unit AS inventory_item_cost_per_unit, inventory_item.low_stock_threshold AS inventory_item_low_stock_threshold, inventory_item.density AS inventory_item_density, inventory_item.type AS inventory_item_type, inventory_item.is_active AS inventory_item_is_active, inventory_item.is_archived AS inventory_item_is_archived, inventory_item.is_perishable AS inventory_item_is_perishable, inventory_item.shelf_life_days AS inventory_item_shelf_life_days, inventory_item.expiration_date AS inventory_item_expiration_date, inventory_item.storage_amount AS inventory_item_storage_amount, inventory_item.storage_unit AS inventory_item_storage_unit, inventory_item.created_by AS inventory_item_created_by, inventory_item.created_at AS inventory_item_created_at, inventory_item.intermediate AS inventory_item_intermediate, inventory_item.organization_id AS inventory_item_organization_id 
FROM inventory_item 
WHERE inventory_item.category_id = ? AND inventory_item.organization_id = ?]
[parameters: (14, 1)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
‚úÖ Production seeding complete!
üîí Login: admin/admin (CHANGE IMMEDIATELY)
üìù Note: This command can be run multiple times safely
üìä Database status:
   - Organizations: 1
   - Users: 4
   - Status check failed: (sqlite3.OperationalError) no such column: permission.created_at
[SQL: SELECT count(*) AS count_1 
FROM (SELECT permission.id AS permission_id, permission.name AS permission_name, permission.description AS permission_description, permission.category AS permission_category, permission.is_active AS permission_is_active, permission.created_at AS permission_created_at 
FROM permission) AS anon_1]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
~/workspace$ 