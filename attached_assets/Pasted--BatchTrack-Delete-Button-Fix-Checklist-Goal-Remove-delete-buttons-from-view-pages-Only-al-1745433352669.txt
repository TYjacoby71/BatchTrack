âœ… BatchTrack Delete Button Fix Checklist
ğŸ¯ Goal:
âŒ Remove delete buttons from view pages

âœ… Only allow delete from the edit form

ğŸ”’ Variation delete = only from edit page

âš ï¸ Parent delete = warns it will also delete variations

âœ… 1. Edit Form: recipe_form.html
âœ… Add This Conditional Block in Place of Your Current Delete Button:
jinja
Copy
Edit
{% if recipe and edit_mode %}
  <form method="post" action="{{ url_for('recipes.delete_recipe', recipe_id=recipe.id) }}" style="display:inline;">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    {% if recipe.parent_id %}
      <button type="submit" class="btn btn-danger"
              onclick="return confirm('Are you sure you want to delete this variation? This action cannot be undone.')">
        Delete Variation
      </button>
    {% elif recipe.variations %}
      <button type="submit" class="btn btn-danger"
              onclick="return confirm('Are you sure you want to delete this recipe and ALL its variations? This action cannot be undone.')">
        Delete Recipe & Variations
      </button>
    {% else %}
      <button type="submit" class="btn btn-danger"
              onclick="return confirm('Are you sure you want to delete this recipe? This action cannot be undone.')">
        Delete Recipe
      </button>
    {% endif %}
  </form>
{% endif %}
âœ… 2. Ensure You're Setting edit_mode = True
In your recipes.edit_recipe route, pass:

python
Copy
Edit
return render_template("recipe_form.html", recipe=recipe, edit_mode=True, ...)
âœ… This ensures the delete buttons only appear in edit context, not create/view.

âœ… 3. View Page: view_recipe.html
âŒ Remove All Delete Button Code
Find and delete anything like this:

jinja
Copy
Edit
<form method="post" action="{{ url_for('recipes.delete_recipe', recipe_id=recipe.id) }}">
...
</form>
Also delete:

html
Copy
Edit
<a class="btn btn-danger">Delete</a>
Or anything similar related to deletion.

âœ… This guarantees the user canâ€™t delete from view mode.

âœ… 4. Server Route: recipes.delete_recipe
Make sure your Flask route:

Checks CSRF

Deletes the recipe

If parent, deletes child variations too (cascading or via query)

ğŸ§ª 5. Test Cases to Validate

Case	Should Work?
Edit parent â†’ Delete	âœ…
Edit variation â†’ Delete	âœ…
View parent â†’ Delete	âŒ (no button)
View variation â†’ Delete	âŒ (no button)
Deleting parent with variations	âœ… Warning shown
