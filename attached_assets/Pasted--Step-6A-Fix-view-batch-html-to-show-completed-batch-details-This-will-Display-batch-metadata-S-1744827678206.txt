âœ… Step 6A: Fix view_batch.html to show completed batch details
This will:

Display batch metadata

Show cost, quantity, output unit

Include editable notes

Avoid using .status until after migration

Support both ingredient and product batches

ðŸ§© Replace: templates/view_batch.html
Hereâ€™s the full updated template you can copy into templates/view_batch.html:

html
Copy
Edit
{% extends 'layout.html' %}
{% block content %}
<h2>View Batch</h2>

<div class="batch-details">
    <p><strong>Label Code:</strong> {{ batch.label_code }}</p>
    <p><strong>Recipe:</strong> {{ batch.recipe_name }}</p>
    <p><strong>Scale:</strong> {{ batch.scale }}</p>
    <p><strong>Timestamp:</strong> {{ batch.timestamp.strftime('%Y-%m-%d %H:%M') }}</p>
    <p><strong>Total Cost:</strong> ${{ batch.total_cost or 'N/A' }}</p>

    {% if batch.product_name %}
        <p><strong>Output Type:</strong> Product</p>
        <p><strong>Product Name:</strong> {{ batch.product_name }}</p>
        <p><strong>Quantity Produced:</strong> {{ batch.product_quantity }}</p>
        <p><strong>Unit:</strong> {{ batch.product_unit }}</p>
    {% else %}
        <p><strong>Output Type:</strong> Ingredient</p>
        <p><strong>Quantity Produced:</strong> {{ batch.product_quantity or 'N/A' }}</p>
        <p><strong>Unit:</strong> {{ batch.product_unit or 'N/A' }}</p>
    {% endif %}
</div>

<hr>

<h3>Batch Notes</h3>
<form method="post" action="{{ url_for('batches.update_batch_notes', batch_id=batch.id) }}">
    <textarea name="notes" rows="4" cols="50">{{ batch.notes or '' }}</textarea>
    <br>
    <button type="submit" class="btn btn-secondary mt-2">Update Notes</button>
</form>

{% if batch.tags %}
    <h3 class="mt-4">Tags</h3>
    <p>{{ batch.tags }}</p>
{% endif %}

<hr>

{% if batch.product_image %}
    <h3>Product Image</h3>
    <img src="{{ url_for('static', filename='uploads/' ~ batch.product_image) }}" alt="Product Image" style="max-width: 300px;">
{% endif %}
{% endblock %}
âœ… What this does:
Makes no assumption about batch mode or status

Shows editable notes for all batches

Falls back to "Ingredient" output if no product info is present

No use of batch.status â€” so it wonâ€™t crash

Loads product image if uploaded